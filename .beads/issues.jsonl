{"id":"coding-tool-0bo","title":"Add timeout detection for hanging code execution","description":"Implement timeout detection and graceful handling for code that hangs waiting for input.\n\n**Problem:**\nWhen code expects stdin input but none (or insufficient input) is provided, the execution hangs indefinitely. This is a common failure case for students testing code with input() calls.\n\n**Current Behavior:**\n- Code executor has a timeout (default 10s), but hanging code waiting for input will sit until timeout\n- No feedback to user that program is waiting for input\n- Timeout error is generic, doesn't indicate the likely cause\n\n**Desired Behavior:**\n1. Detect when program is blocked on stdin read\n2. Provide clear error message: \"Program appears to be waiting for input, but no more input was provided\"\n3. Terminate execution gracefully with informative feedback\n4. Consider shorter timeout for stdin-blocked processes (e.g., 3-5s instead of 10s)\n\n**Files to Modify:**\n- src/server/code-executor.ts - Add stdin detection and timeout handling\n- src/server/__tests__/code-executor.test.ts - Add tests for hanging input scenarios\n\n**Implementation Approach:**\n\n1. **Basic timeout improvement:**\n   - Add specific timeout for stdin operations (shorter than general execution timeout)\n   - Detect timeout scenario and provide better error message\n   - Check if stdin was provided but insufficient (common case: single input() with empty stdin)\n\n2. **Bonus: Stdin waiting detection (advanced):**\n   - Monitor Python process state to detect if blocked on read()\n   - Use techniques like:\n     - Check process status (/proc/[pid]/status on Linux, look for \"sleeping\" state)\n     - Monitor file descriptor activity\n     - Use strace/ptrace to detect blocked syscalls (read from stdin)\n   - If detected as blocked on stdin + no more stdin available → immediate informative error\n\n3. **Error message improvements:**\n   - \"Program is waiting for input, but none was provided. Did you forget to add input?\"\n   - \"Program read X lines but tried to read more. Provided input may be incomplete.\"\n   - Include line of code that's likely blocking (if parseable from traceback)\n\n**Example Test Cases:**\n```python\n# Case 1: No stdin provided, single input expected\ncode = 'name = input(\"Name: \")'\nstdin = None\n# Should timeout quickly with helpful message\n\n# Case 2: Insufficient stdin (expects 2 inputs, gets 1)\ncode = 'name = input()\\nage = input()'\nstdin = 'Alice\\n'\n# Should detect second input() is blocking\n\n# Case 3: Valid case - enough input provided\ncode = 'name = input()\\nprint(name)'\nstdin = 'Alice\\n'\n# Should execute normally\n```\n\n**Priority Notes:**\n- High priority because this affects user experience significantly\n- Common student error pattern\n- Better error messages improve learning experience","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-21T02:06:51.25485275Z","updated_at":"2026-01-20T17:01:26.752314054Z","closed_at":"2026-01-20T17:01:26.752314054Z","close_reason":"Duplicate of coding-tool-xis"}
{"id":"coding-tool-0lp","title":"Add accessibility (a11y) support - ARIA labels, semantic HTML, keyboard navigation","description":"## Summary\nThe app currently has zero accessibility support. This is a legal and ethical requirement for public release.\n\n## Critical Issues to Fix\n\n### 1. ARIA Labels\nAdd aria-labels to all interactive elements without visible text:\n- Icon-only buttons (close, view history, etc.)\n- Status indicators (connection dots, success/error icons)\n- Loading spinners (mark as aria-hidden or add aria-label)\n\nFiles to update:\n- `src/app/instructor/page.tsx` - Close button (line ~694), various icon buttons\n- `src/app/instructor/components/StudentList.tsx` - Action buttons (lines 47-91)\n- `src/app/student/components/OutputPanel.tsx` - Status indicators\n\n### 2. Semantic HTML\nReplace div-with-click-handlers with proper button elements:\n- StudentList uses divs with click handlers\n- Add landmark elements: `\u003cmain\u003e`, `\u003cnav\u003e`, `\u003csection\u003e`\n\n### 3. Keyboard Navigation\n- Modal close on ESC key\n- Focus trapping in modals\n- Focus management when modals open/close\n- Add `:focus-visible` styles\n\n### 4. Color Contrast\n- OutputPanel uses color alone for success/error (green/red backgrounds)\n- Add icons or text labels alongside color indicators\n- Verify 4.5:1 contrast ratio for all text\n\n### 5. Form Accessibility\n- Add `aria-describedby` for validation messages\n- Add autocomplete hints for password managers\n\n## Testing\n- Test with screen reader (NVDA or VoiceOver)\n- Run axe-core or Lighthouse accessibility audit\n- Verify keyboard-only navigation works","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T03:57:41.875661716Z","created_by":"node","updated_at":"2026-01-20T17:02:57.839717305Z","closed_at":"2026-01-20T17:02:57.839717305Z","close_reason":"Implemented: ARIA labels on icon buttons/spinners, semantic HTML landmarks, keyboard navigation (ESC/focus trap in dialogs), form accessibility (aria-describedby for errors)"}
{"id":"coding-tool-0pv","title":"Supabase Integration","description":"Integrate Supabase as the production database backend for the coding tool, replacing local file-based storage with a scalable, cloud-hosted Postgres database. Must maintain seamless local development experience using Supabase CLI.\n\n**Goals:**\n- Replace local JSON file storage with Supabase Postgres\n- Maintain all existing functionality\n- Enable multi-user production deployment\n- Preserve fast local development workflow\n- Support both cloud and self-hosted Supabase\n\n**Architecture:**\n- Implement SupabaseStorageBackend implementing all repository interfaces\n- Use Supabase client library (@supabase/supabase-js)\n- Row-level security (RLS) policies for data isolation\n- Real-time subscriptions for live updates\n- Supabase Auth integration (replace local auth)\n- Configuration-based backend selection (local vs supabase)\n\n**Database Schema:**\nTables to create:\n- users (id, username, email, role, created_at, last_login_at)\n- sessions (id, join_code, active, instructor_id, section_id, created_at)\n- problems (id, title, description, starter_code, difficulty, tags, created_by)\n- test_cases (id, problem_id, type, name, config, visible, order)\n- code_revisions (id, session_id, student_id, problem_id, code, diff, timestamp, is_snapshot)\n- classes (id, name, description, created_by, created_at)\n- sections (id, class_id, name, semester, join_code, active, created_at)\n- section_memberships (id, user_id, section_id, role, joined_at)\n- auth_sessions (session_id, user_id, created_at, expires_at)\n\n**Local Development with Supabase CLI:**\nSupabase CLI provides local development environment that works in Codespaces:\n- Runs Postgres, Auth, Storage, Realtime locally via Docker\n- Works in Codespaces and local dev containers (Docker available)\n- Migrations apply to both local and cloud\n- No internet dependency during development\n- Same client code for local and production\n- Can run supabase start in devcontainer.json postStartCommand\n- Port forwarding works for local Supabase Studio\n- Migrations tracked in Git (supabase/migrations/)\n\nSetup:\nnpm install -g supabase \u0026\u0026 supabase init \u0026\u0026 supabase start\n\n**Implementation Phases:**\nPhase 1: Schema \u0026 Migrations\nPhase 2: Storage Backend (SupabaseStorageBackend)\nPhase 3: Authentication (SupabaseAuthProvider)\nPhase 4: Real-time Features (Supabase Realtime)\nPhase 5: Testing \u0026 Migration\n\n**Success Criteria:**\n- All repository interfaces work with Supabase\n- Local dev as fast as file-based storage\n- Production deployment on Supabase cloud\n- Zero data loss during migration\n- Real-time updates functional\n\n**Dependencies:**\nMust complete schema-defining epics first: uvn, d8z, erm, kwt","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-19T21:49:41.419524384Z","updated_at":"2026-01-23T05:48:34.158057263Z","closed_at":"2026-01-23T05:48:34.158057263Z","close_reason":"Completed - full Supabase integration in src/server/persistence/supabase/ with 10 repositories, RLS, and realtime support"}
{"id":"coding-tool-0pv.1","title":"Maintain seamless local development with Supabase CLI","description":"Ensure local development experience remains fast and seamless when using Supabase as the backend. Must work in both Codespaces and local dev containers with zero manual setup.\n\n**Implementation:**\n1. Update devcontainer.json: Add Supabase CLI, postStartCommand: supabase start, forward ports 54321/54323\n2. Create supabase/config.toml: Configure local services\n3. Add scripts/init-supabase.sh: Initialize and start services automatically\n4. Update .env.example: SUPABASE_URL, keys, backend selection\n5. Add npm scripts: supabase:start/stop/reset/studio/migrate\n6. Update README: Local dev setup and troubleshooting\n\n**Codespaces compatibility:**\n✅ Docker pre-installed in Codespaces\n✅ Port forwarding automatic\n✅ postStartCommand runs on container start\n⚠️ Mind CPU/memory limits (provide SQLite fallback)\n\n**Success criteria:**\n- git clone \u0026\u0026 code . opens in Codespace\n- Supabase services running within 2 minutes\n- Studio accessible via port forwarding\n- npm run dev works immediately\n- No manual configuration needed","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T21:50:19.419902845Z","updated_at":"2026-01-20T17:05:23.151311011Z","closed_at":"2026-01-20T17:05:23.151311011Z","close_reason":"Implemented: Supabase CLI in devcontainer, auto-start via postStartCommand, port forwarding, npm scripts, auto .env.local creation"}
{"id":"coding-tool-0tv","title":"Launch blockers","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:47:11.721176375Z","created_by":"Joe Delfino","updated_at":"2026-01-24T00:11:22.756793296Z","closed_at":"2026-01-24T00:11:22.756793296Z","close_reason":"All launch blockers completed and merged in PR #19"}
{"id":"coding-tool-0xm","title":"Student sign-out does not redirect to login page","description":"## Problem\n\nTwo related issues with sign-out behavior for students:\n\n### Issue 1: Sign-out doesn't redirect\nWhen a student signs out, they are not immediately redirected to the login page. The expected behavior is that after clicking sign out, the user should be redirected to the login/home page right away.\n\n### Issue 2: Refreshing while signed out shows infinite loading\nRefreshing a protected page while signed out (e.g. `/student?sessionId=xxx`) shows a page stuck in a loading state instead of redirecting to the login page.\n\n**Example URL:** `https://code.delquillan.com/student?sessionId=ced31f3d-68a2-474d-adc8-564180921a41`\n\n## Expected Behavior\n\n1. After sign-out: User is immediately redirected to login page\n2. Accessing protected routes while signed out: User is redirected to login page\n\n## Actual Behavior\n\n1. After sign-out: User remains on current page\n2. Accessing protected routes while signed out: Page shows infinite loading spinner\n\n## Files to Investigate\n\n- Sign out button/action handler\n- Auth state management\n- Route protection/middleware\n- Loading state handling for unauthenticated users","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:20:27.436269132Z","created_by":"Joe Delfino","updated_at":"2026-01-23T21:45:29.632479925Z","closed_at":"2026-01-23T21:45:29.632479925Z","close_reason":"Fixed: Added redirect after sign-out and auth protection to fullscreen layout."}
{"id":"coding-tool-1cb","title":"Add 'Clear Public View' button for instructors","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T18:51:06.432343634Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:54:11.712967136Z","closed_at":"2026-01-29T18:54:11.712967136Z","close_reason":"Implemented in b005da9"}
{"id":"coding-tool-1f5","title":"Instructor session history: browse and restart old sessions","description":"Instructors need to access old sessions and reopen them. The section detail page (/sections/{id}) already shows past sessions. Add: (1) reopen API, (2) reopen button for instructors on section page, (3) navigation links from dashboard and class page to section detail page.","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:09:02.281257795Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:44:24.644618472Z","closed_at":"2026-01-29T22:44:24.644618472Z","close_reason":"Merged in PR #41"}
{"id":"coding-tool-1f5.1","title":"Add session history list to instructor dashboard","description":"## Summary\nAdd a \"Session History\" section to the instructor dashboard that shows completed sessions per section, with problem title, date, and participant count.\n\n## Files to modify\n1. **`src/app/(app)/instructor/components/InstructorDashboard.tsx`** - Add expandable session history per section row\n2. **`src/app/api/instructor/dashboard/route.ts`** - Include recent completed sessions per section in the dashboard API response\n3. **`src/hooks/useSessionHistory.ts`** - May reuse existing hook or fetch inline\n\n## Implementation steps\n1. Update the dashboard API (`/api/instructor/dashboard`) to include `recentSessions: { id, problemTitle, createdAt, endedAt, participantCount, status }[]` for each section (last 10 completed sessions)\n2. Add an expandable row or dropdown under each section in the dashboard table showing past sessions\n3. Each past session row shows: problem title (or \"No problem\"), date completed, number of participants\n4. Clicking a past session navigates to a read-only session detail view at `/instructor/session/{id}` (existing route - it should handle completed sessions gracefully)\n5. Add tests for the updated dashboard API response\n\n## Acceptance criteria\n- Instructor can see past sessions for each section on the dashboard\n- Sessions show problem title, completion date, participant count\n- Past sessions are sorted by most recent first\n- Limit to 10 most recent per section","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:09:08.169743381Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:26:51.45661147Z","closed_at":"2026-01-29T22:26:51.45661147Z","close_reason":"Implemented in fb3dc1d","labels":["wip"]}
{"id":"coding-tool-1f5.2","title":"Add restart session API endpoint","description":"## Summary\nAdd a POST endpoint to restart (clone) an old completed session as a new active session for the same section, copying the problem but resetting student state.\n\n## Files to modify\n1. **`src/app/api/sessions/[id]/restart/route.ts`** - New API route (POST)\n2. **`src/server/services/session-service.ts`** - Add `restartSession()` function\n3. **`src/server/persistence/interfaces.ts`** - May need to add method or reuse existing\n\n## Implementation steps\n1. Create `POST /api/sessions/{id}/restart` endpoint\n2. Auth: require instructor role + must be the creator of the original session (or admin)\n3. Validate: original session must be `completed` status\n4. Validate: no active session already exists for that section (existing constraint)\n5. Create new session via `SessionService.createSession()` with the same sectionId\n6. Copy the problem from the old session into the new session via `updateSession()`\n7. Return the new session ID so the UI can navigate to it\n8. Add tests: auth checks, status validation, problem cloning, active session conflict\n\n## API contract\n```\nPOST /api/sessions/{id}/restart\nResponse 201: { sessionId: string }\nResponse 400: session not completed / active session exists\nResponse 403: not creator or admin\nResponse 404: session not found\n```\n\n## Acceptance criteria\n- Restarting a completed session creates a new active session with the same problem\n- Student list is empty (fresh start)\n- Old session is unchanged\n- Cannot restart if an active session already exists for that section\n- Only the original creator (or admin) can restart","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:09:11.246028549Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:26:51.639077429Z","closed_at":"2026-01-29T22:26:51.639077429Z","close_reason":"Implemented in e7cbffa","labels":["wip"]}
{"id":"coding-tool-1f5.3","title":"Add restart button and session detail in history UI","description":"## Summary\nAdd a \"Restart\" button to each past session in the history list, and ensure the existing session page handles completed sessions in read-only mode.\n\n## Files to modify\n1. **`src/app/(app)/instructor/components/InstructorDashboard.tsx`** - Add \"Restart\" button next to each past session entry\n2. **`src/app/(app)/instructor/session/[id]/page.tsx`** - Handle completed session state (read-only mode, show \"Session ended\" banner)\n\n## Implementation steps\n1. In the session history list (from subtask 1), add a \"Restart\" button on each completed session row\n2. On click, call `POST /api/sessions/{id}/restart` (from subtask 2)\n3. On success, navigate to the new session at `/instructor/session/{newSessionId}`\n4. Handle errors: show alert if active session already exists for that section\n5. Ensure the existing session page shows completed sessions in a meaningful read-only way (student code visible but not editable, no execution controls)\n6. Add tests for the restart button interaction\n\n## Acceptance criteria\n- Each past session has a \"Restart\" button\n- Clicking restart creates a new session and navigates to it\n- Error states are handled (already active session, network errors)\n- Completed session page shows read-only student code","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:09:14.463063675Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:31:55.996676166Z","closed_at":"2026-01-29T22:31:55.996676166Z","close_reason":"Implemented in 88ecdf8","labels":["wip"]}
{"id":"coding-tool-1l8","title":"Replace ugly undo/redo button icons","description":"## Summary\n\nThe undo/redo buttons in the student code editor have poor-looking icons that need replacement.\n\n## Relevant Files\n\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx:437-459` — Undo/Redo button rendering in the editor header\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx:397-407` — handleUndo, handleRedo functions\n\n## Steps to Fix\n\n1. Review current icons used for undo/redo at CodeEditor.tsx:437-459\n2. Replace with better icons — consider using a consistent icon library (e.g., Lucide, Heroicons) if the project already uses one, or use standard arrow-curve-left/right SVGs\n3. Ensure icons are visually consistent with other UI elements\n\nGitHub: #25","status":"closed","priority":3,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:04:54.797342177Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:27:56.042751636Z","closed_at":"2026-01-28T22:27:56.042751636Z","close_reason":"Fixed in 984dc3a — replaced Unicode symbols with Lucide Undo2/Redo2 icons","labels":["wip"]}
{"id":"coding-tool-1r5","title":"Instructor Reporting and Analytics Tools","description":"Implement reporting and analytics tools for instructors to track student engagement, participation, and progress. Provides data export capabilities and insights into section activity. Initial focus on student engagement metrics with extensibility for future analytics.\n\n**Reporting Goals:**\n- Student engagement tracking (session participation)\n- Section-level analytics and comparisons\n- Data export for external analysis\n- Visual dashboards and summaries\n- Exportable reports in multiple formats\n\n**Initial Features:**\n- Student engagement report by section\n- Session participation counts per student\n- Export to CSV/Excel\n- Date range filtering\n- Section comparison views\n\n**Future Reporting Capabilities:**\n- Code submission metrics\n- Problem completion rates\n- Time spent coding per session\n- Debugging tool usage statistics\n- Revision history analysis\n- Comparison across sections/semesters\n- Individual student progress tracking\n- Automated grade export integration\n\n**Report Types:**\n1. Student Engagement (initial)\n   - Sessions participated in\n   - Active vs passive participation\n   - Attendance trends over time\n   - Section-by-section breakdown\n\n2. Future reports:\n   - Code quality metrics\n   - Problem difficulty analysis\n   - Time-on-task analytics\n   - Peer collaboration patterns\n   - Progress tracking\n\n**Data Export Formats:**\n- CSV (for spreadsheet import)\n- JSON (for programmatic access)\n- PDF (printable reports)\n- Excel (with formatting)\n\n**Modules to create:**\n- src/server/reports/ (new directory)\n  - report-generator.ts - Core report generation\n  - engagement-report.ts - Student engagement calculations\n  - export-service.ts - Data export formatting\n  - report-repository.ts - Cached report storage\n\n**Success Criteria:**\n- Instructors can generate engagement reports\n- Reports filterable by section and date range\n- Export to CSV works reliably\n- Data accurate and matches session records\n- Performance acceptable for large sections\n- Reports accessible from instructor dashboard","status":"open","priority":3,"issue_type":"epic","created_at":"2025-12-18T19:24:16.224286983Z","updated_at":"2025-12-20T22:11:51.144727551Z"}
{"id":"coding-tool-1r5.1","title":"Build student engagement report with CSV export","description":"Implement student engagement reporting that shows session participation by student within a section. Includes data aggregation, visualization, and CSV export functionality.\n\nFiles to create:\n- src/server/reports/engagement-report.ts - Engagement calculation logic\n- src/server/reports/export-service.ts - CSV/data export utilities\n- src/app/reports/page.tsx - Reports dashboard (instructors only)\n- src/app/reports/components/EngagementReport.tsx - Engagement display\n- src/app/reports/components/SectionSelector.tsx - Section filter\n- src/hooks/useReports.ts - Report data management\n\nImplementation steps:\n1. Create engagement calculation service:\n   - Query all sessions for a section\n   - Count participation per student\n   - Calculate attendance percentage\n   - Track first/last session dates\n   - Identify active vs inactive students\n\n2. Create export service:\n   - Generate CSV from report data\n   - Format: Student Email, Sessions Attended, Total Sessions, Attendance %, First Session, Last Session\n   - Support date range filtering\n   - Handle empty/no data cases\n\n3. Create reports dashboard page:\n   - Section selector dropdown\n   - Date range picker (optional filter)\n   - Generate report button\n   - Display results in table\n   - Export to CSV button\n   - Summary statistics (total students, avg attendance, etc.)\n\n4. Create EngagementReport component:\n   - Table with student data\n   - Sortable columns\n   - Search/filter by student name\n   - Attendance percentage visual (progress bar or color coding)\n   - Export button\n\n5. Create useReports hook:\n   - fetchEngagementReport(sectionId, startDate?, endDate?): Load report data\n   - exportToCsv(reportData): Trigger CSV download\n   - State management for reports\n\n6. Add API routes:\n   - GET /api/reports/engagement?sectionId=X\u0026start=Y\u0026end=Z - Generate report\n   - GET /api/reports/engagement/export?sectionId=X\u0026format=csv - Export data\n\nReport data structure:\n{\n  sectionId: string,\n  sectionName: string,\n  className: string,\n  dateRange: { start: Date, end: Date },\n  totalSessions: number,\n  students: [\n    {\n      userId: string,\n      email: string,\n      name?: string,\n      sessionsAttended: number,\n      attendancePercent: number,\n      firstSession?: Date,\n      lastSession?: Date,\n      isActive: boolean\n    }\n  ],\n  summary: {\n    totalStudents: number,\n    averageAttendance: number,\n    activeStudents: number\n  }\n}\n\nUI Layout:\n┌─────────────────────────────────────┐\n│ Student Engagement Report           │\n├─────────────────────────────────────┤\n│ Section: [CS 101 - Section A ▼]    │\n│ Date Range: [All Time ▼]           │\n│ [Generate Report]                   │\n├─────────────────────────────────────┤\n│ Summary:                            │\n│ Total Students: 25                  │\n│ Total Sessions: 12                  │\n│ Average Attendance: 83%             │\n├─────────────────────────────────────┤\n│ [Export CSV] [Search: ___]          │\n│ ┌─────────────────────────────────┐ │\n│ │Email    Sessions  Attend%  Last │ │\n│ │alice@   10/12     83%      Dec15│ │\n│ │bob@     12/12     100%     Dec15│ │\n│ │carol@   8/12      67%      Dec10│ │\n│ └─────────────────────────────────┘ │\n└─────────────────────────────────────┘\n\nCSV Export format:\nStudent Email,Sessions Attended,Total Sessions,Attendance %,First Session,Last Session\nalice@example.com,10,12,83%,2025-12-01,2025-12-15\nbob@example.com,12,12,100%,2025-12-01,2025-12-15\ncarol@example.com,8,12,67%,2025-12-01,2025-12-10\n\nFeatures:\n- Section-based engagement reports\n- Session participation counting\n- Attendance percentage calculation\n- CSV export for external analysis\n- Date range filtering\n- Summary statistics\n- Sortable and searchable table\n\nRBAC enforcement:\n- Only instructors can access reports\n- Instructors see only their sections\n- Student data privacy respected\n\nEdge cases:\n- Section with no sessions (show empty state)\n- Student joined mid-semester (calculate from join date)\n- Student with zero attendance (still show in report)\n- Very large sections (pagination or virtual scrolling)\n- Date range with no sessions (show message)\n- Export with no data (empty CSV with headers)\n\nDepends on:\n- coding-tool-d8z.3 (section-scoped sessions for data)\n- coding-tool-bzr.6 (session history for participation data)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:24:44.987674653Z","updated_at":"2025-12-18T19:24:44.987674653Z"}
{"id":"coding-tool-1rh","title":"Add integration tests for SectionView modal rendering","description":"Bug: CreateSectionModal was rendered after return statement (unreachable code). Tests didn't catch this.\n\nTest Gap: SectionView.test.tsx doesn't verify modal actually renders when button clicked.\n\nRequired Tests:\n1. Click 'New Section' button → verify CreateSectionModal appears in DOM\n2. Verify modal is rendered BEFORE any return statements (integration test)\n3. Test modal open/close state management\n4. Test modal submission triggers section creation API call\n\nFiles to test:\n- src/app/instructor/components/SectionView.tsx (lines 220-289)\n- Verify CreateSectionModal conditional rendering logic\n\nAcceptance Criteria:\n- Test fails if modal placed after return statement\n- Test verifies modal visibility when showCreateModal = true\n- Test covers button click → modal open → form submit → API call flow","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T00:59:01.048951655Z","updated_at":"2026-01-23T14:55:34.465345128Z","closed_at":"2026-01-23T14:55:34.465345128Z","close_reason":"Already completed - comprehensive modal integration tests exist in SectionView.test.tsx lines 415-636. The original bug (modal after return) was fixed."}
{"id":"coding-tool-1us","title":"Show email addresses in admin user views","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:04:14.49097693Z","created_by":"Joe Delfino","updated_at":"2026-01-29T04:06:34.474471967Z","closed_at":"2026-01-29T04:06:34.474471967Z","close_reason":"Completed"}
{"id":"coding-tool-1wx","title":"Student experience when session ends is broken","description":"## Summary\n\nWhen an instructor ends a session, students see a prompt to copy code or return to sessions, but clicking either option shows a generic error: \"Something went wrong. Please try again.\" Additionally, viewing a closed session as a student shows the same error. Students should be able to remain in the session (with code execution disabled) rather than being forced out.\n\n## Relevant Files\n\n- `src/app/(fullscreen)/student/components/SessionEndedNotification.tsx:1-154` — Session ended overlay with countdown timer and action buttons\n- `src/app/(fullscreen)/student/page.tsx:127-132` — useEffect detecting session end\n- `src/app/(fullscreen)/student/page.tsx:314-325` — SessionEndedNotification rendered as overlay\n- `src/hooks/useRealtimeSession.ts:290-299` — `session_ended` broadcast event handler\n\n## Issues to Fix\n\n1. **Error on action buttons**: The \"Copy Code\" and \"Return to Sessions\" buttons in `SessionEndedNotification.tsx` trigger an error. Debug the click handlers to find why they fail (likely trying to access session data that's been invalidated).\n2. **Viewing closed sessions**: Students navigating to a closed session get an error instead of a read-only view. The session page should handle `status === 'ended'` gracefully — show the code read-only with execution disabled.\n3. **UX improvement**: Instead of forcing students out, let them stay in the session with a banner indicating it's ended and code execution disabled. \"Copy code\" can remain as a convenience action.\n\nGitHub: #23","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:05:18.748883341Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:23:26.842778136Z","closed_at":"2026-01-28T22:23:26.842778136Z","close_reason":"Fixed in 1127cb0 — inline banner, read-only view, no forced redirect","labels":["wip"]}
{"id":"coding-tool-20i","title":"Prevent account enumeration on registration","description":"## Problem\nRegistration endpoint reveals whether an email is already registered:\n\n```typescript\n// src/app/api/auth/register/route.ts lines 64-68\nif (error.message?.includes('already exists') || error.message?.includes('duplicate')) {\n  return NextResponse.json(\n    { error: 'User with this email already exists' },  // ❌ Reveals email is valid\n    { status: 409 }\n  );\n}\n```\n\nThis allows attackers to enumerate valid user emails by attempting registration.\n\n## Impact\n- Low severity for this app (not high-value targets)\n- Attackers can build list of valid student/instructor emails\n- Could be used for phishing or credential stuffing attacks\n\n## Fix\nReturn generic error that doesn't distinguish between \"email taken\" and other failures:\n\n```typescript\nif (error.message?.includes('already exists') || error.message?.includes('duplicate')) {\n  return NextResponse.json(\n    { error: 'Unable to create account. Please try a different email or sign in.' },\n    { status: 400 }  // Use 400, not 409 (409 confirms existence)\n  );\n}\n```\n\n## Trade-off\nThis slightly worsens UX - users won't know if they already have an account. Could add \"Forgot password?\" link in error message as hint.\n\n## Alternative (better UX, same security)\n```typescript\nreturn NextResponse.json(\n  { error: 'If this email is not already registered, your account has been created. Check your email.' },\n  { status: 200 }  // Always return success\n);\n```\nThen rely on email verification to complete registration. Requires email verification to be implemented first.\n\n## File to modify\nsrc/app/api/auth/register/route.ts\n\n## Verification\n1. Try registering with existing email\n2. Should see generic error, not \"email already exists\"\n3. HTTP status should be 400, not 409","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-15T03:37:20.859212846Z","created_by":"node","updated_at":"2026-01-15T03:37:20.859212846Z"}
{"id":"coding-tool-27qk","title":"Create /instructor/session/[id] route","description":"Create src/app/(app)/instructor/session/[id]/page.tsx\n\nThis route replaces the inline session view in the instructor page when viewMode === 'session'.\n\nFeatures:\n- Use existing SessionView component from src/app/(app)/instructor/components/SessionView.tsx\n- Use useRealtimeSession hook for live data\n- Use useSessionOperations hook for API calls\n- Handle session not found / unauthorized states\n- URL pattern: /instructor/session/{sessionId}\n\nThis enables direct linking to sessions and removes the need for ?view=session\u0026sessionId=X\n\n**Testing:** Add tests in src/app/(app)/instructor/session/[id]/__tests__/page.test.tsx","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:02.489925881Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.606486886Z","closed_at":"2026-01-23T00:10:25.856002798Z","close_reason":"Completed"}
{"id":"coding-tool-2ar0","title":"Update AuthContext with MFA state","description":"Extend src/contexts/AuthContext.tsx to manage MFA flow state.\n\nFile to modify: src/contexts/AuthContext.tsx\n\nNew state:\n- mfaPending: boolean\n- pendingEmail: string | null\n\nNew functions:\n- sendMfaCode() - calls supabase.auth.signInWithOtp\n- verifyMfaCode(code) - calls verifyOtp then /api/auth/complete-mfa\n- cancelMfa() - clears pending state\n\nModify signIn to handle mfaRequired response","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:34:56.510567887Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:35.088063792Z","closed_at":"2026-01-20T18:42:35.088063792Z","close_reason":"AuthContext MFA state added"}
{"id":"coding-tool-2jv","title":"Session replacement: seamless problem-to-problem transitions","description":"When an instructor creates a new session while an old one is active, auto-end the old session and broadcast a session_replaced event so students can jump directly to the new session without returning to the dashboard. See plan file for details.","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:29:51.357829425Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:25:59.180937051Z","closed_at":"2026-01-30T22:25:59.180937051Z","close_reason":"Merged in PR #52","labels":["in-pr"]}
{"id":"coding-tool-2jv.1","title":"Service layer: replace active session instead of rejecting","description":"Add a helper function to end any existing active session before creating a new one. This replaces the current 'throw error if active session exists' behavior.\n\nFiles to modify:\n- src/server/services/session-service.ts — add endActiveSessionIfExists helper, remove throw blocks from createSession/createSessionWithProblem\n\nSteps:\n1. Add exported function: endActiveSessionIfExists(storage, creatorId, namespaceId): Promise\u003cstring | undefined\u003e\n2. Implementation: query listAllSessions({ instructorId, active: true, namespaceId }), if found call endSession on first, return its ID\n3. Remove the 'enforce single active session' throw blocks from createSession (lines 55-67) and createSessionWithProblem (lines 120-132)\n4. Keep return type as Promise\u003cSession\u003e — no signature changes\n\nTests (src/server/services/__tests__/session-service.test.ts):\n- endActiveSessionIfExists returns old session ID when active session exists\n- Returns undefined when no active session\n- createSession no longer throws when active session exists","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:30:04.103872084Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.40309822Z","closed_at":"2026-01-30T22:26:05.40309822Z","close_reason":"Merged in PR #52","labels":["wip"]}
{"id":"coding-tool-2jv.2","title":"API route: broadcast session_replaced on old channel","description":"After creating a new session via POST /api/sessions, if a session was replaced, broadcast session_replaced on the old channel and persist replacedBySessionId. No separate session_ended broadcast — session_replaced is the only event.\n\nFiles to modify:\n- src/app/api/sessions/route.ts — orchestrate replacement in POST handler\n- src/server/types/index.ts — add replacedBySessionId?: string to Session\n- supabase/migrations/00011_add_replaced_by_session_id.sql — ALTER TABLE sessions ADD COLUMN replaced_by_session_id UUID REFERENCES sessions(id)\n- src/server/persistence/supabase/session-repository.ts — add replaced_by_session_id to mapRowsToSession, updateSession, createSession column mappings\n- src/app/api/sessions/[id]/state/route.ts — include replacedBySessionId in state response for polling fallback\n\nPOST handler flow:\n1. Call endActiveSessionIfExists(storage, creatorId, namespaceId) → get replacedSessionId\n2. Create new session (existing code)\n3. If replacedSessionId: update old session with replacedBySessionId; broadcast session_replaced on session:${replacedSessionId} with { oldSessionId, newSessionId, replacedAt }; cleanup executor\n4. Return { session, replacedSessionId } in response\n\nTests: broadcast sent with correct event/payload; no broadcast when no replacement; replacedBySessionId persisted on old session","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:30:13.663225671Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.470132345Z","closed_at":"2026-01-30T22:26:05.470132345Z","close_reason":"Merged in PR #52","labels":["wip"]}
{"id":"coding-tool-2jv.3","title":"Realtime hook: listen for session_replaced event","description":"Add session_replaced broadcast listener to the realtime session hook so clients know about replacement.\n\nFiles to modify:\n- src/hooks/useRealtimeSession.ts — add replacementInfo state and broadcast handler\n- src/hooks/__tests__/useRealtimeSession.test.ts — test replacement event handling\n\nSteps:\n1. Add state: replacementInfo: { newSessionId: string } | null\n2. Add broadcast listener: .on('broadcast', { event: 'session_replaced' }, ...) that sets replacementInfo AND marks session status as completed\n3. Return replacementInfo from the hook\n4. Handle polling fallback: in fetchState, if response includes replacedBySessionId, set replacementInfo with { newSessionId: replacedBySessionId }\n\nTests: simulate session_replaced broadcast, verify replacementInfo is set and session status becomes completed","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:30:32.648364305Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.532009971Z","closed_at":"2026-01-30T22:26:05.532009971Z","close_reason":"Merged in PR #52","labels":["wip"]}
{"id":"coding-tool-2jv.4","title":"Student UI: replacement notification with redirect","description":"Update the student session-ended notification to show a Join New Session button when the session was replaced, and wire up navigation with full state reset.\n\nFiles to modify:\n- src/app/(fullscreen)/student/components/SessionEndedNotification.tsx — add replacement variant\n- src/app/(fullscreen)/student/components/__tests__/SessionEndedNotification.test.tsx — test replacement UI\n- src/app/(fullscreen)/student/page.tsx — consume replacementInfo, add handleJoinNewSession\n\nSessionEndedNotification changes:\n- Add optional props: replacementSessionId?: string, onJoinNewSession?: () =\u003e void\n- When replacementSessionId set: message = 'The instructor started a new problem.' + prominent blue 'Join New Session' button\n- Keep Copy Code and Back to Sections as secondary actions\n\nStudent page changes:\n- Consume replacementInfo from useRealtimeSession hook\n- Add handleJoinNewSession callback that resets ALL state before navigating:\n  - joinAttemptedRef.current = null\n  - setJoined(false)\n  - setSessionEnded(false)\n  - setCode('')\n  - setExecutionResult(null)\n  - setStudentExecutionSettings(null)\n  - Clear left-session:${oldSessionId} from sessionStorage\n  - router.push(/student?sessionId=${newSessionId})\n- Pass replacementSessionId and onJoinNewSession to SessionEndedNotification\n\nTests: notification renders Join New Session button when replacementSessionId set; button calls onJoinNewSession; normal ended message without replacement","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:30:32.718350875Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.572107304Z","closed_at":"2026-01-30T22:26:05.572107304Z","close_reason":"Merged in PR #52","labels":["wip"]}
{"id":"coding-tool-2jv.5","title":"Restore deleted SessionEndedNotification tests","status":"open","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T19:07:36.448554543Z","created_by":"Joe Delfino","updated_at":"2026-01-30T19:07:36.448554543Z"}
{"id":"coding-tool-2jv.6","title":"Restore deleted SessionEndedNotification tests","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T19:07:40.451031045Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.639441804Z","closed_at":"2026-01-30T22:26:05.639441804Z","close_reason":"Merged in PR #52"}
{"id":"coding-tool-2jv.7","title":"Fix stale JSDoc and extract broadcast to named function","status":"closed","priority":3,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T19:07:43.966939546Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:26:05.687356096Z","closed_at":"2026-01-30T22:26:05.687356096Z","close_reason":"Merged in PR #52"}
{"id":"coding-tool-2m5","title":"Give more horizontal space to left column on instructor session page","status":"closed","priority":3,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:04.337164878Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:04.108229553Z","closed_at":"2026-01-30T03:00:04.108229553Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-2p6a","title":"Refactor main instructor page to use dashboard","description":"Modify src/app/(app)/instructor/page.tsx\n\nCurrent state: 490 lines with ViewMode type and ?view= URL routing.\n\nReplace with simplified dashboard:\n- Remove ViewMode type and state (line 32)\n- Remove viewMode useState and URL sync useEffects (lines 50-75)\n- Remove classContext, sessionContext, problemSubView state\n- Remove breadcrumb building logic (lines 124-166)\n- Remove renderContent() switch statement\n- Render InstructorDashboard component from ia78.2 directly\n\nThe page should become ~50 lines - just render InstructorDashboard within the layout.\n\nNote: Session view moves to /instructor/session/[id] (ia78.4), problems to /instructor/problems (already exists), etc.\n\n**Testing:** Update existing tests in src/app/(app)/instructor/__tests__/ to match new simplified structure","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:13.958582261Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.602264094Z","closed_at":"2026-01-23T00:11:22.097115796Z","close_reason":"Instructor page now uses InstructorDashboard (490 lines -\u003e 85 lines)"}
{"id":"coding-tool-2t3","title":"Standardize join code format (with/without dashes) across codebase","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-15T03:43:54.894619583Z","created_by":"node","updated_at":"2026-01-15T03:43:54.894619583Z"}
{"id":"coding-tool-2wc","title":"Launch blockers","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:47:11.721176375Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.327166375Z","closed_at":"2026-01-24T00:11:22.756793296Z","close_reason":"All launch blockers completed and merged in PR #19"}
{"id":"coding-tool-301","title":"Public view layout improvements: side-by-side output, larger text, fix mobile regression","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:33:22.003101511Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:01:08.248318379Z","closed_at":"2026-01-30T15:01:08.248318379Z","close_reason":"Merged in PR #49"}
{"id":"coding-tool-301.1","title":"Add forceDesktop prop to CodeEditor to prevent mobile layout on public view","description":"## Summary\nWhen browser zoom increases on the public/projector view, CodeEditor switches to mobile layout because its internal `useResponsiveLayout(1024)` and `useMobileViewport()` hooks check `window.innerWidth`. The projector layout only prevented the outer shell from going mobile, not CodeEditor internals.\n\n## Files to modify\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx` (~lines 78-79, 492-569)\n- `src/app/(projector)/public-view/page.tsx` (~line 220-227)\n\n## Implementation steps\n1. Add `forceDesktop?: boolean` prop to CodeEditorProps interface in CodeEditor.tsx\n2. When `forceDesktop` is true, override `isDesktop` to `true` and `mobileViewport` to desktop values (isMobile=false, isTablet=false, isVerySmall=false, isDesktop=true, width=1920)\n3. In public-view/page.tsx, pass `forceDesktop={true}` to the CodeEditor component\n4. Add regression test: render CodeEditor with `forceDesktop={true}` at a narrow viewport and verify mobile toggle buttons (data-testid=\"mobile-show-code\", \"mobile-show-output\") are NOT rendered\n\n## Example\nBefore: CodeEditor always checks window.innerWidth, triggers mobile at \u003c1024px\nAfter: CodeEditor with forceDesktop={true} always uses desktop layout regardless of viewport","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:33:32.046905834Z","created_by":"Joe Delfino","updated_at":"2026-01-30T14:38:41.267339089Z","closed_at":"2026-01-30T14:38:41.267339089Z","close_reason":"Implemented in 018d757","labels":["wip"]}
{"id":"coding-tool-301.2","title":"Add side-by-side output layout to CodeEditor for public view","description":"## Summary\nThe public/projector view should show code on the left and output on the right (side-by-side), instead of the current stacked layout (output below code). This makes better use of projector screen real estate.\n\n## Files to modify\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx` (~lines 97-149 resize logic, 224-249 auto-grow, 912-1128 editor/output layout)\n- `src/app/(projector)/public-view/page.tsx` (~line 220-227)\n\n## Implementation steps\n1. Add `outputPosition?: 'bottom' | 'right'` prop to CodeEditorProps (default: 'bottom')\n2. Add `outputWidth` state (default ~40% or 400px) alongside existing `outputHeight` state\n3. In the resize mouse handler (lines 108-149), when `outputPosition === 'right'`:\n   - Track horizontal mouse movement instead of vertical\n   - Compute new width from the right edge of the container\n   - Constrain between 200px and 60% of container width\n4. In the auto-grow effect (lines 224-249), when `outputPosition === 'right'`:\n   - Skip the height-based auto-grow (or adapt to width-based, but width auto-grow is less useful)\n   - Keep output width stable to avoid jarring layout shifts\n5. In the desktop layout section (around line 912-1128), when `outputPosition === 'right'`:\n   - Change the container from `flex-col` to `flex-row`\n   - Editor area gets `flex-1 min-w-0`\n   - Output area uses `outputWidth` instead of `outputHeight`, with `min-h-0 h-full`\n   - Resize handle changes from horizontal bar (top of output) to vertical bar (left of output)\n6. In public-view/page.tsx, pass `outputPosition=\"right\"` to CodeEditor\n7. Tests:\n   - Render CodeEditor with `outputPosition=\"right\"` and verify horizontal layout container\n   - Regression test: render with default `outputPosition` and verify vertical layout still works\n\n## Important notes\n- React hooks (`useState` for outputWidth) must always be called -- use `outputPosition` to decide which state to apply, not whether to create it\n- The existing `outputPosition='bottom'` behavior must remain unchanged for student and instructor views\n- Merge conflict risk: this task and 301.3 both add props to CodeEditorProps and the public-view CodeEditor call. If done after 301.3, account for its changes.\n\n## Example\nBefore (stacked):\n```\n┌──────────────────────┐\n│    Code Editor       │\n├──────────────────────┤\n│    Output Panel      │\n└──────────────────────┘\n```\n\nAfter (side-by-side on public view):\n```\n┌──────────────┬───────┐\n│              │       │\n│ Code Editor  │Output │\n│              │       │\n└──────────────┴───────┘\n```","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:33:42.529278506Z","created_by":"Joe Delfino","updated_at":"2026-01-30T14:42:14.307498507Z","closed_at":"2026-01-30T14:42:14.307498507Z","close_reason":"Implemented in 366c7d0","labels":["wip"]}
{"id":"coding-tool-301.3","title":"Scale up public view text sizes for projector readability","description":"## Summary\nThe public/projector view text is too small for projection. Scale everything ~1.5x, with the join code getting extra prominence.\n\n## Files to modify\n- `src/app/(projector)/public-view/page.tsx` (lines 196-203 for header, line 209 for problem text, lines 220-227 for CodeEditor)\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx` (add fontSize prop)\n\n## Implementation steps\n1. Add optional `fontSize?: number` prop to CodeEditorProps in CodeEditor.tsx\n2. In CodeEditor, use `fontSize` prop (if provided) to override the Monaco editor's fontSize option (~line 946), falling back to existing logic\n3. In public-view/page.tsx, apply these changes:\n   - Join code (line 201): change `text-sm` to `text-2xl` for ~1.5x prominence\n   - Problem title (line 196): change `text-base` to `text-xl`\n   - Problem description MarkdownContent (line 209): change `text-sm` className to `text-base`\n   - \"No problem set\" text (line 211): change `text-sm` to `text-base`\n   - CodeEditor: pass `fontSize={20}` (~1.5x of 14px default)\n   - \"No submission\" text (lines 231-236): change `text-lg` to `text-2xl` and `text-sm` to `text-base`\n4. Add test: verify public view renders join code with `text-2xl` class\n\n## Example\nJoin code before: `\u003cspan className=\"text-sm font-bold text-blue-500 font-mono\"\u003e`\nJoin code after: `\u003cspan className=\"text-2xl font-bold text-blue-500 font-mono\"\u003e`","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:33:53.48093672Z","created_by":"Joe Delfino","updated_at":"2026-01-30T14:44:16.175189341Z","closed_at":"2026-01-30T14:44:16.175189341Z","close_reason":"Implemented in 2ce49f0","labels":["wip"]}
{"id":"coding-tool-3ll","title":"Fix overflow in connected students list on instructor dashboard","description":"## Problem\n\nOn the instructor session dashboard, the connected students list overflows into the editor area that shows student code. The rows are too short to properly display email addresses and action buttons.\n\n## Proposed Solution\n\n1. **Increase row height** - Make connected student rows 2 lines tall to fit:\n   - Student email address\n   - Action buttons\n\n2. **Shorten button text** - This is an expert/instructor view, so buttons can be concise:\n   - Keep buttons explanatory but more compact\n   - Examples: \"View\" instead of \"View Code\", \"Focus\" instead of \"Focus on Student\"\n\n## Files to Investigate\n\n- Look for instructor dashboard / session view components\n- Connected students list component\n- CSS/styling for the student list rows","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:28:08.973687638Z","created_by":"Joe Delfino","updated_at":"2026-01-23T21:45:34.805561094Z","closed_at":"2026-01-23T21:45:34.805561094Z","close_reason":"Fixed: Made student rows 2-line layout with shorter button text."}
{"id":"coding-tool-3voq","title":"Fix SessionView test failures on nav-layout branch","description":"Fix failing tests in src/app/(app)/instructor/components/__tests__/SessionView.test.tsx\n\nCurrent failures (6 tests):\n- Tests expect data-testid='problem-setup-panel' but component uses different structure\n- Tests expect data-testid='problem-title' which doesn't exist in actual component\n\nThe tests were written for a panel-based layout but the component now uses tabs.\n\nFix approach:\n1. Update test mocks to match actual component structure\n2. Or update component to include expected test IDs\n3. Ensure tests verify actual behavior, not just element presence\n\nRun: cd /workspaces/coding-tool-nav-layout \u0026\u0026 npm test\n\nThis should be done BEFORE starting ia78 work on the branch.","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T22:58:57.732723633Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.574646761Z","closed_at":"2026-01-22T23:55:44.387172792Z","close_reason":"Fixed test failures by updating mocks for tab-based layout"}
{"id":"coding-tool-43v","title":"Student leaving a session doesn't work","description":"## Summary\n\nWhen a student clicks \"Leave Session\", they are immediately returned to the session instead of leaving. The leave action is client-side only and does not persist.\n\n## Relevant Files\n\n- `src/app/(fullscreen)/student/page.tsx:288-293` — Leave Session button\n- `src/app/(fullscreen)/student/page.tsx:145-158` — `handleLeaveSession` function (resets local state and refetches sessions)\n\n## Root Cause\n\nThe `handleLeaveSession` function only clears client-side state. There is no API call to remove the student from the session, and the refetch likely finds the same active session and re-joins. The student needs to be actually removed from the session server-side, or the client needs to track an explicit \"left\" state that prevents auto-rejoin.\n\n## Steps to Fix\n\n1. Decide on approach: either (a) add an API endpoint to mark the student as having left the session, or (b) persist a client-side flag (e.g., sessionStorage) that prevents auto-rejoin\n2. Option (a) is cleaner: add a `left_at` timestamp or `status` field to `session_students`, add a `POST /api/sessions/[id]/leave` route, and check this before auto-joining\n3. Update `handleLeaveSession` to call the leave API\n4. Update session join logic to not auto-join if the student has explicitly left\n\nGitHub: #27","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:04:26.463529344Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:26:12.700274046Z","closed_at":"2026-01-28T22:26:12.700274046Z","close_reason":"Fixed in d27aa3f — sessionStorage flag prevents auto-rejoin after leaving","labels":["wip"]}
{"id":"coding-tool-442e","title":"Create bootstrap registration page","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:35:08.194251628Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:45.68378338Z","closed_at":"2026-01-20T18:42:45.68378338Z","close_reason":"bootstrap registration page created"}
{"id":"coding-tool-49i","title":"Mark featured student in instructor Students tab","description":"## Summary\n\nOn the instructor session view, the Students tab does not visually indicate which student is currently featured. The AI Walkthrough tab correctly highlights the featured student, but the Students tab does not.\n\n## Relevant Files\n\n- `src/app/(app)/instructor/components/SessionStudentPane.tsx:73-191` — Students tab panel\n- `src/app/(app)/instructor/components/StudentList.tsx:86-96` — Feature button rendering; has `onShowOnPublicView` callback but no visual indicator for the currently-featured student\n- `supabase/migrations/00001_initial_schema.sql:157-158` — `featured_student_id` column on `sessions` table\n\n## Steps to Fix\n\n1. Pass the current `featured_student_id` from session state into `StudentList`\n2. In `StudentList.tsx`, compare each student's ID to `featured_student_id` and apply a visual highlight (border, background, badge, or icon) to the featured student's row\n3. Ensure the highlight updates in real-time when a different student is featured\n\nGitHub: #28","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:04:11.228181212Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:16:26.861438678Z","closed_at":"2026-01-28T22:16:26.861438678Z","close_reason":"Fixed in ef24856 — featured student highlighted with badge in Students tab","labels":["wip"]}
{"id":"coding-tool-4eyw","title":"Page Cleanup - Remove Redundant Headers/Nav","description":"Update existing pages to use the new layout system.\n\n## Remove from Each Page\n\n### Redundant Headers\nEach page currently has its own header with sign-out button. Remove:\n- Inline `\u003cheader\u003e` elements with user info display\n- `handleSignOut` function and `isSigningOut` state (4+ duplicates across pages)\n- Sign-out button components\n\n### Redundant ProtectedRoute Wrappers\nMove auth checks to layout level:\n- Remove `\u003cProtectedRoute\u003e` wrapper from page components\n- Auth is now handled by (app)/layout.tsx\n\n### Page-Specific Navigation\n- Remove `InstructorNav` component usage (sidebar handles this now)\n- Remove inline tab navigation that duplicates sidebar functionality\n\n## Add to Each Page\n\n### PageBreadcrumb\nAdd at top of each page with dynamic labels where needed:\n```tsx\n\u003cPageBreadcrumb /\u003e\n// or with custom items:\n\u003cPageBreadcrumb items={[\n  { label: 'Classes', href: '/classes' },\n  { label: className }\n]} /\u003e\n```\n\n## Pages to Update\n\n### High Priority (Main User Flows)\n\n**src/app/instructor/page.tsx**\n- Remove: Header (lines ~679-717), sign-out logic, InstructorNav\n- Keep: Core view logic, tab state for session view\n- Add: PageBreadcrumb\n\n**src/app/student/page.tsx**\n- Remove: Header (lines ~287-323), sign-out logic\n- Add: Back navigation to sections (via breadcrumb or explicit link)\n- Note: Uses fullscreen layout, sidebar auto-collapsed\n\n**src/app/sections/page.tsx**\n- Remove: Header, sign-out logic\n- Add: PageBreadcrumb\n\n**src/app/admin/page.tsx**\n- Remove: Header (lines ~49-150), sign-out logic, ProtectedRoute wrapper\n- Add: PageBreadcrumb\n\n**src/app/system/page.tsx**\n- Remove: Header (lines ~81+), sign-out logic, inline role check\n- Add: PageBreadcrumb\n- Note: Role check moves to (app)/layout.tsx\n\n### Medium Priority (Secondary Pages)\n\n**src/app/classes/page.tsx**\n- Remove: Header, inline role check useEffect\n- Add: PageBreadcrumb\n\n**src/app/classes/[id]/page.tsx**\n- Remove: Any header/nav components\n- Add: PageBreadcrumb with class name\n\n**src/app/sections/[sectionId]/page.tsx**\n- Remove: Header\n- Add: PageBreadcrumb with section name\n\n**src/app/namespace/invitations/page.tsx**\n- Remove: Header\n- Add: PageBreadcrumb\n\n## Existing Patterns to Preserve\n\n### NamespaceHeader Component\nKeep `\u003cNamespaceHeader /\u003e` where used - it shows namespace context, not redundant header.\nIt will render inside the main content area, below PageBreadcrumb.\n\n### Connection Status Indicators\nPreserve any realtime connection status displays - just relocate if needed.\n\n## Verification Checklist\n- [ ] Each page renders correctly within AppShell\n- [ ] No duplicate headers or sign-out buttons\n- [ ] Breadcrumbs show correct hierarchy\n- [ ] Deep links still work (e.g., /instructor?view=sessions)\n- [ ] Back/forward navigation works correctly\n- [ ] NamespaceHeader still functions where needed","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:25:20.014113041Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.618337302Z","closed_at":"2026-01-22T03:35:55.404455338Z","close_reason":"Completed"}
{"id":"coding-tool-4hxo","title":"Create MFA cookie utility","description":"Create src/server/auth/mfa-cookie.ts with signed cookie utilities.\n\n**Files to create:**\n- src/server/auth/mfa-cookie.ts\n- src/server/auth/__tests__/mfa-cookie.test.ts\n\n**Functions:**\n- signMfaCookie(email: string): string - Sign cookie with email + expiry (5 min)\n- verifyMfaCookie(cookie: string | undefined): { email: string; valid: boolean }\n\n**Implementation:**\n- Use HMAC-SHA256 with SUPABASE_SECRET_KEY\n- Cookie format: email:expiresAt:signature\n- 5 minute expiry","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:32:04.50390271Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:14.028242838Z","closed_at":"2026-01-20T18:42:14.028242838Z","close_reason":"MFA cookie utility implemented"}
{"id":"coding-tool-4i4","title":"Replace real setTimeout sleeps in Jest unit tests with fake timers or waitFor","description":"Several Jest tests use real `await new Promise(resolve =\u003e setTimeout(resolve, N))` sleeps instead of fake timers or `waitFor`. These introduce flakiness and slow down the test suite.\n\n**Files and instances to fix:**\n\n1. **src/hooks/__tests__/useRealtimeSession.test.ts:155** — `await new Promise(resolve =\u003e setTimeout(resolve, 100))` to allow async effects. Replace with `waitFor` or `act` + flush microtasks.\n\n2. **src/server/classes/__tests__/class-repository.test.ts:155,289** — `await new Promise(resolve =\u003e setTimeout(resolve, 10))` to ensure timestamp differences. Replace by mocking `Date.now()` or using fake timers to advance time deterministically.\n\n3. **src/server/classes/__tests__/section-repository.test.ts:256** — Same timestamp sleep pattern as class-repository. Same fix.\n\n4. **src/server/classes/__tests__/membership-repository.test.ts:219** — `await new Promise(resolve =\u003e setTimeout(resolve, 5))` for timestamp ordering. Same fix.\n\n5. **src/app/(fullscreen)/student/__tests__/page-leave-session.test.tsx:105** — `await new Promise(r =\u003e setTimeout(r, 100))` to let effects complete. Replace with `waitFor` from testing-library.\n\n**NOT in scope (these are fine):**\n- `jest.advanceTimersByTime` usage (fake timers, correct pattern)\n- `setTimeout` inside mock implementations (simulating slow responses for loading state tests)\n- Integration test polling loops (vercel-sandbox-backend)","status":"open","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:23:12.811360671Z","created_by":"Joe Delfino","updated_at":"2026-01-30T18:23:24.391990885Z"}
{"id":"coding-tool-4lo","title":"Replace page.waitForTimeout calls in E2E tests with explicit waitFor conditions","description":"E2E tests use `page.waitForTimeout()` which is a hard sleep — fragile and slow. These should be replaced with condition-based waits (`waitForSelector`, `expect(...).toBeVisible()`, `waitForURL`, polling assertions, etc.).\n\n**Files and instances to fix:**\n\n1. **e2e/critical-paths.spec.ts:268** — `waitForTimeout(800)` waiting for initial code sync debounce. Replace: poll the instructor/public view for the expected code content using `expect(locator).toContainText()` with a timeout, or wait for a network-idle signal.\n\n2. **e2e/critical-paths.spec.ts:277,279** — `waitForTimeout(200)` and `waitForTimeout(300)` for Monaco editor select-all and clear. Replace: after pressing Ctrl+A then Backspace, assert the editor content is empty before proceeding. Use `page.evaluate` to check Monaco's model value.\n\n3. **e2e/critical-paths.spec.ts:287** — `waitForTimeout(2000)` for debounced code sync. Replace: on the instructor page, use `expect(locator).toContainText(expectedCode)` with a generous timeout (e.g., 10s). This is the most important one — a 2s sleep is both slow and flaky.\n\n4. **e2e/public-view.spec.ts:162** — `waitForTimeout(2000)` for debounced code sync. Same fix as #3.\n\n5. **e2e/invitation-flow.spec.ts:224** — `waitForTimeout(2000)` for distinct email timestamps. This may be harder to replace — consider asserting the second email has a different timestamp, or restructuring the test to not depend on timestamp ordering.\n\n6. **e2e/invitation-flow.spec.ts:256** — `waitForTimeout(1000)` in email polling loop. This is a polling pattern with a bounded loop, which is acceptable but could use a helper like `expect.poll()` or Playwright's built-in retry.\n\n**Also review:**\n- **e2e/critical-paths.spec.ts:282** — `page.keyboard.type(code, { delay: 50 })` — the per-keystroke delay may be necessary for Monaco but consider if a lower value (10-20ms) works, or if pasting via clipboard is more reliable.\n\n**NOT in scope (acceptable):**\n- `test.setTimeout(60000)` — extending test timeout for legitimately complex tests\n- `page.waitForURL(..., { timeout: 5000 })` — condition-based wait with timeout, this is correct","status":"open","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:23:27.406385678Z","created_by":"Joe Delfino","updated_at":"2026-01-30T18:23:43.249942963Z"}
{"id":"coding-tool-4m4","title":"Instructor Reporting and Analytics Tools","description":"Implement reporting and analytics tools for instructors to track student engagement, participation, and progress. Provides data export capabilities and insights into section activity. Initial focus on student engagement metrics with extensibility for future analytics.\n\n**Reporting Goals:**\n- Student engagement tracking (session participation)\n- Section-level analytics and comparisons\n- Data export for external analysis\n- Visual dashboards and summaries\n- Exportable reports in multiple formats\n\n**Initial Features:**\n- Student engagement report by section\n- Session participation counts per student\n- Export to CSV/Excel\n- Date range filtering\n- Section comparison views\n\n**Future Reporting Capabilities:**\n- Code submission metrics\n- Problem completion rates\n- Time spent coding per session\n- Debugging tool usage statistics\n- Revision history analysis\n- Comparison across sections/semesters\n- Individual student progress tracking\n- Automated grade export integration\n\n**Report Types:**\n1. Student Engagement (initial)\n   - Sessions participated in\n   - Active vs passive participation\n   - Attendance trends over time\n   - Section-by-section breakdown\n\n2. Future reports:\n   - Code quality metrics\n   - Problem difficulty analysis\n   - Time-on-task analytics\n   - Peer collaboration patterns\n   - Progress tracking\n\n**Data Export Formats:**\n- CSV (for spreadsheet import)\n- JSON (for programmatic access)\n- PDF (printable reports)\n- Excel (with formatting)\n\n**Modules to create:**\n- src/server/reports/ (new directory)\n  - report-generator.ts - Core report generation\n  - engagement-report.ts - Student engagement calculations\n  - export-service.ts - Data export formatting\n  - report-repository.ts - Cached report storage\n\n**Success Criteria:**\n- Instructors can generate engagement reports\n- Reports filterable by section and date range\n- Export to CSV works reliably\n- Data accurate and matches session records\n- Performance acceptable for large sections\n- Reports accessible from instructor dashboard","status":"open","priority":3,"issue_type":"epic","created_at":"2026-01-05T16:23:13.804190219Z","created_by":"node","updated_at":"2026-01-05T16:23:13.804190219Z"}
{"id":"coding-tool-51o","title":"Add markdown rendering support for problem descriptions","description":"Add markdown rendering support for problem descriptions (no image support needed).\n\n**Summary**: Problem descriptions currently display as plain text. Adding markdown support will allow instructors to format problem statements with headers, lists, code blocks, and emphasis for better readability.\n\n**Files to modify**:\n- Problem display components (likely in src/components/ or src/app/)\n- May need markdown parsing library (e.g., react-markdown, marked, or similar)\n\n**Implementation steps**:\n1. Identify where problem descriptions are rendered (search for problem description display)\n2. Install markdown parsing library: `npm install react-markdown` (or similar)\n3. Replace plain text rendering with markdown component\n4. Test with various markdown syntax (headers, lists, code blocks, bold, italic)\n5. Add CSS styling if needed for markdown output\n6. Update tests to verify markdown rendering\n\n**Scope**: Basic markdown only - headers, lists, code blocks, bold, italic, links. No image support needed.\n\n**Example**: \nBefore: \"Write a function that...\\nInput: list of integers\"\nAfter: \"## Problem\\nWrite a function that...\\n\\n**Input**: list of integers\"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-30T05:57:22.341990883Z","updated_at":"2025-12-30T05:57:32.664102746Z"}
{"id":"coding-tool-51u","title":"Analysis completion should not auto-feature student on public view","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T17:52:19.24747467Z","created_by":"Joe Delfino","updated_at":"2026-01-29T17:53:27.12437634Z","closed_at":"2026-01-29T17:53:27.12437634Z","close_reason":"Fixed: removed auto-feature useEffect"}
{"id":"coding-tool-52aq","title":"Remove type constraint tests from invitations/types.test.ts","description":"Remove tests verifying TypeScript type system works correctly (optional fields can be undefined, InvitableRole constraints, etc.)\n\nFiles to modify:\n- src/server/invitations/__tests__/types.test.ts (lines 140-192)\n\nThese test language features, not application logic. TypeScript compiler handles this.\n\nEstimated reduction: ~50 lines\n\nVerification:\n1. npm test -- should pass\n2. npx tsc --noEmit -- should pass (proves types still enforced)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T17:29:43.415992464Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.636822677Z","closed_at":"2026-01-20T18:06:32.040110263Z","close_reason":"Completed"}
{"id":"coding-tool-55y","title":"Audit and separate realtime broadcast channels by audience","description":"Currently all three session audiences (student view, instructor dashboard, projector/public view) subscribe to the same `session:${sessionId}` Broadcast channel and receive all events. This works but leaks events to audiences that don't need them.\n\n**Current state:**\n- Channel: `session:${sessionId}` (Supabase Broadcast)\n- Subscription setup: `src/hooks/useRealtimeSession.ts` (lines 229-342) — used by both student and instructor views\n- Projector: `src/app/(projector)/public-view/page.tsx` (lines 83-109) — own subscription to same channel, listens to fewer events\n\n**Events broadcast on the shared channel:**\n| Event | Sent by | Needed by |\n|-------|---------|-----------|\n| `student_joined` | `/api/sessions/[id]/join/route.ts` | Instructor |\n| `student_code_updated` | `/api/sessions/[id]/code/route.ts` | Instructor |\n| `session_ended` | `/api/sessions/[id]/route.ts` | Student, Instructor |\n| `featured_student_changed` | `/api/sessions/[id]/feature/route.ts` | Projector |\n| `problem_updated` | `/api/sessions/[id]/update-problem/route.ts` | Student, Projector |\n\n**Issues:**\n- Students receive `student_joined`, `student_code_updated`, and `featured_student_changed` — none of which they use\n- Projector receives `student_joined`, `student_code_updated`, `session_ended` — none of which it uses\n- Any new projector-only events (e.g. `solution_displayed` from epic coding-tool-vqo) would be visible to students if added to this channel\n\n**Proposed fix:**\nSplit into audience-specific channels:\n- `session:${sessionId}:students` — `session_ended`, `problem_updated`\n- `session:${sessionId}:instructor` — `student_joined`, `student_code_updated`, `session_ended`, `problem_updated`\n- `session:${sessionId}:projector` — `featured_student_changed`, `problem_updated`, `solution_displayed`\n\nAlternatively, two channels (student vs instructor/projector) may be sufficient.\n\n**Files to modify:**\n- `src/hooks/useRealtimeSession.ts` — split subscription logic by role\n- `src/app/(projector)/public-view/page.tsx` — subscribe to projector channel\n- All API routes in `src/app/api/sessions/[id]/` that broadcast events — send to appropriate channel(s)\n- Server-side broadcast helpers (if any shared utility exists)\n\n**Risk:** Moderate — touches realtime infrastructure used by all session views. Needs thorough E2E testing.","status":"open","priority":3,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:41:05.252015002Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:41:05.252015002Z"}
{"id":"coding-tool-5ea","title":"Critical: Student code saving broken due to RLS policy on session_students","description":"## Summary\n\nStudent code saving fails in production with a 500 error. The Supabase RLS policy on `session_students` rejects UPSERTs from the service layer.\n\n## Error\n\n```\nPersistenceError: Failed to update session students: new row violates row-level security policy for table \"session_students\"\n```\n\nThe client sees repeated 500 errors on `POST /api/sessions/{id}/code`.\n\n## Relevant Files\n\n- `supabase/migrations/00001_initial_schema.sql:552-587` — RLS policies for `session_students`\n- `supabase/migrations/00008_session_students_user_id_required.sql` — Removed `student_id`, made `user_id` primary; RLS policies may not have been updated to match\n- `src/server/persistence/supabase/session-repository.ts:276-300` — `updateSession` UPSERT into `session_students`\n- `src/app/api/sessions/[id]/code/route.ts:47-162` — POST handler that calls `SessionService.updateStudentCode`\n\n## Root Cause Investigation\n\nMigration 00008 changed the `session_students` schema (removed `student_id`, uses `user_id`), but the RLS UPDATE policy in 00001 may reference stale columns or conditions. The UPSERT in `session-repository.ts:276-300` likely fails the UPDATE policy check.\n\n## Steps to Fix\n\n1. Compare the RLS UPDATE policy (00001:577-587) against the current schema after migration 00008\n2. Write a new migration that fixes the RLS policy to allow authenticated users to update their own `session_students` rows via `user_id`\n3. Test with a student joining a session and saving code\n\nGitHub: #29","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:03:57.085527636Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:11:35.311798209Z","closed_at":"2026-01-28T22:11:35.311798209Z","close_reason":"Fixed in fff0c2d — upserts only the calling student row to comply with RLS","labels":["wip"]}
{"id":"coding-tool-5ic","title":"Implement server-side Python execution tracing","description":"Build server-side infrastructure to execute Python code with full execution tracing, capturing all states, variable values, and call stack at each step. Returns a complete trace that enables forward/backward debugging on the client. Includes configurable step limit to prevent infinite loops and excessive memory usage.\n\nFiles to modify:\n- src/server/types.ts - Add ExecutionTrace, TraceStep, VariableState types\n- src/server/code-tracer.ts - Create Python tracing service (new file)\n- src/server/websocket-handler.ts - Add trace-request handler\n- package.json - Add Python tracing dependencies\n\nImplementation steps:\n1. Define trace types in src/server/types.ts:\n   - TraceStep: { line: number, event: string, locals: object, globals: object, callStack: CallFrame[], stdout: string }\n   - CallFrame: { functionName: string, filename: string, line: number }\n   - ExecutionTrace: { steps: TraceStep[], totalSteps: number, exitCode: number, error?: string, truncated?: boolean }\n\n2. Create src/server/code-tracer.ts using Python sys.settrace or external tool:\n   - Option A: Use bdb/pdb to trace execution programmatically\n   - Option B: Use pythontutor/pgbovine approach with custom trace script\n   - Option C: Use existing library like python-execution-trace\n   - traceExecution(code: string, stdin?: string, maxSteps?: number): Promise\u003cExecutionTrace\u003e\n   - Default maxSteps to 5000\n\n3. Implement Python trace wrapper script:\n   - Inject trace hooks before student code\n   - Capture line-by-line execution events\n   - Record local/global variable snapshots at each step\n   - Track function calls and returns for call stack\n   - Capture stdout incrementally\n   - Handle exceptions and errors gracefully\n   - Enforce step limit (stop after maxSteps)\n   - Set truncated=true if step limit reached\n   - Output JSON trace to stdout\n\n4. Add WebSocket handler in websocket-handler.ts:\n   - New message type: trace-request with code, optional stdin, optional maxSteps\n   - Execute tracing on server with step limit\n   - Return complete trace as trace-response\n   - Handle timeout (e.g., 10 seconds max trace time)\n\n5. Security and limits:\n   - Default max execution steps: 5000\n   - Allow override in trace-request (but enforce server-side maximum)\n   - Timeout for trace generation (10 seconds)\n   - Sanitize variable values (truncate large strings/objects)\n   - Memory limits on trace size\n\nStep limit behavior:\n- When step count reaches maxSteps, stop tracing immediately\n- Set truncated=true in ExecutionTrace response\n- Include all steps up to the limit\n- Return partial trace (still useful for debugging first N steps)\n- Client UI should show warning: Program exceeded 5000 steps - trace truncated\n\nExample trace output structure:\n{\n  steps: [\n    { line: 1, event: 'line', locals: {}, globals: {}, callStack: [{functionName: '\u003cmodule\u003e', line: 1}], stdout: '' },\n    { line: 2, event: 'line', locals: {x: 5}, globals: {}, callStack: [{functionName: '\u003cmodule\u003e', line: 2}], stdout: '' },\n    { line: 3, event: 'call', locals: {n: 5}, globals: {factorial: '\u003cfunction\u003e'}, callStack: [{functionName: 'factorial', line: 3}, {functionName: '\u003cmodule\u003e', line: 2}], stdout: '' }\n  ],\n  totalSteps: 15,\n  exitCode: 0,\n  truncated: false\n}\n\nEdge cases:\n- Infinite loops (step limit prevents trace explosion)\n- Very large data structures (truncate/summarize)\n- Recursive functions (track call depth)\n- Exceptions and errors (capture in trace)\n- Multiple files/imports (trace only student code)\n- Code that modifies sys.settrace (detect and prevent)\n- Empty or syntax-error code (return error in trace)\n- Step limit reached (return partial trace with truncated flag)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:05:35.222048974Z","updated_at":"2025-12-18T19:07:53.260129532Z"}
{"id":"coding-tool-5jg","title":"Create StartSessionModal component","description":"Create src/app/(app)/instructor/components/StartSessionModal.tsx\n\nNote: CreateSessionFromProblemModal.tsx exists but is triggered from ProblemCard. This modal is for starting a session from the dashboard (ia78.2).\n\nProps:\n- sectionId: string\n- sectionName: string\n- onClose: () =\u003e void\n- onSessionCreated: (sessionId: string) =\u003e void\n\nFeatures:\n- Problem picker (list from /problems API)\n- 'Create blank session' option\n- On confirm: create session via API for the given section\n- Navigate to /instructor/session/[id] on success (route from coding-tool-ia78.4)\n- Handle loading and error states\n\n**Testing:** Add unit tests in src/app/(app)/instructor/components/__tests__/StartSessionModal.test.tsx","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:35:45.287787928Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.352884042Z","closed_at":"2026-01-23T00:11:12.7794375Z","close_reason":"Completed"}
{"id":"coding-tool-5wv5","title":"Improve invitation email delivery and scanner resilience","description":"## Problem\n\nInvitation emails are unreliable in production:\n\n1. **No SMTP configured** - Using Supabase's built-in email service which is rate-limited and unreliable\n2. **Security scanners consume tokens** - .edu and enterprise email systems auto-click links, verifying tokens before users can\n3. **Partial user state** - Users end up in auth.users with email_confirmed but no app profile\n\n## Evidence\n\n- Invite to jdelfino@brandeis.edu never arrived in inbox\n- email_confirmed_at was set 11 seconds after invite (security scanner clicked link)\n- User couldn't complete profile setup, couldn't be re-invited (user already registered)\n\n## Tasks\n\n### Email Delivery\n- Configure SMTP in production Supabase (SendGrid, AWS SES, or Resend)\n- Set up SPF/DKIM for sender domain\n- Document SMTP setup in deployment docs\n\n### Scanner Resilience\n- Research Supabase options for multi-use or delayed-consumption tokens\n- Consider adding a confirm button on accept page before consuming token\n- Or: detect scanner user-agents and ignore those verifications\n\n### Partial State Recovery\n- Add admin UI to manually complete stuck invitations\n- Or: detect users in auth.users without profile and prompt to complete setup\n- Add monitoring/alerting for invitations stuck in partial state\n\n## References\n\n- Supabase email templates: docs/deployment/supabase-email-templates.md\n- Invitation service: src/server/invitations/invitation-service.ts\n- Accept flow: src/app/invite/accept/page.tsx","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@gmail.com","created_at":"2026-01-21T05:52:51.842776794Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.584793677Z","closed_at":"2026-01-23T03:35:39.990393295Z","close_reason":"Fixed: SMTP configured via Vercel. Resend flow now cleans up orphaned auth users (scanner clicks or abandoned onboarding) and creates fresh invitations."}
{"id":"coding-tool-5zv","title":"Improve student first-time sign-on flow UX","description":"## Problem\n\nMultiple UX issues with the student sign-on flow:\n\n### Issue 1: No feedback after registration\nCurrent flow:\n1. Student enters a join code\n2. Fills out a 'profile' page with email and password\n3. Gets immediately redirected to a sign-in page with no feedback\n\nStudents don't know if registration succeeded or failed.\n\n### Issue 2: Redundant join code step\nWhen entering a join code on the homepage (`/`) and clicking \"Join Section\":\n1. User is taken to `/register/student`\n2. Shows a similar form with the join code already filled in and a \"Continue\" button\n3. This is redundant - the join code was already entered\n\n**Key insight:** Students will likely use the join code input on the homepage as a quick way to navigate back into the app, not just for first-time registration. The current flow forces them back into registration unnecessarily.\n\n## Proposed Solutions\n\n### For Issue 1 (choose one):\n**Option A (preferred):** Auto-login after registration\n- After successful signup, automatically authenticate and redirect to classroom\n\n**Option B:** Show clear success feedback\n- Display \"Registration successful! Please sign in with your email and password.\"\n\n### For Issue 2:\nThe `/register/student` page should offer a clear, balanced choice:\n- **Already have an account?** → Sign in button (prominent)\n- **New student?** → Continue to registration\n\nAlternatively, if the system can detect the user already has an account (e.g., email exists), redirect them to login automatically.\n\n## Files to Investigate\n\n- src/app/join/ - Join code entry flow\n- src/app/register/student/ - Student registration page\n- src/app/signup/ or src/app/auth/ - Registration flow\n- Supabase auth configuration","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:13:13.431401459Z","created_by":"Joe Delfino","updated_at":"2026-01-23T22:30:08.458565137Z","closed_at":"2026-01-23T22:30:08.458565137Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-60g","title":"Fix overflow in connected students list on instructor dashboard","description":"## Problem\n\nOn the instructor session dashboard, the connected students list overflows into the editor area that shows student code. The rows are too short to properly display email addresses and action buttons.\n\n## Proposed Solution\n\n1. **Increase row height** - Make connected student rows 2 lines tall to fit:\n   - Student email address\n   - Action buttons\n\n2. **Shorten button text** - This is an expert/instructor view, so buttons can be concise:\n   - Keep buttons explanatory but more compact\n   - Examples: \"View\" instead of \"View Code\", \"Focus\" instead of \"Focus on Student\"\n\n## Files to Investigate\n\n- Look for instructor dashboard / session view components\n- Connected students list component\n- CSS/styling for the student list rows","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:28:08.973687638Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.358843375Z","closed_at":"2026-01-23T21:45:34.805561094Z","close_reason":"Fixed: Made student rows 2-line layout with shorter button text."}
{"id":"coding-tool-6es","title":"Improve code analysis: dynamic issue-based bucketing with completion summary","description":"GitHub Issue: #36 - Code analysis is not detailed enough\n\n## Summary\nReplace the fixed 4-category analysis (Error/Edge Case/Interesting/Exemplary) with dynamic, bug-specific issue groups ordered by frequency. Add a completion estimate so instructors know how many students are done.\n\n## Current behavior\n- AI picks 3-8 individual student submissions\n- Groups into 4 fixed categories: common-error, edge-case, interesting-approach, exemplary\n- Often produces one big \"Error\" bucket with no specificity\n- No completion summary\n\n## Desired behavior\n- AI identifies distinct bugs/patterns across all submissions (e.g., \"Off-by-one in loop\", \"Missing return statement\")\n- Groups students by specific issue, ordered by frequency (most common first)\n- Shows completion estimate: \"12 finished · 5 in progress · 3 not started\"\n- Quick-scan UI for live lecturing\n\n## Key files\n- src/server/types/analysis.ts\n- src/server/services/gemini-analysis-service.ts\n- src/app/(app)/instructor/hooks/useAnalysisGroups.ts\n- src/app/(app)/instructor/components/GroupNavigationHeader.tsx\n- src/app/(app)/instructor/components/StudentAnalysisDetails.tsx\n- src/app/(app)/instructor/components/SessionStudentPane.tsx\n- src/app/(app)/instructor/constants/analysis.ts","status":"open","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T18:32:49.082101209Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:32:49.082101209Z"}
{"id":"coding-tool-6es.1","title":"Replace analysis types with issue-based model","description":"## Summary\nReplace the old entry-based types with issue-based types in src/server/types/analysis.ts.\n\n## Files to modify\n- src/server/types/analysis.ts\n\n## Implementation steps\n1. Remove old types: WalkthroughEntry, WalkthroughCategory, GeminiAnalysisResponse\n2. Add new types:\n   - IssueSeverity: 'error' | 'misconception' | 'style' | 'good-pattern'\n   - AnalysisIssue: { title, explanation, count, studentIds, representativeStudentLabel, representativeStudentId, severity }\n   - GeminiAnalysisResponseV2: { issues: Array\u003c{title, explanation, studentLabels[], severity}\u003e, finishedStudentLabels: string[], overallNote?: string }\n3. Update WalkthroughScript: replace entries: WalkthroughEntry[] with issues: AnalysisIssue[]\n4. Add completionEstimate to WalkthroughSummary: { finished: number, inProgress: number, notStarted: number }\n5. Remove commonPatterns from WalkthroughSummary (replaced by overallNote on script)\n6. Add overallNote?: string to WalkthroughScript","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T18:32:57.964934546Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:45:41.833618636Z","closed_at":"2026-01-29T18:45:41.833618636Z","close_reason":"Implemented in 302a574","labels":["wip"]}
{"id":"coding-tool-6es.2","title":"Rework Gemini prompt and parser for issue-based analysis","description":"## Summary\nReplace the current prompt (which asks for 3-8 individual student entries in 4 fixed categories) with one that identifies distinct bugs/patterns and groups students by issue. Also add completion classification.\n\n## Files to modify\n- src/server/services/gemini-analysis-service.ts\n\n## Implementation steps\n1. Replace buildPrompt() to ask the LLM to:\n   - Identify distinct issues/patterns across all submissions\n   - Group students by issue (student can appear in multiple)\n   - Order issues by frequency (most common first)\n   - For each issue: title (short), explanation (1 sentence), which student labels, severity (error/misconception/style/good-pattern)\n   - Classify each student as finished or in-progress\n   - Optional overallNote\n   - Max 10 issues\n2. Replace parseGeminiResponse() to parse the new JSON format:\n   ```json\n   {\n     \"issues\": [{ \"title\": \"...\", \"explanation\": \"...\", \"studentLabels\": [\"A\",\"C\"], \"severity\": \"error\" }],\n     \"finishedStudentLabels\": [\"B\", \"D\"],\n     \"overallNote\": \"...\"\n   }\n   ```\n3. Update analyzeSubmissions() to:\n   - Build AnalysisIssue[] from parsed response (resolve labels to studentIds, set count, pick representative)\n   - Compute completionEstimate from finishedStudentLabels + filteredOutCount\n   - Return updated WalkthroughScript with issues[] and completionEstimate\n\n## Dependencies\n- Depends on coding-tool-6es.1 (types must exist first)","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T18:33:09.245947469Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:49:42.886094929Z","closed_at":"2026-01-29T18:49:42.886094929Z","close_reason":"Implemented in 65100e9","labels":["wip"]}
{"id":"coding-tool-6es.3","title":"Update UI components for issue-based groups and completion summary","description":"## Summary\nUpdate all frontend components to display issue-based groups instead of fixed categories, and show a completion summary.\n\n## Files to modify\n- src/app/(app)/instructor/constants/analysis.ts — replace categoryStyles with severityStyles\n- src/app/(app)/instructor/hooks/useAnalysisGroups.ts — issue-based grouping\n- src/app/(app)/instructor/components/GroupNavigationHeader.tsx — show issue titles + counts\n- src/app/(app)/instructor/components/StudentAnalysisDetails.tsx — show issue explanation\n- src/app/(app)/instructor/components/SessionStudentPane.tsx — wire up new data, show completion summary\n\n## Implementation steps\n\n### constants/analysis.ts\n1. Remove categoryStyles (keyed by WalkthroughCategory)\n2. Add severityStyles keyed by IssueSeverity:\n   - error: red (#fef2f2 bg, #991b1b text, label \"Error\")\n   - misconception: amber (#fef9c3 bg, #854d0e text, label \"Misconception\")\n   - style: blue (#eff6ff bg, #1e40af text, label \"Style\")\n   - good-pattern: green (#f0fdf4 bg, #166534 text, label \"Good Pattern\")\n\n### useAnalysisGroups.ts\n1. Remove CATEGORY_ORDER, WalkthroughCategory import\n2. Import AnalysisIssue, IssueSeverity\n3. Build groups from script.issues instead of script.entries:\n   - Each AnalysisIssue becomes one AnalysisGroup (id = index, label = issue.title, studentIds = issue.studentIds, recommendedStudentId = issue.representativeStudentId)\n   - Keep \"All Submissions\" group at index 0\n   - Issues already ordered by frequency from backend\n4. Update AnalysisGroup interface: add issue?: AnalysisIssue to carry explanation/severity\n\n### GroupNavigationHeader.tsx\n1. Show issue title as group label (e.g., \"Missing base case (5 students)\")\n2. Replace commonPatterns display with overallNote when on \"All\" group\n3. Show completion summary line: \"X finished · Y in progress · Z not started\"\n\n### StudentAnalysisDetails.tsx\n1. Accept the active AnalysisIssue instead of WalkthroughEntry[]\n2. Show: severity badge, issue title, explanation text\n3. Much simpler component — just the issue info, no per-student bullets\n\n### SessionStudentPane.tsx\n1. Pass active issue to StudentAnalysisDetails instead of entry list\n2. Show completion summary near the analyze button when analysis is ready\n3. Remove old WalkthroughEntry references\n\n## Dependencies\n- Depends on coding-tool-6es.1 (types) and coding-tool-6es.2 (service returns new format)","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T18:33:25.48594717Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:55:36.960467759Z","closed_at":"2026-01-29T18:55:36.960467759Z","close_reason":"Implemented in b9d9352","labels":["wip"]}
{"id":"coding-tool-6hn","title":"Integrate Python linter with language-agnostic architecture for real-time syntax highlighting","description":"Add real-time Python syntax checking and linting to student code editors with inline error/warning highlights. Architecture should be language-agnostic to support additional languages in the future. This improves the learning experience by providing immediate feedback on code quality and syntax errors.\n\n**Files to modify:**\n- src/student/components/CodeEditor.tsx - Add language-agnostic linter integration and error highlighting\n- src/instructor/components/CodeViewer.tsx - Add read-only lint display for instructor view\n- src/server/linter.ts - Create language-agnostic linter service (new file)\n- src/server/linters/python-linter.ts - Python-specific linter implementation (new file)\n- src/server/types.ts - Add LintResult, LinterConfig types\n- src/server/websocket-handler.ts - Add lint request/response handlers\n- package.json - Add Python linter dependencies (pyodide or server-side tooling)\n- .pylintrc or pyproject.toml - Create permissive Python lint config (new file in project root)\n\n**Implementation steps:**\n1. Define language-agnostic linter interfaces in src/server/types.ts:\n   - LinterConfig { language: string, rules: object }\n   - LintMessage { line: number, column: number, severity: 'error'|'warning', message: string, rule?: string }\n   - LintResult { messages: LintMessage[], success: boolean }\n   \n2. Choose Python linting approach (recommend Pyodide with Pylint for client-side OR server-side with pylint/flake8):\n   - Client-side: Install pyodide, bundle Python linter\n   - Server-side: Install pylint/flake8, run via child_process\n   \n3. Create src/server/linters/python-linter.ts:\n   - Implement lint(code: string, config: LinterConfig): Promise\u003cLintResult\u003e\n   - Use permissive configuration (warnings-only mode)\n   \n4. Create src/server/linter.ts factory:\n   - getLinter(language: string) -\u003e returns appropriate linter instance\n   - Extensible for future languages (javascript, java, etc.)\n   \n5. Add WebSocket handlers in websocket-handler.ts:\n   - 'lint-request' message type\n   - 'lint-response' with LintResult payload\n   \n6. Integrate in CodeEditor.tsx:\n   - Send code to server via WebSocket for linting (debounced ~500ms)\n   - Parse LintResult into editor markers/decorations\n   - Red underlines for errors, yellow for warnings\n   - Hover tooltips with error messages\n   \n7. Add similar display in CodeViewer.tsx for instructor\n   \n8. Create permissive Python lint config (.pylintrc or pyproject.toml):\n   - Disable overly strict rules\n   - Set most violations to warning level\n   - Allow common patterns (unused variables, print statements)\n\n**Example interface (src/server/types.ts):**\nexport interface LintMessage {\n  line: number;\n  column: number;\n  endLine?: number;\n  endColumn?: number;\n  severity: 'error' | 'warning' | 'info';\n  message: string;\n  rule?: string;\n}\n\nexport interface LintResult {\n  messages: LintMessage[];\n  success: boolean;\n  language: string;\n}\n\nexport interface Linter {\n  lint(code: string, config?: object): Promise\u003cLintResult\u003e;\n}\n\n**Example permissive Python config (.pylintrc):**\n[MESSAGES CONTROL]\ndisable=missing-docstring,invalid-name,too-few-public-methods,line-too-long\n\n[BASIC]\ngood-names=i,j,k,x,y,z,df,ax,fig\n\n**Edge cases:**\n- Handle incomplete/partial Python code gracefully (students typing mid-statement)\n- Don't block code execution on lint errors (warnings only)\n- Performance: debounce linting to avoid lag on every keystroke\n- Server-side option: handle concurrent lint requests from multiple students\n- Language detection: auto-detect based on session/problem configuration\n- Future extensibility: easy to add JavaScript, Java, C++ linters","status":"open","priority":3,"issue_type":"feature","created_at":"2026-01-05T16:24:04.882047465Z","created_by":"node","updated_at":"2026-01-05T16:24:04.882047465Z"}
{"id":"coding-tool-6kr","title":"Create /sections/[id] route for session history","description":"**PARTIALLY COMPLETE** - src/app/(app)/sections/[sectionId]/page.tsx exists but is for STUDENTS.\n\nReview if instructor needs a separate section detail view, or if the existing student-facing page is sufficient.\n\nCurrent implementation shows:\n- Section details (name, class, semester)\n- Active sessions with 'Join Now' button\n- Past sessions with 'View' button\n\nIf instructor view needed, create src/app/(app)/instructor/sections/[id]/page.tsx with:\n- Session history table with more detail (student count, problem used)\n- 'Start Session' button\n- Link to class edit page\n\n**Testing:** Add/update tests if new route created","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:08.087245342Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.351557583Z","closed_at":"2026-01-23T00:05:22.993668713Z","close_reason":"Existing student-facing /sections/[id] page is sufficient. Instructors use InstructorDashboard for overview and direct session routes."}
{"id":"coding-tool-6la","title":"Add 'Copy public link' button to problem list for problems with solutions","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T17:17:00.800700305Z","created_by":"Joe Delfino","updated_at":"2026-01-30T17:19:48.922152758Z","closed_at":"2026-01-30T17:19:48.922152758Z","close_reason":"Completed"}
{"id":"coding-tool-6pzw","title":"Consolidate validation tests - move to service layer","description":"Multiple API route tests duplicate string normalization and validation tests that should be tested once in the service/validation layer.\n\nExamples of duplication:\n- join code uppercase/trim tests in multiple section-related routes\n- missing email/password/username tests duplicated per auth route\n\nChanges:\n1. Identify validation logic being tested in multiple route files\n2. Ensure service layer has comprehensive validation tests\n3. Remove redundant validation tests from route files (keep integration-level validation tests)\n\nEstimated reduction: ~200 lines\n\nVerification:\n1. npm test -- should pass\n2. Validation logic still tested (at service layer)\n3. Route tests still verify correct HTTP status codes","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T17:29:54.577438053Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.632583927Z","closed_at":"2026-01-20T18:09:44.918329839Z","close_reason":"Completed"}
{"id":"coding-tool-6v0","title":"Fix flaky E2E test: Student code sync race condition","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-25T18:27:24.275657553Z","created_by":"Joe Delfino","updated_at":"2026-01-25T20:22:54.011966135Z","closed_at":"2026-01-25T20:22:54.011966135Z","close_reason":"Fixed: Made Supabase broadcast synchronous to ensure reliable real-time message delivery. Added shared sendBroadcast utility, updated 5 broadcast functions, and fixed tests for async handling."}
{"id":"coding-tool-7dcs","title":"Remove dead code from navigation redesign","description":"Delete obsolete files after routing changes are complete.\n\nFiles to review for deletion:\n- src/app/(app)/instructor/components/InstructorNav.tsx - possibly obsolete if Sidebar handles all nav\n- src/app/(app)/instructor/components/CreateClassModal.tsx - check if /classes form is used instead\n- src/app/(app)/instructor/components/CreateSectionModal.tsx - check if /classes form is used instead\n- src/app/(app)/instructor/__tests__/breadcrumb-integration.test.tsx - if breadcrumb logic removed\n- src/app/(app)/instructor/__tests__/navigation-fixes.test.tsx - if ?view= routing removed\n\nBefore deleting, verify:\n1. No imports reference these files\n2. Functionality is covered elsewhere\n\nFind/replace URL patterns throughout codebase:\n- /instructor?view=X → proper route paths  \n- /instructor?sessionId=X → /instructor/session/[id]\n\n**Testing:** Run full test suite to ensure no broken imports","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:45.702727929Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.595083094Z","closed_at":"2026-01-23T00:23:58.416646632Z","close_reason":"Removed dead code: simplified isPathActive(), removed ?view= URL handling, updated navigation URLs"}
{"id":"coding-tool-7jn","title":"Rename 'Connected Students' label to reflect actual meaning after analysis","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:03.747110503Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:03.841007303Z","closed_at":"2026-01-30T03:00:03.841007303Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-7nq","title":"Consolidate UI Problem interface with server ProblemMetadata type","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:51:48.766296592Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:06:38.172497837Z","closed_at":"2026-01-30T16:06:38.172497837Z","close_reason":"Implemented","labels":["wip"]}
{"id":"coding-tool-7o4","title":"Add email-based MFA for system-admin accounts","description":"Add email-based MFA (6-digit OTP code) for system-admin account logins to prevent hijacking during/after bootstrap.\n\n**Security Model:**\n- System-admins require: password verification + email OTP verification\n- Other roles: password only (unchanged)\n- Bootstrap registration: hidden path at /auth/bootstrap, requires signin with MFA after\n\n**Flow:**\n1. System-admin enters email + password\n2. Server verifies password, signs out, sets mfa_pending cookie\n3. Client triggers OTP email via Supabase signInWithOtp\n4. User enters 6-digit code\n5. Client verifies via Supabase verifyOtp, then calls /api/auth/complete-mfa\n6. Session established\n\nSee plan file: /home/node/.claude/plans/zazzy-pondering-floyd.md","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-20T17:30:59.365842305Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.311073042Z","closed_at":"2026-01-20T20:40:16.466463879Z","close_reason":"Merged PR #12 - System-admin MFA implemented"}
{"id":"coding-tool-7puw","title":"Add instructor invitation UI for namespace admins","description":"## Summary\nNamespace admins need UI to invite instructors. The API already exists at `/api/namespace/invitations` but no UI uses it. The current `AddInstructorForm` is broken and being removed.\n\n## Context\n- API endpoint exists: `POST /api/namespace/invitations` (creates instructor invitation)\n- API endpoint exists: `GET /api/namespace/invitations` (lists invitations)\n- API endpoint exists: `DELETE /api/namespace/invitations/[id]` (revokes invitation)\n- API endpoint exists: `POST /api/namespace/invitations/[id]/resend` (resends invitation)\n- Reference implementation: `src/app/system/components/CreateInvitationForm.tsx` and `InvitationList.tsx`\n\n## Files to create/modify\n\n### New component: `src/app/admin/components/InviteInstructorForm.tsx`\nSimple form with:\n- Email input field\n- Submit button\n- Calls `POST /api/namespace/invitations` with `{ email }`\n- Shows success/error feedback\n\n### New component: `src/app/admin/components/InstructorInvitationList.tsx`\nTable showing pending/sent invitations:\n- Email, status, created date, expires date\n- Revoke button (calls DELETE endpoint)\n- Resend button for pending invitations\n\n### Modify: `src/app/admin/page.tsx`\n- Remove import of `AddInstructorForm`\n- Add new \"Invitations\" tab or section for namespace admins\n- Import and use new `InviteInstructorForm` and `InstructorInvitationList` components\n\n## Implementation notes\n- Can largely copy patterns from system admin invitation UI (`src/app/system/components/`)\n- Simpler than system admin version: no namespace dropdown (uses user's namespace), no role dropdown (always 'instructor')\n- API automatically scopes to user's namespace via `getNamespaceContext()`\n\n## Test plan\n1. Login as namespace-admin\n2. Navigate to admin page\n3. Enter instructor email, submit invitation\n4. Verify invitation appears in list\n5. Verify invitation email is sent (check Supabase logs or email provider)\n6. Test revoke and resend functionality","status":"closed","priority":1,"issue_type":"feature","created_at":"2026-01-20T22:17:02.638926928Z","created_by":"Joe Delfino","updated_at":"2026-01-20T22:53:31.447471093Z","closed_at":"2026-01-20T22:53:31.447471093Z","close_reason":"Completed - added InviteInstructorForm and InstructorInvitationList components with tests"}
{"id":"coding-tool-822","title":"Migrate RevisionViewer to use CodeEditor with line highlighting","description":"RevisionViewer currently uses plain \u003cpre\u003e tags for code display with custom line highlighting to show diffs between revisions. It should be migrated to use the unified CodeEditor component.\n\n**Current implementation:**\n- File: src/app/instructor/components/RevisionViewer.tsx (437 lines)\n- Uses plain \u003cpre\u003e tags with custom styling\n- Has custom line highlighting logic for showing changed lines between revisions\n- Calculates which lines changed compared to previous revision\n\n**Why this is separate/lower priority:**\n- Requires new CodeEditor feature: line highlighting/decorations API\n- More complex than other consolidations due to diff highlighting\n- RevisionViewer is working well with current implementation\n- Monaco editor decorations API needs to be properly integrated\n\n**Implementation approach:**\n\n1. **Enhance CodeEditor component:**\n   - Add support for line decorations/highlights\n   - Add prop: highlightedLines?: { lineNumber: number; className: string }[]\n   - Use Monaco's decorations API to highlight specific lines\n   - Support custom background colors for highlighted lines\n\n2. **Update RevisionViewer:**\n   - Replace \u003cpre\u003e with CodeEditor component\n   - Pass readOnly=true\n   - Calculate highlighted lines as before\n   - Pass highlighted lines to CodeEditor via new prop\n\n3. **Benefits:**\n   - Consistent Monaco editor experience\n   - Better syntax highlighting than plain \u003cpre\u003e\n   - Reuse unified execution results display (if needed)\n   - Single code display component across entire app\n\n**Files to modify:**\n- src/app/student/components/CodeEditor.tsx (add line highlighting)\n- src/app/instructor/components/RevisionViewer.tsx (migrate to CodeEditor)\n- Add tests for line highlighting feature\n\n**Blocked by:**\nNothing - can be implemented independently\n\n**References:**\n- Monaco editor decorations: https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IStandaloneCodeEditor.html#deltaDecorations\n- Related ticket: coding-tool-30z (CodeViewer consolidation)","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-27T15:23:25.505822605Z","updated_at":"2025-12-27T15:23:25.505822605Z"}
{"id":"coding-tool-87s","title":"Problem Organization: Course-Scoped + Tags","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:16:17.797046008Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:24:14.163214089Z","closed_at":"2026-01-30T16:24:14.163214089Z","close_reason":"Merged in PR #50"}
{"id":"coding-tool-87s.1","title":"Schema migration: make class_id NOT NULL and add tags column","description":"## Summary\nMake class_id required on problems and add tags support.\n\n## Files to modify\n- New migration file: `supabase/migrations/NNNN_problem_organization.sql`\n- `src/server/types/problem.ts` (lines ~10-20: Problem interface)\n\n## Implementation steps\n1. Create a new SQL migration:\n   - `ALTER TABLE problems ALTER COLUMN class_id SET NOT NULL` (existing NULL rows can be assigned manually in prod)\n   - `ALTER TABLE problems ADD COLUMN tags TEXT[] NOT NULL DEFAULT '{}'`\n   - `CREATE INDEX idx_problems_tags ON problems USING GIN (tags)` for efficient tag queries\n2. Update RLS policies if needed (class_id is already indexed)\n\n## Notes\n- Existing problems with NULL class_id will need manual assignment before migration runs. There is very little prod data.","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:16:26.979777971Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:18:15.777807341Z","closed_at":"2026-01-30T15:18:15.777807341Z","close_reason":"Duplicate of coding-tool-87s.2"}
{"id":"coding-tool-87s.2","title":"Schema migration: make class_id NOT NULL and add tags column","description":"## Summary\nMake class_id required on problems and add tags support at the database level.\n\n## Files to modify\n- New migration file: `supabase/migrations/NNNN_problem_organization.sql`\n\n## Implementation steps\n1. Create a new SQL migration:\n   - `ALTER TABLE problems ALTER COLUMN class_id SET NOT NULL` (existing NULL rows can be assigned manually in prod before running)\n   - `ALTER TABLE problems ADD COLUMN tags TEXT[] NOT NULL DEFAULT '{}'`\n   - `CREATE INDEX idx_problems_tags ON problems USING GIN (tags)` for efficient tag queries\n2. Update RLS policies if needed (class_id is already indexed)\n\n## Notes\n- Existing problems with NULL class_id will need manual assignment before migration runs. There is very little prod data.","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:16:30.696748208Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:33:59.45354443Z","closed_at":"2026-01-30T15:33:59.45354443Z","close_reason":"Implemented","labels":["wip"]}
{"id":"coding-tool-87s.3","title":"Update Problem types, repository, and API for required classId and tags","description":"## Summary\nUpdate the Problem type to make classId required, add tags field, and update repository/API to support both.\n\n## Files to modify\n- `src/server/types/problem.ts` — Make `classId` required (remove `?`), add `tags: string[]` to Problem and ProblemMetadata (classId already exists on both, only tags needs adding)\n- `src/server/persistence/interfaces.ts` — Add `tags?: string[]` to `ProblemFilter` (classId filter already exists; getByClass already exists)\n- `src/server/persistence/supabase/problem-repository.ts` — Handle tags in CRUD, add tag filtering to getAll/search\n- `src/server/persistence/problem-schema.ts` — Add tags validation (max 10 tags, max 30 chars each, alphanumeric+hyphens)\n- `src/app/api/problems/route.ts` — Require classId in POST, accept tags query param in GET\n- `src/app/api/problems/[id]/route.ts` — Support tags and classId in PATCH (problems must be able to change class)\n\n## Implementation steps\n1. Update `Problem` interface: `classId: string` (not optional), add `tags: string[]` with default `[]`\n2. Update `ProblemInput` to require classId\n3. Add `tags` to `ProblemFilter` (classId filtering already works)\n4. Add `tags` to `ProblemMetadata` (classId already present)\n5. Update repository implementation to read/write tags, filter by tags (use `@\u003e` contains operator for array matching)\n6. Update problem-schema validation to include tag constraints\n7. Update API routes: POST requires classId, GET accepts `tags` query param, PATCH allows changing classId and tags\n8. Update all existing tests to include classId (now required) — this will touch test files across server and client projects\n\n## Notes\n- `ProblemFilter.classId` and `getByClass()` already exist — no new class-filtering logic needed\n- The main new work is tags support and making classId non-optional","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:16:39.022454379Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:39:31.888863667Z","closed_at":"2026-01-30T15:39:31.888863667Z","close_reason":"Implemented","labels":["wip"]}
{"id":"coding-tool-87s.4","title":"Problem Library UI: class-scoped view with tags","description":"## Summary\nUpdate the Problem Library UI to be class-scoped by default with tag filtering and display. Problems must be viewable per-class with a dropdown to switch classes or show all.\n\n## Files to modify\n- `src/app/(app)/instructor/components/ProblemLibrary.tsx` — Add class picker dropdown, tag filter, pass classId to API\n- `src/app/(app)/instructor/components/ProblemSearch.tsx` — Add tag filter controls\n- `src/app/(app)/instructor/components/ProblemCard.tsx` — Display tag chips on cards\n- `src/app/(app)/instructor/components/ProblemCreator.tsx` — Add required class selector and tag input to creation form\n- `src/app/(app)/instructor/components/ProblemInput.tsx` — Add class selector field (required) and tags input field\n\n## Implementation steps\n1. **ProblemLibrary**: Add a class picker dropdown at the top. Default to instructor's first/current class. Include \"All classes\" option to remove class filter. Pass selected classId to API calls.\n2. **ProblemSearch**: Add a tag filter section — show existing tags as clickable chips, clicking toggles filter. Allow multi-select.\n3. **ProblemCard**: Show tags as small chips/badges below the title. Clicking a tag activates the tag filter.\n4. **ProblemCreator/ProblemInput**: Class selector is required (pre-populated from current library context). Tags input: free-form text field with comma-separated entry, shown as removable chips.\n5. **ProblemInput (edit mode)**: Allow changing classId (dropdown) and editing tags. This enables moving problems between classes.\n6. Fetch available classes from existing class API to populate dropdowns.\n\n## Notes\n- The class picker should remember the last selected class (localStorage or URL param)\n- \"All classes\" is a convenience toggle, not a separate view — same component, just no class filter applied","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:17:01.072199209Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:48:52.600800552Z","closed_at":"2026-01-30T15:48:52.600800552Z","close_reason":"Implemented","labels":["wip"]}
{"id":"coding-tool-8fn","title":"Deep-link instructor problem view via URL params","description":"When viewing a problem under /instructor/problems, the URL doesn't update to include the problem ID. Add URL search params (e.g. /instructor/problems?view=problem-123) so instructors can share direct links to specific problems. Files: src/app/(app)/instructor/problems/page.tsx, src/app/(app)/instructor/components/ProblemLibrary.tsx — update state management to sync selected problem with URL search params using useSearchParams().","status":"open","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T17:22:58.245964637Z","created_by":"Joe Delfino","updated_at":"2026-01-30T17:22:58.245964637Z"}
{"id":"coding-tool-8i0","title":"Add missing API route tests for sections endpoints","description":"Current state: Only 3 API test files exist for 9+ API routes in sections.\n\nMissing tests for:\n- /api/sections/[id]/route.ts (GET, PUT, DELETE)\n- /api/sections/[id]/instructors/route.ts\n- /api/sections/[id]/instructors/[userId]/route.ts\n- /api/sections/[id]/leave/route.ts\n- /api/sections/[id]/regenerate-code/route.ts\n- /api/sections/my/route.ts\n\nCoverage Gap: 26.74% statement coverage overall - many API routes untested.\n\nRequired Tests:\n1. All HTTP methods (GET, POST, PUT, DELETE) for each route\n2. Authentication checks (401 responses)\n3. Authorization checks (403 responses)\n4. Not found cases (404 responses)\n5. Validation errors (400 responses)\n6. Success paths (200, 201 responses)\n\nPriority Order:\n1. DELETE /api/sections/[id] - deletion authorization\n2. PUT /api/sections/[id] - update validation\n3. GET /api/sections/my - user's sections list\n4. Instructor management routes\n\nFiles to create:\n- src/app/api/sections/[id]/__tests__/route.test.ts\n- src/app/api/sections/[id]/instructors/__tests__/route.test.ts\n- src/app/api/sections/my/__tests__/route.test.ts\n\nAcceptance Criteria:\n- Each endpoint has 6+ tests covering error and success cases\n- Authorization logic tested (instructorIds, memberships, roles)\n- Statement coverage increases to \u003e50% for API routes","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-20T01:00:05.971991765Z","updated_at":"2025-12-20T01:00:18.526377481Z"}
{"id":"coding-tool-8mc","title":"Route Group Refactoring","description":"Reorganize src/app/ into route groups with shared layouts.\n\n## New Structure\n\n```\nsrc/app/\n├── layout.tsx             # Root layout (AuthProvider only, NO session/panel providers)\n├── (public)/              # Unauthenticated pages\n│   ├── layout.tsx         # Minimal layout (no header/sidebar)\n│   ├── page.tsx           # Landing page (moved from root)\n│   ├── auth/\n│   │   ├── signin/\n│   │   └── bootstrap/\n│   ├── register/\n│   │   └── student/\n│   ├── invite/\n│   │   └── accept/\n│   ├── terms/\n│   └── privacy/\n├── (app)/                 # Standard authenticated pages\n│   ├── layout.tsx         # AppShell with sidebar + providers\n│   ├── sections/\n│   │   ├── page.tsx\n│   │   ├── [sectionId]/\n│   │   └── join/\n│   ├── instructor/\n│   │   ├── page.tsx\n│   │   ├── problems/\n│   │   └── public/\n│   ├── classes/\n│   │   ├── page.tsx\n│   │   └── [id]/\n│   ├── admin/\n│   ├── namespace/\n│   │   └── invitations/\n│   └── system/\n└── (fullscreen)/          # Full-width pages (code editors)\n    ├── layout.tsx         # AppShell with sidebar auto-collapsed\n    └── student/\n```\n\n## Provider Placement (IMPORTANT)\n\n**Root layout.tsx:** AuthProvider ONLY\n```tsx\n// src/app/layout.tsx\n\u003cAuthProvider\u003e{children}\u003c/AuthProvider\u003e\n```\n\n**App layout.tsx:** Session and panel providers\n```tsx\n// src/app/(app)/layout.tsx\n\u003cActiveSessionProvider\u003e\n  \u003cPanelProvider\u003e\n    \u003cAppShell\u003e{children}\u003c/AppShell\u003e\n  \u003c/PanelProvider\u003e\n\u003c/ActiveSessionProvider\u003e\n```\n\n**Public layout.tsx:** No providers, minimal wrapper\n```tsx\n// src/app/(public)/layout.tsx\n\u003cdiv className=\"min-h-screen\"\u003e{children}\u003c/div\u003e\n```\n\n**Fullscreen layout.tsx:** Same providers, different AppShell config\n```tsx\n// src/app/(fullscreen)/layout.tsx\n\u003cActiveSessionProvider\u003e\n  \u003cPanelProvider\u003e\n    \u003cAppShell sidebarCollapsed={true} showRightPanels={false}\u003e\n      {children}\n    \u003c/AppShell\u003e\n  \u003c/PanelProvider\u003e\n\u003c/ActiveSessionProvider\u003e\n```\n\n## Routes to Move\n\n| Current Location | New Location |\n|------------------|--------------|\n| src/app/page.tsx | src/app/(public)/page.tsx |\n| src/app/auth/* | src/app/(public)/auth/* |\n| src/app/register/* | src/app/(public)/register/* |\n| src/app/invite/* | src/app/(public)/invite/* |\n| src/app/terms/* | src/app/(public)/terms/* |\n| src/app/privacy/* | src/app/(public)/privacy/* |\n| src/app/sections/* | src/app/(app)/sections/* |\n| src/app/instructor/* | src/app/(app)/instructor/* |\n| src/app/classes/* | src/app/(app)/classes/* |\n| src/app/admin/* | src/app/(app)/admin/* |\n| src/app/namespace/* | src/app/(app)/namespace/* |\n| src/app/system/* | src/app/(app)/system/* |\n| src/app/student/* | src/app/(fullscreen)/student/* |\n\n## URL Stability\nRoute groups (parentheses) are organizational only - URLs remain unchanged:\n- `/instructor` still works (not `/(app)/instructor`)\n- `/student` still works (not `/(fullscreen)/student`)\n\n## Testing\n- Verify all existing routes still work after move\n- Check that providers are available in correct layouts\n- Test that public pages don't have unnecessary providers","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:25:04.184202507Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.357047375Z","closed_at":"2026-01-22T03:27:56.918330339Z","close_reason":"Completed"}
{"id":"coding-tool-8u0","title":"E2E test gap: Critical path should test student code sync and public view","description":"## Problem\n\nThe current E2E tests don't cover the critical path of student code sync:\n1. Student modifies code in their editor\n2. Code is saved/synced to the server\n3. Instructor can view the student's code in real-time\n4. Code can be displayed on the public view\n\n## Test Scenario to Add\n\n1. Student logs in and navigates to their editor\n2. Student modifies code (types in the editor)\n3. Verify code is synced/saved\n4. Instructor views the student's code (should see the changes)\n5. Public view displays the student's code correctly\n\n## Files to Investigate\n\n- e2e/critical-paths.spec.ts - May be the right place to add this\n- e2e/public-view.spec.ts - Public view testing\n- e2e/helpers/ - Test utilities and setup","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:45:52.831880421Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.314750958Z","closed_at":"2026-01-23T21:59:28.498058841Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-8v9","title":"Move 'Clear Public View' button next to 'Open Public View'","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:03.889577628Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:03.89870872Z","closed_at":"2026-01-30T03:00:03.89870872Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-94lx","title":"Remove duplicate instructor_ids array from sections table","description":"## Summary\n\nThe `sections` table has an `instructor_ids UUID[]` array that duplicates functionality already provided by the `section_memberships` table with `role='instructor'`. This creates two sources of truth that can get out of sync and adds unnecessary complexity to the codebase.\n\n## Current State (Duplication)\n\n### Two sources of truth:\n\n1. **Array on sections table** (`supabase/migrations/00001_initial_schema.sql:91`):\n   ```sql\n   instructor_ids UUID[] NOT NULL DEFAULT '{}'\n   ```\n\n2. **Memberships table** (`supabase/migrations/00001_initial_schema.sql:106-116`):\n   ```sql\n   CREATE TABLE section_memberships (\n     user_id UUID NOT NULL REFERENCES user_profiles(id),\n     section_id UUID NOT NULL REFERENCES sections(id),\n     role TEXT NOT NULL CHECK (role IN ('instructor', 'student')),\n     ...\n   );\n   ```\n\n### RLS has to check BOTH (`00001_initial_schema.sql:323-336`):\n```sql\nCREATE OR REPLACE FUNCTION is_section_instructor(section_id_param UUID)\nRETURNS BOOLEAN AS $$\n  SELECT EXISTS (\n    SELECT 1 FROM sections\n    WHERE id = section_id_param AND auth.uid() = ANY(instructor_ids)\n  ) OR EXISTS (\n    SELECT 1 FROM section_memberships\n    WHERE section_id = section_id_param\n    AND user_id = auth.uid()\n    AND role = 'instructor'\n  )\n$$ LANGUAGE sql SECURITY DEFINER STABLE;\n```\n\nThe \"OR\" is a code smell - indicates no single source of truth.\n\n## Files to Modify\n\n### Database Migration (new migration file):\n- Remove `instructor_ids` column from `sections` table\n- Update `is_section_instructor()` function to only check memberships\n- Migrate any existing data: ensure all instructor_ids entries have corresponding membership rows\n\n### TypeScript Types:\n- `src/server/classes/types.ts:65` - Remove `instructorIds: string[]` from `Section` interface\n\n### Repository Interfaces:\n- `src/server/classes/interfaces.ts:200-213` - Remove `addInstructor()` and `removeInstructor()` methods from `ISectionRepository`\n\n### Repository Implementation:\n- `src/server/persistence/supabase/SectionRepository.ts` - Remove `addInstructor()` and `removeInstructor()` implementations\n- Update any queries that reference `instructor_ids`\n\n### API Routes:\n- `src/app/api/sections/[id]/instructors/route.ts` - Refactor to use memberships instead of updating instructor_ids array\n- `src/app/api/sections/[id]/instructors/[userId]/route.ts` - Same refactor\n- `src/app/api/sections/[id]/sessions/route.ts` - Use membership check instead of instructorIds\n- `src/app/api/sections/[id]/route.ts` - Update authorization checks\n- `src/app/api/sections/[id]/leave/route.ts` - Remove instructor_ids update logic\n\n### Hooks:\n- `src/hooks/useClasses.ts` - Keep `addCoInstructor`/`removeCoInstructor` but they now just manage memberships\n\n### UI Components:\n- `src/app/(app)/sections/components/SectionCard.tsx` - Remove `instructorIds` prop usage\n- `src/app/(app)/classes/components/SectionCard.tsx` - Update instructor display to use memberships query\n\n### Tests (update mocks and assertions):\n- `src/app/api/sections/join/__tests__/route.test.ts`\n- `src/app/api/sections/my/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/instructors/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/instructors/[userId]/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/sessions/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/leave/__tests__/route.test.ts`\n- `src/app/api/sections/[id]/regenerate-code/__tests__/route.test.ts`\n\n## Implementation Steps\n\n1. Create data migration to ensure all `instructor_ids` entries have corresponding `section_memberships` rows with `role='instructor'`\n2. Update `is_section_instructor()` RLS function to only check memberships\n3. Remove `instructor_ids` column from sections table\n4. Update TypeScript `Section` interface\n5. Remove `addInstructor`/`removeInstructor` from repository interface and implementation\n6. Refactor API routes to use membership operations\n7. Update UI components to query memberships for instructor list\n8. Update all tests\n\n## Benefits\n\n- Single source of truth for instructor membership\n- Simpler RLS policies (no OR condition)\n- Fewer repository methods to maintain\n- Consistent with how students are already tracked (memberships only)\n- Eliminates potential sync bugs between array and memberships table","status":"open","priority":3,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T05:24:12.868422836Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:24:36.451063792Z","labels":["approved"]}
{"id":"coding-tool-95v","title":"Student code not syncing or persisting","description":"## Problem\n\nStudent code is not being saved or synced correctly. Two symptoms observed:\n\n1. **Instructor can't see student code** - Viewing student code from the instructor dashboard shows nothing, even though the student has entered code\n\n2. **Student loses code on refresh** - Refreshing the page as a student loses all entered code\n\n## Previous Fix (incomplete)\n\nChanged session repository to use UPSERT instead of DELETE+INSERT for student updates. Also restored saved code from join API.\n\n## Current Error (prod)\n\nAfter prod deploy, still seeing RLS policy error when saving code:\n\n```\n[API] Save code error: Error [PersistenceError]: Failed to update session students: \nnew row violates row-level security policy for table \"session_students\"\n    at r.updateSession (.next/server/chunks/src_server_persistence_supabase_index_ts_d9db7d20._.js:1:4699)\n```\n\n**Note:** Migration was pushed after the prod deploy, which may have caused the mismatch.\n\n## Root Cause\n\nThe `session_students` table likely needs an RLS policy that allows students to UPDATE their own rows (specifically the code column). The UPSERT fix requires UPDATE permission, not just INSERT.\n\n## Files to Investigate\n\n- `supabase/migrations/` - Check RLS policies for session_students table\n- Look for UPDATE policy allowing students to modify their own session_students record\n- Verify RLS policies cover both INSERT and UPDATE operations for students","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:29:29.21686605Z","created_by":"Joe Delfino","updated_at":"2026-01-23T22:06:47.180282294Z","closed_at":"2026-01-23T22:06:47.180282294Z","close_reason":"Fixed by adding userId to Student type and including user_id in session_students insert/upsert. Migration added to make user_id NOT NULL.","labels":["wip"]}
{"id":"coding-tool-962","title":"Public view page does not show session ended state","description":"## Problem\n\nThe instructor public view page (`/instructor/public`) does not indicate when a session has ended. Students see a notification, but the public display continues showing the last featured code without any indication the session is over.\n\n## Root Cause\n\n1. The `/api/sessions/[id]/public-state` endpoint does not return `session.status`\n2. The public view page does not check for or display session ended state\n\n## Files to Modify\n\n- `src/app/api/sessions/[id]/public-state/route.ts` - Add `status` to response\n- `src/app/instructor/public/page.tsx` - Handle `status === 'completed'` and show appropriate UI\n\n## Implementation\n\n1. Update public-state API to include status:\n```typescript\nreturn NextResponse.json({\n  sessionId: session.id,\n  joinCode: section?.joinCode || '',\n  problem: session.problem,\n  featuredStudentId: session.featuredStudentId || null,\n  featuredCode: session.featuredCode || null,\n  hasFeaturedSubmission: Boolean(session.featuredStudentId \u0026\u0026 session.featuredCode),\n  status: session.status,  // Add this\n});\n```\n\n2. Update public view page to show \"Session Ended\" banner when status is 'completed'\n\n## Priority\n\nP3 - Low priority. The public view is typically only shown during active sessions and instructors know when they've ended the session. Nice-to-have for completeness.","status":"open","priority":3,"issue_type":"bug","created_at":"2026-01-09T20:12:42.085056387Z","created_by":"node","updated_at":"2026-01-09T20:12:42.085056387Z"}
{"id":"coding-tool-9ayo","title":"Fix public view unconditional polling - use useRealtime hook","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-20T04:06:38.330779713Z","created_by":"Joe Delfino","updated_at":"2026-01-20T04:22:26.424331638Z","closed_at":"2026-01-20T04:22:26.424331638Z","close_reason":"Fixed: Public view now uses useRealtime hook and only polls when disconnected"}
{"id":"coding-tool-9cx","title":"Add call stack display to debugger","description":"Display the call stack at each step of execution in a simple, readable format. Shows function call hierarchy and allows understanding of execution flow.\n\nFiles to modify:\n- src/student/components/CallStackPanel.tsx - Call stack display component (new file)\n- src/student/components/DebuggerPanel.tsx - Integrate call stack panel\n- src/hooks/useDebugger.ts - Expose current call stack\n\nImplementation steps:\n1. Create src/student/components/CallStackPanel.tsx:\n   - Display call stack from most recent (top) to oldest (bottom)\n   - Show function name and line number for each frame\n   - Highlight current function being executed\n   - Simple list format (avoid complexity)\n   - Click on frame to jump to that code location (optional enhancement)\n   \n2. Integrate in DebuggerPanel.tsx:\n   - Add CallStackPanel below VariableInspector\n   - Pass current step's call stack\n   - Update on step navigation\n   \n3. Update useDebugger.ts:\n   - Expose getCurrentCallStack()\n   - Format call stack data for display\n\nUI Layout (simple version):\n┌─────────────────────────────────────┐\n│ Call Stack                          │\n├─────────────────────────────────────┤\n│ → factorial (line 3)                │ ← Current\n│   factorial (line 4)                │\n│   main (line 7)                     │\n│   \u003cmodule\u003e (line 10)                │\n└─────────────────────────────────────┘\n\nAlternative simple format:\n┌─────────────────────────────────────┐\n│ Call Stack                          │\n├─────────────────────────────────────┤\n│ factorial:3 → factorial:4 → main:7  │\n└─────────────────────────────────────┘\n\nDisplay format options:\n- Current function highlighted or with arrow\n- Function name:line number format for brevity\n- Module/top-level shown as \u003cmodule\u003e\n- Depth indicator (optional): indentation or numbering\n\nEdge cases:\n- Single frame (just main/module) - still show\n- Deep recursion (truncate or make scrollable)\n- Very long function names (truncate)\n- Empty call stack (shouldn't happen, but handle gracefully)\n- Frame selection (if clickable, handle navigation)\n\nSimplicity focus:\n- Keep display minimal and easy to understand\n- Avoid overwhelming students with details\n- Clear visual indicator of current position\n- No complex tree views or interactive features initially\n\nDepends on: coding-tool-p14 (variable inspector should be done first for cohesive UI)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:06:29.4330165Z","updated_at":"2025-12-18T19:06:29.4330165Z"}
{"id":"coding-tool-9h9","title":"Modify signin API for MFA trigger","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:34:36.872986919Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.339512917Z","closed_at":"2026-01-20T18:42:29.751856095Z","close_reason":"signin API MFA trigger added"}
{"id":"coding-tool-9i4","title":"Improve student first-time sign-on flow UX","description":"## Problem\n\nMultiple UX issues with the student sign-on flow:\n\n### Issue 1: No feedback after registration\nCurrent flow:\n1. Student enters a join code\n2. Fills out a 'profile' page with email and password\n3. Gets immediately redirected to a sign-in page with no feedback\n\nStudents don't know if registration succeeded or failed.\n\n### Issue 2: Redundant join code step\nWhen entering a join code on the homepage (`/`) and clicking \"Join Section\":\n1. User is taken to `/register/student`\n2. Shows a similar form with the join code already filled in and a \"Continue\" button\n3. This is redundant - the join code was already entered\n\n**Key insight:** Students will likely use the join code input on the homepage as a quick way to navigate back into the app, not just for first-time registration. The current flow forces them back into registration unnecessarily.\n\n## Proposed Solutions\n\n### For Issue 1 (choose one):\n**Option A (preferred):** Auto-login after registration\n- After successful signup, automatically authenticate and redirect to classroom\n\n**Option B:** Show clear success feedback\n- Display \"Registration successful! Please sign in with your email and password.\"\n\n### For Issue 2:\nThe `/register/student` page should offer a clear, balanced choice:\n- **Already have an account?** → Sign in button (prominent)\n- **New student?** → Continue to registration\n\nAlternatively, if the system can detect the user already has an account (e.g., email exists), redirect them to login automatically.\n\n## Files to Investigate\n\n- src/app/join/ - Join code entry flow\n- src/app/register/student/ - Student registration page\n- src/app/signup/ or src/app/auth/ - Registration flow\n- Supabase auth configuration","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:13:13.431401459Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.360759583Z","closed_at":"2026-01-23T22:30:08.458565137Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-9l1","title":"Start Session redirects to public view and notifies other tabs","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:56:34.76010175Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:30:28.445644384Z","closed_at":"2026-01-30T22:30:28.445644384Z","close_reason":"Merged in PR #53"}
{"id":"coding-tool-9l1.1","title":"Redirect to public view and post BroadcastChannel message on session creation","description":"## Summary\nWhen an instructor creates a session from the public problem page, redirect the current tab to the public view for the new session (instead of the instructor dashboard), and post a BroadcastChannel message so other tabs can show a notification.\n\n## Files to modify\n- `src/app/(public)/problems/[id]/InstructorActions.tsx`\n\n## Implementation steps\n1. In the `onSuccess` callback (line 38-41), before calling `router.push`:\n   - Create a `BroadcastChannel('instructor-session-created')`\n   - Post `{ sessionId, problemTitle, joinCode }` to it\n   - Close the channel\n2. Change the `router.push` target from `/instructor/session/${sessionId}` to `/public-view?sessionId=${sessionId}`\n\n## Before\n```tsx\nonSuccess={(sessionId) =\u003e {\n  setShowModal(false);\n  router.push(`/instructor/session/${sessionId}`);\n}}\n```\n\n## After\n```tsx\nonSuccess={(sessionId) =\u003e {\n  setShowModal(false);\n  const channel = new BroadcastChannel('instructor-session-created');\n  channel.postMessage({ sessionId, problemTitle });\n  channel.close();\n  router.push(`/public-view?sessionId=${sessionId}`);\n}}\n```","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:56:43.409427338Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:30:28.568662176Z","closed_at":"2026-01-30T22:30:28.568662176Z","close_reason":"Merged in PR #53","labels":["in-pr"]}
{"id":"coding-tool-9l1.2","title":"Add global SessionCreatedNotification component","description":"## Summary\nCreate a new client component that listens for BroadcastChannel messages when a session is created, and shows a persistent dismissable banner with a link to the session dashboard.\n\n## Files to create\n- `src/components/SessionCreatedNotification.tsx`\n\n## Implementation steps\n1. Create a 'use client' component `SessionCreatedNotification`\n2. In a useEffect, open `BroadcastChannel('instructor-session-created')` and listen for messages\n3. On message, set state with `{ sessionId, problemTitle }` from the payload\n4. Render a persistent, dismissable banner (not auto-dismiss):\n   - Text: \"New session started for {problemTitle}\"\n   - Link/button: \"Go to Session Dashboard\" pointing to `/instructor/session/{sessionId}`\n   - X button to dismiss\n5. Style consistently with existing banners in the app (e.g., the yellow session-ended banner in `src/app/(app)/instructor/session/[id]/page.tsx`)\n6. Clean up BroadcastChannel on unmount\n\n## Testing\n- Unit test: verify banner renders when BroadcastChannel message is received\n- Unit test: verify dismiss button hides the banner","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:56:51.878376592Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:30:28.693674551Z","closed_at":"2026-01-30T22:30:28.693674551Z","close_reason":"Merged in PR #53","labels":["in-pr"]}
{"id":"coding-tool-9l1.3","title":"Mount SessionCreatedNotification in app layout","description":"## Summary\nAdd the SessionCreatedNotification component to the authenticated app layout so it renders on all pages where an instructor might have a browser window open.\n\n## Files to modify\n- `src/app/(app)/layout.tsx`\n\n## Implementation steps\n1. Import `SessionCreatedNotification` from `@/components/SessionCreatedNotification`\n2. Add `\u003cSessionCreatedNotification /\u003e` inside the layout, after existing global components\n3. This ensures the notification listener is active on all authenticated pages\n\n## Example\n```tsx\n// In the layout's return:\n\u003cSessionCreatedNotification /\u003e\n```","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T18:56:58.008451261Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:30:28.783752842Z","closed_at":"2026-01-30T22:30:28.783752842Z","close_reason":"Merged in PR #53","labels":["in-pr"]}
{"id":"coding-tool-aa0","title":"Add API route tests for GET /api/sections/:id/sessions","description":"Bug: API endpoint had authorization bug - only checked memberships, not section.instructorIds. Also had wrong import path.\n\nTest Gap: No tests exist for src/app/api/sections/[id]/sessions/route.ts\n\nRequired Tests:\n1. GET returns 401 if not authenticated\n2. GET returns 404 if section not found\n3. GET returns 403 if user not section instructor and not member\n4. GET returns 200 with sessions if user is section instructor (even without membership)\n5. GET returns 200 with sessions if user is section member\n6. Test getSessionManager import works correctly\n7. Test sessions filtered by sectionId\n\nFiles to create:\n- src/app/api/sections/[id]/sessions/__tests__/route.test.ts\n\nMock Requirements:\n- Mock getAuthProvider, getSectionRepository, getMembershipRepository, getSessionManager\n- Test both instructorIds array and membership table authorization paths\n\nAcceptance Criteria:\n- Test fails if instructorIds check is removed\n- Test fails if wrong import path used (would cause module evaluation error)\n- Test covers both authorization paths (instructor vs member)\n- All error cases (401, 403, 404, 500) tested","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T00:59:33.330077926Z","updated_at":"2026-01-23T05:48:28.529492677Z","closed_at":"2026-01-23T05:48:28.529492677Z","close_reason":"Completed - tests exist at src/app/api/sections/[id]/sessions/__tests__/route.test.ts"}
{"id":"coding-tool-ahs","title":"Instructor dashboard: code output displays in redundant component instead of editor's output area","description":"Bug: In instructor dashboard session view, code execution output is not displayed in the editor component's output area. Instead, output appears in a separate/redundant UI component below the editor.\n\n**Current behavior:**\n- Mobile: Output tab in editor is empty; output shows in redundant component below\n- Desktop: Editor output area is empty; output shows in redundant component below\n\n**Expected behavior:**\n- Output should display in the editor component's built-in output area\n- Remove the redundant output component below the editor\n\n**Files to investigate:**\n- Instructor session view pages\n- Editor component and its output area/tab\n- Output data flow and props","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-20T03:48:23.613437763Z","created_by":"Joe Delfino","updated_at":"2026-01-20T03:50:53.546368846Z","closed_at":"2026-01-20T03:50:53.546368846Z","close_reason":"Fixed: Pass executionResult prop to CodeEditor and removed redundant OutputPanel component"}
{"id":"coding-tool-ao1","title":"Align implementer skill with task-completer phase-gated workflow","status":"closed","priority":3,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:57:54.606748053Z","created_by":"Joe Delfino","updated_at":"2026-01-30T15:22:23.515931386Z","closed_at":"2026-01-30T15:22:23.515931386Z","close_reason":"Resolved: unified /work and /task, rewrote implementer as pure dev workflow"}
{"id":"coding-tool-b3j","title":"Student code not syncing or persisting","description":"## Problem\n\nStudent code is not being saved or synced correctly. Two symptoms observed:\n\n1. **Instructor can't see student code** - Viewing student code from the instructor dashboard shows nothing, even though the student has entered code\n\n2. **Student loses code on refresh** - Refreshing the page as a student loses all entered code\n\n## Previous Fix (incomplete)\n\nChanged session repository to use UPSERT instead of DELETE+INSERT for student updates. Also restored saved code from join API.\n\n## Current Error (prod)\n\nAfter prod deploy, still seeing RLS policy error when saving code:\n\n```\n[API] Save code error: Error [PersistenceError]: Failed to update session students: \nnew row violates row-level security policy for table \"session_students\"\n    at r.updateSession (.next/server/chunks/src_server_persistence_supabase_index_ts_d9db7d20._.js:1:4699)\n```\n\n**Note:** Migration was pushed after the prod deploy, which may have caused the mismatch.\n\n## Root Cause\n\nThe `session_students` table likely needs an RLS policy that allows students to UPDATE their own rows (specifically the code column). The UPSERT fix requires UPDATE permission, not just INSERT.\n\n## Files to Investigate\n\n- `supabase/migrations/` - Check RLS policies for session_students table\n- Look for UPDATE policy allowing students to modify their own session_students record\n- Verify RLS policies cover both INSERT and UPDATE operations for students","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:29:29.21686605Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.364414458Z","closed_at":"2026-01-23T22:06:47.180282294Z","close_reason":"Fixed by adding userId to Student type and including user_id in session_students insert/upsert. Migration added to make user_id NOT NULL.","labels":["wip"]}
{"id":"coding-tool-b5w","title":"Implement password reset (forgot password) flow","description":"## Summary\nAllow users to reset their password via email link when they forget it.\n\n## Supabase Methods\n- `supabase.auth.resetPasswordForEmail(email, { redirectTo })` - sends reset email\n- `supabase.auth.updateUser({ password })` - updates password after token verification\n\n## Implementation\n\n### 1. API Route: Request Reset\n```typescript\n// src/app/api/auth/forgot-password/route.ts\nimport { createClient } from '@/lib/supabase/server';\n\nexport async function POST(request: Request) {\n  const { email } = await request.json();\n  \n  if (!email) {\n    return NextResponse.json({ error: 'Email is required' }, { status: 400 });\n  }\n\n  const supabase = await createClient();\n  const { error } = await supabase.auth.resetPasswordForEmail(email, {\n    redirectTo: `${process.env.NEXT_PUBLIC_APP_URL}/auth/reset-password`,\n  });\n\n  // Always return success to prevent email enumeration\n  return NextResponse.json({ \n    message: 'If an account exists with this email, a reset link has been sent.' \n  });\n}\n```\n\n### 2. API Route: Update Password\n```typescript\n// src/app/api/auth/reset-password/route.ts\nimport { createClient } from '@/lib/supabase/server';\n\nexport async function POST(request: Request) {\n  const { password } = await request.json();\n  \n  if (!password || password.length \u003c 8) {\n    return NextResponse.json({ error: 'Password must be at least 8 characters' }, { status: 400 });\n  }\n\n  const supabase = await createClient();\n  const { error } = await supabase.auth.updateUser({ password });\n\n  if (error) {\n    return NextResponse.json({ error: error.message }, { status: 400 });\n  }\n\n  return NextResponse.json({ message: 'Password updated successfully' });\n}\n```\n\n### 3. UI Pages\n\n**Forgot Password Page** (`src/app/auth/forgot-password/page.tsx`):\n- Email input form\n- Submit calls `/api/auth/forgot-password`\n- Show success message regardless of whether email exists\n\n**Reset Password Page** (`src/app/auth/reset-password/page.tsx`):\n- New password + confirm password inputs\n- Receives token via URL fragment (Supabase handles this)\n- Submit calls `/api/auth/reset-password`\n- Redirect to sign-in on success\n\n### 4. Add Link to Sign-In Page\nAdd \"Forgot password?\" link to `src/app/auth/signin/page.tsx`\n\n### 5. Supabase Configuration (Manual)\n1. Dashboard → Auth → URL Configuration\n2. Add to Redirect URLs: `https://your-domain.com/auth/reset-password`\n3. For local dev: `http://localhost:3000/auth/reset-password`\n\n## Files to create\n- `src/app/api/auth/forgot-password/route.ts`\n- `src/app/api/auth/reset-password/route.ts`\n- `src/app/auth/forgot-password/page.tsx`\n- `src/app/auth/reset-password/page.tsx`\n\n## Files to modify\n- `src/app/auth/signin/page.tsx` - add \"Forgot password?\" link\n\n## Verification\n1. Go to sign-in page, click \"Forgot password?\"\n2. Enter email, submit\n3. Check email for reset link (or Supabase logs in dev)\n4. Click link, should redirect to reset password page\n5. Enter new password, submit\n6. Should be able to sign in with new password\n\n## Notes\n- Reset links expire after 24 hours (Supabase default)\n- Rate limited by Supabase (2/hour on free tier for emails)\n- For production, configure custom SMTP in Supabase","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-15T03:39:46.27481976Z","created_by":"node","updated_at":"2026-01-15T03:39:46.27481976Z"}
{"id":"coding-tool-b6m","title":"Move detailed AI feedback card above student list, not repeated per student","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:03.616319461Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:03.768299845Z","closed_at":"2026-01-30T03:00:03.768299845Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-buw","title":"User-friendly error messages with retry logic","description":"## Summary\nTechnical errors leak to users (e.g., 'Foreign key violation'). No retry mechanisms for transient failures.\n\n## Problems\n\n### Generic error messages\n- `src/app/instructor/components/ClassList.tsx` (line 40): Shows raw error.message\n- Many API calls catch and display backend errors directly\n- Users see technical messages they can't act on\n\n### No retry mechanisms\n- Network failures require manual page refresh\n- No automatic retry for transient errors\n- No 'Try Again' buttons on failed operations\n\n### Inconsistent error styling\n- Some use Tailwind (red-50, red-200)\n- Some use inline styles (#fee, #e00)\n- `src/app/student/page.tsx` line 374 uses inline styles\n\n## Implementation\n\n### 1. Create error message mapper\n```typescript\n// src/lib/error-messages.ts\nexport function getUserFriendlyError(error: Error): string {\n  const message = error.message.toLowerCase();\n  if (message.includes('network') || message.includes('fetch')) {\n    return 'Connection error. Please check your internet and try again.';\n  }\n  if (message.includes('timeout')) {\n    return 'Request timed out. Please try again.';\n  }\n  // ... more mappings\n  return 'Something went wrong. Please try again.';\n}\n```\n\n### 2. Add retry wrapper\n```typescript\n// src/lib/api-utils.ts\nexport async function withRetry\u003cT\u003e(\n  fn: () =\u003e Promise\u003cT\u003e,\n  maxRetries = 3\n): Promise\u003cT\u003e\n```\n\n### 3. Standardize error styling\nCreate reusable ErrorAlert component with consistent styling.\n\n## Files to Modify\n- Create `src/lib/error-messages.ts`\n- Create `src/lib/api-utils.ts`\n- Create `src/components/ErrorAlert.tsx`\n- Update error handling in all API-calling components","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-15T03:58:04.198805713Z","created_by":"node","updated_at":"2026-01-20T17:01:10.869650213Z","closed_at":"2026-01-20T17:01:10.869650213Z","close_reason":"Implemented: error-messages.ts with error classification, ErrorAlert.tsx component, and api-utils.ts with retry logic"}
{"id":"coding-tool-byu","title":"Move session replacement orchestration from API route to service layer","description":"The POST /api/sessions route handler directly orchestrates replacement side effects (persisting replacedBySessionId, broadcasting session_replaced, cleaning up executor) instead of delegating to the service layer. This violates the codebase pattern of thin routes with business logic in services.\n\nFiles to modify:\n- src/server/services/session-service.ts — add a replaceActiveSession() function that combines endActiveSessionIfExists + updateSession(replacedBySessionId) + returns info needed for broadcast/cleanup\n- src/app/api/sessions/route.ts — simplify POST handler to call the new service function, then broadcast and cleanup\n\nConsider also refactoring the existing DELETE handler in src/app/api/sessions/[id]/route.ts to move its broadcast+cleanup into the service layer for consistency.\n\nDiscovered from the architecture review of coding-tool-2jv.","status":"open","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T22:18:58.402545217Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:18:58.402545217Z"}
{"id":"coding-tool-c2w","title":"Add CI/CD integration and documentation","description":"Integrate E2E tests into CI/CD pipeline and document usage for team.\n\n**Files to create/modify:**\n- .github/workflows/e2e-tests.yml - GitHub Actions workflow\n- README.md - Update with E2E testing section\n- e2e/README.md - Detailed E2E testing guide\n\n**CI/CD Setup:**\n1. Create GitHub Actions workflow\n   - Trigger on push and pull_request\n   - Install dependencies\n   - Install Chromium browser\n   - Run E2E tests\n   - Upload test results on failure\n   - Upload screenshots/videos on failure\n\n2. Workflow optimizations\n   - Cache npm dependencies\n   - Cache Playwright browsers\n   - Run in parallel with Jest tests\n   - Set appropriate timeouts\n\n**Documentation:**\n\nREADME.md section:\n- Overview of E2E testing\n- How to run tests locally\n- npm scripts reference\n- When to run E2E vs unit tests\n- Writing new E2E tests\n\ne2e/README.md guide:\n- Architecture overview\n- Test data management\n- Helper functions reference\n- Best practices\n- Debugging failed tests\n- Common patterns\n- Troubleshooting\n\n**npm Scripts Verification:**\n- npm test - Runs Jest only\n- npm run test:e2e - Runs Playwright only\n- npm run test:all - Runs both (for CI)\n\n**Success Metrics to document:**\n- Current test count: 25\n- Execution time: ~60 seconds\n- Coverage: Critical instructor workflows\n- Bugs prevented: Modal rendering, UI updates, navigation, WebSocket\n\n**Acceptance Criteria:**\n- CI workflow running successfully\n- Tests pass on CI\n- Documentation complete and clear\n- Team can run and write E2E tests\n- README updated with E2E section","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:56:47.233139249Z","updated_at":"2025-12-27T18:57:51.237289813Z"}
{"id":"coding-tool-c3i","title":"Write E2E tests for modal interactions","description":"Write focused E2E tests for modal interactions across all modals in the application. Catches modal rendering and closing bugs.\n\n**File to create:**\n- e2e/modal-interactions.spec.ts\n\n**Tests to implement (~4 tests):**\n\n1. Create class modal lifecycle\n   - Click \"New Class\"\n   - Verify modal opens and is visible\n   - Verify modal content renders\n   - Click cancel button\n   - Verify modal closes\n   - Repeat: open, fill form, submit\n   - Verify modal closes on submit\n   - Verify backdrop click closes modal\n\n2. Create section modal lifecycle\n   - Navigate to sections view\n   - Click \"New Section\"\n   - Verify modal opens\n   - Verify form fields present\n   - Test ESC key closes modal\n   - Test submit closes modal\n   - Test cancel closes modal\n\n3. Delete confirmation modal\n   - Create test item (class or section)\n   - Click delete\n   - Verify confirmation modal appears\n   - Verify warning text present\n   - Click \"Cancel\"\n   - Verify modal closes, item not deleted\n   - Click delete again\n   - Click \"Delete\" button\n   - Verify modal closes, item deleted\n\n4. Form validation in modals\n   - Open create class modal\n   - Submit empty form\n   - Verify validation errors shown IN MODAL\n   - Verify modal stays open\n   - Fill required fields\n   - Submit\n   - Verify modal closes\n\n**Key Checks:**\n- Modal visibility: getByRole('dialog').toBeVisible()\n- Modal content: headings, buttons present\n- Modal closing: not.toBeVisible() after action\n- z-index layering (modals appear above content)\n- Focus management (focus trapped in modal)\n\n**Acceptance Criteria:**\n- All 4 tests passing\n- Tests catch modal rendering bugs\n- Tests validate all close mechanisms\n- Tests verify modal doesn't close on error\n- Execution time under 20 seconds","status":"open","priority":4,"issue_type":"task","created_at":"2025-12-27T18:56:45.297281677Z","updated_at":"2025-12-28T01:07:06.533550387Z"}
{"id":"coding-tool-ca9","title":"Tag students with submission status (finished/not finished/not started)","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:04.025673336Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:03.944920012Z","closed_at":"2026-01-30T03:00:03.944920012Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-cdf","title":"Integrate Python linter with language-agnostic architecture for real-time syntax highlighting","description":"Add real-time Python syntax checking and linting to student code editors with inline error/warning highlights. Architecture should be language-agnostic to support additional languages in the future. This improves the learning experience by providing immediate feedback on code quality and syntax errors.\n\n**Files to modify:**\n- src/student/components/CodeEditor.tsx - Add language-agnostic linter integration and error highlighting\n- src/instructor/components/CodeViewer.tsx - Add read-only lint display for instructor view\n- src/server/linter.ts - Create language-agnostic linter service (new file)\n- src/server/linters/python-linter.ts - Python-specific linter implementation (new file)\n- src/server/types.ts - Add LintResult, LinterConfig types\n- src/server/websocket-handler.ts - Add lint request/response handlers\n- package.json - Add Python linter dependencies (pyodide or server-side tooling)\n- .pylintrc or pyproject.toml - Create permissive Python lint config (new file in project root)\n\n**Implementation steps:**\n1. Define language-agnostic linter interfaces in src/server/types.ts:\n   - LinterConfig { language: string, rules: object }\n   - LintMessage { line: number, column: number, severity: 'error'|'warning', message: string, rule?: string }\n   - LintResult { messages: LintMessage[], success: boolean }\n   \n2. Choose Python linting approach (recommend Pyodide with Pylint for client-side OR server-side with pylint/flake8):\n   - Client-side: Install pyodide, bundle Python linter\n   - Server-side: Install pylint/flake8, run via child_process\n   \n3. Create src/server/linters/python-linter.ts:\n   - Implement lint(code: string, config: LinterConfig): Promise\u003cLintResult\u003e\n   - Use permissive configuration (warnings-only mode)\n   \n4. Create src/server/linter.ts factory:\n   - getLinter(language: string) -\u003e returns appropriate linter instance\n   - Extensible for future languages (javascript, java, etc.)\n   \n5. Add WebSocket handlers in websocket-handler.ts:\n   - 'lint-request' message type\n   - 'lint-response' with LintResult payload\n   \n6. Integrate in CodeEditor.tsx:\n   - Send code to server via WebSocket for linting (debounced ~500ms)\n   - Parse LintResult into editor markers/decorations\n   - Red underlines for errors, yellow for warnings\n   - Hover tooltips with error messages\n   \n7. Add similar display in CodeViewer.tsx for instructor\n   \n8. Create permissive Python lint config (.pylintrc or pyproject.toml):\n   - Disable overly strict rules\n   - Set most violations to warning level\n   - Allow common patterns (unused variables, print statements)\n\n**Example interface (src/server/types.ts):**\nexport interface LintMessage {\n  line: number;\n  column: number;\n  endLine?: number;\n  endColumn?: number;\n  severity: 'error' | 'warning' | 'info';\n  message: string;\n  rule?: string;\n}\n\nexport interface LintResult {\n  messages: LintMessage[];\n  success: boolean;\n  language: string;\n}\n\nexport interface Linter {\n  lint(code: string, config?: object): Promise\u003cLintResult\u003e;\n}\n\n**Example permissive Python config (.pylintrc):**\n[MESSAGES CONTROL]\ndisable=missing-docstring,invalid-name,too-few-public-methods,line-too-long\n\n[BASIC]\ngood-names=i,j,k,x,y,z,df,ax,fig\n\n**Edge cases:**\n- Handle incomplete/partial Python code gracefully (students typing mid-statement)\n- Don't block code execution on lint errors (warnings only)\n- Performance: debounce linting to avoid lag on every keystroke\n- Server-side option: handle concurrent lint requests from multiple students\n- Language detection: auto-detect based on session/problem configuration\n- Future extensibility: easy to add JavaScript, Java, C++ linters","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-18T18:49:32.002760136Z","updated_at":"2025-12-21T00:36:49.592363378Z"}
{"id":"coding-tool-ci9","title":"Migrate repositories to use RLS instead of service_role","description":"## Summary\nRepositories currently use `getSupabaseClient()` which returns a service_role client that bypasses RLS. This is a security anti-pattern - we should rely on RLS for defense-in-depth.\n\n## Current State\n- `src/server/supabase/client.ts` `getSupabaseClient()` uses SUPABASE_SECRET_KEY (service_role)\n- All repositories use this client, bypassing RLS policies\n- `getSupabaseClientWithAuth()` exists but is never used\n\n## Proposed Changes\n1. API routes should pass authenticated user context to repositories\n2. Repositories should use `getSupabaseClientWithAuth(accessToken)` for queries\n3. RLS policies enforce row-level access control\n4. Service_role only for truly privileged operations (user creation, admin tasks)\n\n## Files to Modify\n- `src/server/persistence/supabase/*.ts` - All repository implementations\n- API routes that use repositories - pass auth context\n- May need additional SELECT grants for authenticated role\n\n## Benefits\n- Defense-in-depth: even if API has bugs, database enforces access\n- Single source of truth for access control (RLS policies)\n- More secure by default","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T21:47:18.810685047Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.328790583Z","closed_at":"2026-01-21T05:26:53.811975503Z","close_reason":"Completed. Repositories use accessToken for RLS-backed access. SERVICE_ROLE_MARKER limited to 3 join endpoints (sections/join, sessions/[id]/join, auth/accept-invite) where RLS creates catch-22. Migration 00005 adds grants for authenticated role."}
{"id":"coding-tool-ciu","title":"Code analysis: improve error bucketing granularity and summary presentation","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T17:52:14.941581626Z","created_by":"Joe Delfino","updated_at":"2026-01-29T18:33:29.605137131Z","closed_at":"2026-01-29T18:33:29.605137131Z","close_reason":"Replaced by epic coding-tool-6es"}
{"id":"coding-tool-cvd","title":"Extract shared ClassInfo interface to reduce duplication","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T15:51:48.241968842Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:03:50.277589342Z","closed_at":"2026-01-30T16:03:50.277589342Z","close_reason":"Implemented","labels":["wip"]}
{"id":"coding-tool-d4j","title":"Remove Leave Session button from instructor session view","status":"closed","priority":3,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:14:16.469366926Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:16:20.162747136Z","closed_at":"2026-01-29T22:16:20.162747136Z","close_reason":"Completed - removed Leave Session button, prop chain, and updated tests"}
{"id":"coding-tool-dhg","title":"Remove capacity field from sections","description":"Remove the unused 'capacity' field from sections throughout the codebase.\n\n## Rationale\nThe capacity field on sections is not used anywhere in the application logic. It adds unnecessary complexity to the data model without providing value.\n\n## Files to modify\n- Database schema/migrations (remove column from sections table)\n- src/server/persistence/interfaces.ts (Section type)\n- src/server/persistence/supabase/*.ts (any references)\n- API routes that handle sections\n- Frontend components that display/edit sections\n- Tests referencing capacity\n\n## Implementation\n1. Search for all references to 'capacity' in the codebase\n2. Remove from database schema (new migration)\n3. Remove from TypeScript types\n4. Remove from API request/response handling\n5. Remove from UI forms and displays\n6. Update tests","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-09T21:24:04.766098467Z","created_by":"node","updated_at":"2026-01-09T21:24:04.766098467Z"}
{"id":"coding-tool-di0","title":"Automated Test Case System","description":"Implement comprehensive automated testing system supporting multiple test types. Enables instructors to create test cases and students to validate their solutions. Supports input/output tests, pytest unit tests, and property-based tests with clear feedback and debugging integration.\n\n**Test Types Supported:**\n1. Input/Output Tests\n   - Provide stdin input\n   - Compare stdout against golden/expected output\n   - Support for exact match or pattern matching\n   - Useful for basic console programs\n\n2. PyTest Unit Tests\n   - Standard Python unit tests using pytest\n   - Test specific functions or classes\n   - Rich assertion messages\n   - Integration with pytest ecosystem\n\n3. Property-Based Tests\n   - Using hypothesis or similar framework\n   - Generate test cases automatically\n   - Test properties rather than specific cases\n   - Advanced validation\n\n**Core Features:**\n- Instructors create and manage test cases per problem\n- Students can view all test cases (visible by default)\n- Run individual tests or full test suite\n- Clear test output and error messages\n- Pass/fail indicators with details\n- Integration with execution trace debugger\n- Test execution in isolated environment\n\n**User Workflows:**\n\nInstructor:\n- Create test cases when defining problems\n- Specify test type and parameters\n- Edit/delete existing tests\n- Preview test execution\n- See aggregate student test results\n\nStudent:\n- View all test cases for current problem\n- Run individual test to verify specific functionality\n- Run all tests to validate complete solution\n- See detailed pass/fail results\n- Debug failing tests with trace debugger\n- Clear feedback on what went wrong\n\n**Architecture:**\n- Test definitions stored with problem specifications\n- Server-side test execution (security)\n- Isolated execution environment per test\n- Result caching for performance\n- Structured test output format\n\n**Data Model:**\n- TestCase: { id, type, name, description, config }\n- InputOutputTest: { input: string, expectedOutput: string, matchType: 'exact' | 'pattern' }\n- PyTestConfig: { testCode: string, functionName?: string }\n- PropertyTestConfig: { propertyCode: string, hypothesis: object }\n- TestResult: { testId, passed, output, error?, duration }\n\n**Integration Points:**\n- Problem specification (tests attached to problems)\n- Code execution (run tests against student code)\n- Debugger (debug failing tests)\n- Reporting (test pass rates in analytics)\n\n**Success Criteria:**\n- All three test types functional\n- Students can run and view all tests\n- Clear test output and feedback\n- Debugger integration works\n- Test execution is secure and isolated\n- Performance acceptable for multiple tests","status":"closed","priority":1,"issue_type":"epic","created_at":"2026-01-05T16:24:40.567092801Z","created_by":"node","updated_at":"2026-01-23T14:59:20.893536386Z","closed_at":"2026-01-23T14:59:20.893536386Z","close_reason":"Duplicate of coding-tool-erm which has the subtasks (erm.2, erm.3, erm.4)"}
{"id":"coding-tool-diq","title":"End-to-End Testing with Playwright","description":"Implement comprehensive E2E testing infrastructure using Playwright to catch UI bugs in critical user workflows. Prevents regressions by testing complete user journeys through real browser interactions.\n\n**Goals:**\n- Catch modal rendering bugs (4 recent bugs would have been caught)\n- Verify API integration and UI updates\n- Test WebSocket connections\n- Validate navigation flows\n- Enable confident refactoring\n\n**Scope:**\n- Playwright setup (Chromium browser only initially)\n- Test data management (clear before each test)\n- 5 test suites covering instructor workflows\n- ~25 smoke tests total\n- CI/CD integration\n\n**Technical Details:**\n- Framework: Playwright (Microsoft-backed, excellent TypeScript support)\n- Browser: Chromium only (can add Firefox/WebKit later)\n- Test isolation: Clear data before each test\n- Execution: Parallel by default (~30-60 sec locally)\n- Separate from Jest: npm run test:e2e vs npm test\n\n**Test Suites:**\n1. Class management (create, edit, delete)\n2. Section management (create, edit, delete, join codes)\n3. Session creation (WebSocket integration)\n4. Modal interactions (open, submit, close)\n5. Navigation flows (classes → sections → session)\n\n**Success Criteria:**\n- All smoke tests passing\n- Tests run in CI/CD pipeline\n- Zero interference with existing Jest tests\n- Clear documentation for writing new tests\n- Test execution time under 60 seconds locally\n\n**ROI Analysis:**\n- Time to write 1 test: 10-20 minutes\n- Time to debug 1 UI bug: 30-60 minutes\n- Recent bugs that would be caught: 4/4\n- Result: Very positive ROI","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-27T18:54:43.693446176Z","updated_at":"2025-12-27T18:55:02.609005764Z"}
{"id":"coding-tool-dkp","title":"Consolidate UI component CSS class tests","description":"Reduce UI component tests that extensively test Tailwind CSS class names. These break when design changes and do not verify actual visual behavior.\n\nFiles to modify:\n- src/components/ui/__tests__/Button.test.tsx (40 tests, 11K) - reduce to ~10 tests\n- src/components/ui/__tests__/Card.test.tsx (24 tests, 10K) - reduce to ~5 tests\n- src/components/ui/__tests__/Badge.test.tsx (15 tests, 2.6K) - reduce to ~5 tests\n- src/components/ui/__tests__/Breadcrumb.test.tsx (31 tests) - reduce to ~10 tests\n\nKeep tests for:\n- Component renders without crashing\n- Accessibility (ARIA attributes, roles)\n- User interactions work\n\nRemove tests for:\n- Specific Tailwind class names (bg-gradient-to-r, from-indigo-600, etc.)\n- CSS class combinations\n- Variant styling class assertions\n\nEstimated reduction: ~800-1,000 lines\n\nVerification:\n1. npm test -- should pass\n2. Component behavior still tested (rendering, a11y, interactions)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T17:29:49.018533759Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.330526917Z","closed_at":"2026-01-20T18:03:44.941946339Z","close_reason":"Completed"}
{"id":"coding-tool-dmn","title":"Add in-app help and link to documentation","description":"## Summary\nUSER_GUIDE.md exists but isn't linked from the app. Complex features have no tooltips or explanations.\n\n## Problems\n- No help icons or contextual tooltips\n- USER_GUIDE.md not accessible from UI\n- Features like 'AI Walkthrough', 'execution settings', 'feature student' are unexplained\n- Users don't know what happens if they close tab mid-session\n\n## Implementation\n\n### 1. Link documentation from app\n- Add help icon in header that links to USER_GUIDE\n- Or embed key sections in a help modal\n\n### 2. Add contextual help tooltips\nFeatures needing explanation:\n- 'AI Walkthrough' button - what does this do?\n- 'Execution settings' - what are randomSeed, attachedFiles?\n- 'Feature student' - what happens when you feature someone?\n- Connection status indicators\n\n### 3. Help for common questions\n- What if I close my browser mid-session?\n- How long does code execution take?\n- Can I see my code after the session ends?\n\n## Files to Modify\n- `src/app/layout.tsx` or header component - Add help link\n- `src/app/instructor/page.tsx` - Add tooltips to features\n- `src/app/student/page.tsx` - Add tooltips\n- Consider creating `src/components/HelpTooltip.tsx`","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-15T03:59:06.626503047Z","created_by":"node","updated_at":"2026-01-15T03:59:06.626503047Z"}
{"id":"coding-tool-dwi","title":"Unit Testing Infrastructure","description":"Comprehensive unit test coverage for core server components to ensure reliability, catch regressions, and enable confident refactoring.\n\n**Goals:**\n- 80%+ code coverage on business logic\n- Fast, isolated unit tests (no real I/O)\n- Reusable test utilities and mocks\n- Clear test organization and naming\n\n**Test Infrastructure:**\n- ✅ Jest + ts-jest configured\n- ✅ FakeStorageBackend utility\n- ✅ UUID mocking for deterministic tests\n- ✅ RevisionBuffer tests (29 tests)\n\n**High-Priority Components:**\n1. SessionManager (484 LOC) - Core session lifecycle\n2. RBACService (118 LOC) - Authorization/permissions\n3. LocalAuthProvider (234 LOC) - Authentication\n4. CodeExecutor (110 LOC) - Code execution\n5. LocalStorage (712 LOC) - Persistence layer\n\n**Benefits:**\n- Catch bugs before production\n- Enable safe refactoring\n- Document expected behavior\n- Improve code quality\n- Reduce debugging time","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-19T14:57:54.420508424Z","updated_at":"2025-12-19T14:58:03.911151591Z"}
{"id":"coding-tool-dwi.3","title":"Add unit tests for LocalAuthProvider","description":"Add comprehensive unit tests for LocalAuthProvider class (234 LOC) - authentication flow with auto-account creation and session management.\n\nFiles to modify:\n- Create: src/server/__tests__/auth/local-provider.test.ts (350-400 lines)\n- Create: src/server/__tests__/test-utils/fake-user-repository.ts\n- May need mock file system (memfs)\n\nTest Categories:\n\n1. Authentication Flow (10 tests)\n   - First user becomes instructor\n   - Subsequent users are students\n   - Username validation and normalization\n   - Duplicate username handling\n   - Empty/null username rejection\n   - Username trimming\n   - Auto-create on first login\n   - Update lastLoginAt on existing user\n   - Return user object on success\n   - Throw AuthenticationError on invalid input\n\n2. User Creation (8 tests)\n   - Create instructor (first user)\n   - Create student (subsequent users)\n   - Generate unique user IDs\n   - Set created/lastLogin timestamps\n   - Duplicate username throws error\n   - Trim whitespace from username\n   - Save to repository\n   - Return created user object\n\n3. Session Management (10 tests)\n   - Create session with user\n   - Generate unique session ID\n   - Session persisted to disk\n   - Get active session by ID\n   - Session not found returns null\n   - Multiple sessions per user\n   - Session reload from disk\n   - Cross-process session sharing\n   - Session creation timestamp\n   - Session user reference\n\n4. Session Persistence (7 tests)\n   - Save sessions to JSON file\n   - Load sessions from JSON file\n   - Atomic file writes (temp then rename)\n   - Date revival from JSON\n   - Handle missing file (new install)\n   - Handle corrupted JSON\n   - File permissions\n\n5. User Operations (8 tests)\n   - Get user by ID\n   - Get user by username\n   - Update user fields\n   - Delete user\n   - Delete removes active sessions\n   - User not found returns null\n   - Update non-existent user throws\n   - Delete non-existent user throws\n\n6. Error Handling (7 tests)\n   - File I/O errors during save\n   - File I/O errors during load\n   - JSON parse errors\n   - Repository errors bubble up\n   - Invalid session file recovery\n   - Concurrent file access\n   - Disk full scenarios\n\nExpected Test Count: 30-35 tests\n\nTesting Strategy:\n- Mock file system (use memfs package)\n- Mock user repository\n- Test file persistence behavior\n- Verify session state in memory\n- Test error recovery\n\nSuccess Criteria:\n- All public methods tested\n- File I/O edge cases covered\n- Session persistence validated\n- 90%+ code coverage\n- Tests run in 2 seconds","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T14:59:03.942925963Z","updated_at":"2026-01-23T15:01:03.341613044Z","closed_at":"2026-01-23T15:01:03.341613044Z","close_reason":"Obsolete - LocalAuthProvider no longer exists. Project uses Supabase auth which has tests in auth/__tests__/"}
{"id":"coding-tool-dwi.4","title":"Add unit tests for CodeExecutor","description":"Add comprehensive unit tests for code-executor.ts (110 LOC) - critical code execution with timeout handling and security.\n\nFiles to modify:\n- Create: src/server/__tests__/code-executor.test.ts (250-300 lines)\n\nTest Categories:\n\n1. Successful Execution (5 tests)\n   - Execute simple print statement\n   - Capture stdout output\n   - Exit code 0 for success\n   - Execution time tracking\n   - Empty stderr on success\n\n2. Error Handling (7 tests)\n   - Syntax errors in code\n   - Runtime errors (exceptions)\n   - Capture stderr output\n   - Non-zero exit codes\n   - Error message formatting\n   - Multiple error types\n   - Stack traces\n\n3. Timeout Management (8 tests)\n   - Code times out after limit\n   - SIGTERM sent first\n   - SIGKILL after 1s if not terminated\n   - Timeout error message\n   - Default timeout (10s)\n   - Custom timeout values\n   - Very short timeout (100ms)\n   - Cleanup after timeout\n\n4. Process Management (5 tests)\n   - Process spawned correctly\n   - Process cleanup on completion\n   - Process cleanup on error\n   - Multiple concurrent executions\n   - Resource cleanup\n\n5. Error Sanitization (8 tests)\n   - Remove file paths from errors\n   - Replace with generic file name\n   - Remove errno codes\n   - Preserve line numbers\n   - Preserve error types\n   - Multiple path replacements\n   - Nested error messages\n   - Special characters in paths\n\n6. Edge Cases (7 tests)\n   - Empty code execution\n   - Very long output (buffering)\n   - Binary output handling\n   - Unicode in output\n   - Code with infinite loop (timeout)\n   - Process spawn failure\n   - Python not available\n\nExpected Test Count: 20-25 tests\n\nTesting Strategy:\n- Mock child_process.spawn using jest.mock\n- Simulate process events (stdout, stderr, close, error)\n- Use fake timers for timeout tests\n- Test with real Python for integration validation\n- Mock process for unit tests\n\nMock Strategy:\njest.mock('child_process', () =\u003e ({\n  spawn: jest.fn()\n}));\n\nSuccess Criteria:\n- All execution paths tested\n- Timeout scenarios validated\n- Error sanitization verified\n- 85%+ code coverage\n- Tests run in 1 second","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T14:59:20.346910428Z","updated_at":"2026-01-23T15:01:09.044131005Z","closed_at":"2026-01-23T15:01:09.044131005Z","close_reason":"Obsolete - code-executor.ts refactored to src/server/code-execution/ with backends. Tests exist: executor-service.test.ts, local-python-backend.test.ts, vercel-sandbox-backend.test.ts"}
{"id":"coding-tool-dwi.5","title":"Add unit tests for LocalStorage repositories","description":"Add comprehensive unit tests for local-storage.ts (712 LOC) - file-based persistence layer with atomic operations.\n\nFiles to modify:\n- Create: src/server/__tests__/persistence/local-storage.test.ts (400-500 lines)\n\nTest Categories:\n\n1. Session Repository (10 tests)\n   - Create session with metadata\n   - Get session by ID\n   - Update session fields\n   - Delete session\n   - List all sessions\n   - Count sessions\n   - Session not found returns null\n   - Map serialization/deserialization\n   - Date revival from JSON\n   - Query sessions with filters\n\n2. User Repository (8 tests)\n   - Save user\n   - Get user by ID\n   - Get user by username\n   - Update user\n   - Delete user\n   - List all users\n   - Username lookup performance\n   - User not found cases\n\n3. Problem Repository (8 tests)\n   - Save problem\n   - Get problem by ID\n   - Update problem\n   - Delete problem\n   - List problems\n   - Filter by tags\n   - Filter by difficulty\n   - Sort problems\n\n4. Revision Repository (10 tests)\n   - Save code revision\n   - Get revisions for session/student\n   - Get single revision by ID\n   - Delete revisions\n   - Diff vs snapshot handling\n   - Revision ordering\n   - Large revision sets\n   - Revision metadata\n\n5. Atomic File Operations (8 tests)\n   - Write to temp then rename\n   - Cleanup temp file on error\n   - Concurrent writes (last write wins)\n   - File permissions\n   - Directory creation\n   - Atomic guarantee\n   - Rollback on failure\n   - No partial writes\n\n6. JSON Serialization (7 tests)\n   - Date object revival\n   - Map object revival\n   - Nested objects\n   - Special characters\n   - Large payloads\n   - Circular references (should error)\n   - Custom types\n\n7. Error Handling (9 tests)\n   - File not found (returns default)\n   - JSON parse errors\n   - Directory creation failure\n   - File write permissions\n   - Disk full scenarios\n   - Corrupted files\n   - Invalid IDs\n   - PersistenceError types\n   - Error codes\n\n8. Initialization (5 tests)\n   - Create storage directories\n   - Load existing data\n   - Handle empty directory\n   - Migration scenarios\n   - Multiple storage instances\n\nExpected Test Count: 30-40 tests\n\nTesting Strategy:\n- Use memfs for in-memory file system\n- Test atomic write guarantees\n- Verify JSON revival logic\n- Test concurrent operations\n- Validate error recovery\n\nMock File System:\nimport { vol } from 'memfs';\njest.mock('fs/promises');\n\nSuccess Criteria:\n- All repository methods tested\n- Atomic operations validated\n- Error paths covered\n- 85%+ code coverage\n- Tests run in 2 seconds","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-19T14:59:37.658825643Z","updated_at":"2025-12-19T14:59:37.658825643Z"}
{"id":"coding-tool-dwi.6","title":"Create reusable test utilities for unit tests","description":"Create shared test utilities and mocks to support unit testing across the codebase.\n\nFiles to create:\n- src/server/__tests__/test-utils/fake-user-repository.ts\n- src/server/__tests__/test-utils/fake-session-repository.ts\n- src/server/__tests__/test-utils/test-helpers.ts\n- src/server/__tests__/test-utils/mock-process.ts\n\n1. FakeUserRepository\n   - In-memory user storage\n   - Implements IUserRepository interface\n   - Spy arrays for tracking calls\n   - Reset method for test isolation\n   - Deterministic behavior\n   - ~100 lines\n\n2. FakeSessionRepository\n   - In-memory session storage\n   - Implements session repository interface\n   - Spy arrays for method tracking\n   - Helper methods for test setup\n   - ~80 lines\n\n3. Test Helpers\n   - createMockUser(overrides): Generate test users\n   - createMockSession(overrides): Generate test sessions\n   - createMockRevision(overrides): Generate test revisions\n   - waitFor(condition, timeout): Async helper\n   - expectToThrow(fn, errorType): Error assertion\n   - mockTimestamp(): Freeze time\n   - ~150 lines\n\n4. Mock Process (for CodeExecutor tests)\n   - Mock child_process.spawn\n   - Simulate process events\n   - Control stdout/stderr\n   - Trigger timeouts\n   - Simulate errors\n   - ~100 lines\n\nBenefits:\n- Reduce test boilerplate\n- Consistent mock behavior\n- Easy test data creation\n- Reusable across test suites\n- Type-safe mocks\n\nSuccess Criteria:\n- All utilities tested\n- Type-safe interfaces\n- Clear documentation\n- Used by other test tickets","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-19T14:59:50.985690062Z","updated_at":"2026-01-23T15:01:16.993191009Z","closed_at":"2026-01-23T15:01:16.993191009Z","close_reason":"Obsolete - test utilities already exist: fake-classes.ts (483 lines), fake-storage.ts (406 lines) in src/server/__tests__/test-utils/"}
{"id":"coding-tool-e1c","title":"Add missing empty states with helpful messages","description":"## Summary\nSeveral views show no content without explaining why or what to do next.\n\n## Missing Empty States\n\n### SessionsList\n- No indication if loading or just no sessions\n- Needs: 'No active sessions. Join a section to see available sessions.'\n\n### StudentList during active session\n- `src/app/instructor/components/StudentList.tsx` (lines 22-24)\n- Shows 'No students connected yet.' but no guidance\n- Needs: 'Waiting for students to join. Share the join code: [CODE]'\n\n### CodeEditor with no problem loaded\n- Editor shows starter code hint but no explanation\n- Needs: 'Waiting for instructor to load a problem...'\n\n### Output panel before first run\n- `src/app/student/components/OutputPanel.tsx` (lines 19-33)\n- Says 'Run your code to see the output here'\n- Needs context: Is the run button available? Is connection ready?\n\n## Implementation\nFor each empty state:\n1. Distinguish between 'loading' and 'empty'\n2. Explain WHY it's empty\n3. Suggest WHAT to do next\n4. Include relevant context (join codes, connection status)\n\n## Files to Modify\n- `src/app/instructor/components/StudentList.tsx`\n- `src/app/instructor/components/SessionsList.tsx` (if exists)\n- `src/app/student/components/OutputPanel.tsx`\n- `src/app/student/components/CodeEditor.tsx`","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-15T03:58:48.226427094Z","created_by":"node","updated_at":"2026-01-15T03:58:48.226427094Z"}
{"id":"coding-tool-e2a","title":"Problem creation view layout is broken — editor too small","description":"## Summary\n\nThe problem creation view has a broken layout where the code editor is too small.\n\n## Relevant Files\n\n- `src/app/(app)/instructor/problems/page.tsx:15-64` — Problem creation page, conditionally renders ProblemCreator at lines 42-53\n- `src/app/(app)/instructor/components/ProblemCreator.tsx:1-253` — Full component\n  - Lines 156-212: Header bar\n  - Lines 227-248: Code editor area using EditorContainer with variant=\"flex\"\n\n## Steps to Fix\n\n1. Review the ProblemCreator layout at `ProblemCreator.tsx:227-248` — the EditorContainer may not be getting enough height from its parent\n2. Ensure the ProblemCreator fills the available viewport height (use flex layout with `flex-1 min-h-0`)\n3. The parent page (`problems/page.tsx`) may also need layout adjustments to give ProblemCreator sufficient space\n4. Test that the editor is usable for writing multi-line code problems\n\nGitHub: #22","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:05:27.555465887Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:12:54.12731576Z","closed_at":"2026-01-28T22:12:54.12731576Z","close_reason":"Fixed in 176237d — flex layout for ProblemCreator fills viewport","labels":["wip"]}
{"id":"coding-tool-e98h","title":"Update register API to not auto-signin","description":"Modify src/app/api/auth/register/route.ts to not auto-signin after registration.\n\n**File to modify:**\n- src/app/api/auth/register/route.ts\n- src/app/api/auth/register/__tests__/route.test.ts\n\n**Changes:**\n1. Remove the auto-signin call: authenticateWithPassword(email, password)\n2. Change response to { success: true, message: 'Account created. Please sign in.' }\n3. User must sign in separately (which will trigger MFA)\n\n**Reason:**\nSystem-admin registration should require MFA verification on first login, not bypass it via auto-signin.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:33:19.090654467Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:19.302721382Z","closed_at":"2026-01-20T18:42:19.302721382Z","close_reason":"Register API updated - no auto-signin"}
{"id":"coding-tool-er5","title":"Remove or repurpose useRealtime hook for presence-only","description":"## Summary\n\nAfter postgres_changes code is removed from `useRealtimeSession`, evaluate whether `useRealtime` hook is still needed. It may be:\n1. **Removed entirely** if presence can be handled in the broadcast channel\n2. **Repurposed** to only handle presence tracking (remove all postgres_changes code)\n\n## Files to Modify\n\n1. `src/hooks/useRealtime.ts` - Either delete or simplify to presence-only\n2. `src/hooks/__tests__/useRealtime.test.ts` - Delete or update tests\n3. `src/hooks/useRealtimeSession.ts` - Update to either not use useRealtime, or use simplified version\n\n## Current useRealtime Functionality\n\nThe hook currently does:\n1. **postgres_changes subscriptions** (lines 126-141) - TO BE REMOVED\n2. **Presence tracking** (lines 143-149, 162-173) - KEEP if needed\n3. **Connection state management** - May need to merge with broadcast connection state\n4. **Reconnection logic** (lines 218-246) - May still be useful\n\n## Decision Points\n\n1. Can presence be handled on the same broadcast channel? If yes, remove useRealtime entirely.\n2. If presence needs a separate channel, keep useRealtime but remove postgres_changes code.\n\n## If Removing Entirely\n\n- Delete `src/hooks/useRealtime.ts`\n- Delete `src/hooks/__tests__/useRealtime.test.ts`\n- Move presence tracking into `useRealtimeSession` broadcast channel\n- Update CLAUDE.md to remove reference to useRealtime.ts\n\n## If Repurposing for Presence-Only\n\n- Remove lines 85-94 (handleDatabaseChange callback)\n- Remove lines 126-141 (postgres_changes subscriptions)\n- Remove `lastMessage` state and return value\n- Update tests to only test presence functionality\n- Rename to `usePresence` for clarity?\n\n## Testing\n\n**If removing useRealtime entirely:**\n- Delete `src/hooks/__tests__/useRealtime.test.ts`\n- Add presence tests to `src/hooks/__tests__/useRealtimeSession.test.ts`\n- Verify `onlineUsers` functionality still works\n\n**If keeping for presence-only:**\n- Update `src/hooks/__tests__/useRealtime.test.ts`:\n  - Remove all postgres_changes tests (lines 119-330)\n  - Keep presence tests (if any exist)\n  - Add new presence-only tests if needed\n\n## Dependencies\n\n- Depends on coding-tool-yut.3 (postgres_changes must be removed from useRealtimeSession first)\n\n## Notes\n\n- The `onlineUsers` state is currently exposed by useRealtimeSession - ensure this still works after changes\n- Presence uses the Supabase presence API which works alongside broadcast on the same channel","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:17:15.59957755Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.342008083Z","closed_at":"2026-01-25T17:51:21.718544136Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-erm","title":"Automated Test Case System","description":"Implement comprehensive automated testing system supporting multiple test types. Enables instructors to create test cases and students to validate their solutions. Supports input/output tests, pytest unit tests, and property-based tests with clear feedback and debugging integration.\n\n**Test Types Supported:**\n1. Input/Output Tests\n   - Provide stdin input\n   - Compare stdout against golden/expected output\n   - Support for exact match or pattern matching\n   - Useful for basic console programs\n\n2. PyTest Unit Tests\n   - Standard Python unit tests using pytest\n   - Test specific functions or classes\n   - Rich assertion messages\n   - Integration with pytest ecosystem\n\n3. Property-Based Tests\n   - Using hypothesis or similar framework\n   - Generate test cases automatically\n   - Test properties rather than specific cases\n   - Advanced validation\n\n**Core Features:**\n- Instructors create and manage test cases per problem\n- Students can view all test cases (visible by default)\n- Run individual tests or full test suite\n- Clear test output and error messages\n- Pass/fail indicators with details\n- Integration with execution trace debugger\n- Test execution in isolated environment\n\n**User Workflows:**\n\nInstructor:\n- Create test cases when defining problems\n- Specify test type and parameters\n- Edit/delete existing tests\n- Preview test execution\n- See aggregate student test results\n\nStudent:\n- View all test cases for current problem\n- Run individual test to verify specific functionality\n- Run all tests to validate complete solution\n- See detailed pass/fail results\n- Debug failing tests with trace debugger\n- Clear feedback on what went wrong\n\n**Architecture:**\n- Test definitions stored with problem specifications\n- Server-side test execution (security)\n- Isolated execution environment per test\n- Result caching for performance\n- Structured test output format\n\n**Data Model:**\n- TestCase: { id, type, name, description, config }\n- InputOutputTest: { input: string, expectedOutput: string, matchType: 'exact' | 'pattern' }\n- PyTestConfig: { testCode: string, functionName?: string }\n- PropertyTestConfig: { propertyCode: string, hypothesis: object }\n- TestResult: { testId, passed, output, error?, duration }\n\n**Integration Points:**\n- Problem specification (tests attached to problems)\n- Code execution (run tests against student code)\n- Debugger (debug failing tests)\n- Reporting (test pass rates in analytics)\n\n**Success Criteria:**\n- All three test types functional\n- Students can run and view all tests\n- Clear test output and feedback\n- Debugger integration works\n- Test execution is secure and isolated\n- Performance acceptable for multiple tests","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-18T19:33:05.471224092Z","updated_at":"2025-12-18T19:33:05.471224092Z"}
{"id":"coding-tool-erm.2","title":"Implement input/output test executor","description":"Build test executor for input/output tests. Runs student code with specified input and compares output against expected results.\n\nFiles to create:\n- src/server/testing/executors/io-test-executor.ts - Input/output test execution\n- src/server/testing/output-matcher.ts - Output comparison logic\n\nImplementation steps:\n1. Create IOTestExecutor class:\n   - Implements ITestExecutor for input-output tests\n   - Uses existing code execution infrastructure\n   - Injects stdin from test config\n   - Captures stdout for comparison\n\n2. Implement output matching logic:\n   - Exact match: Compare strings character-by-character\n   - Contains match: Check if expected is substring of actual\n   - Regex match: Test output against regex pattern\n   - Optional whitespace normalization\n   - Trim trailing whitespace/newlines\n\n3. Execute test workflow:\n   - Extract input and expected output from test config\n   - Run student code with stdin input\n   - Capture stdout output\n   - Compare using specified match type\n   - Return TestResult with pass/fail and details\n\n4. Handle test failures:\n   - Clear diff showing expected vs actual\n   - Highlight differences\n   - Show first line that differs (for exact match)\n   - Include full output in result\n\n5. Error handling:\n   - Runtime errors in student code (mark as failed)\n   - Timeout exceeded (configurable, default 5s)\n   - Empty output (handle gracefully)\n   - Malformed test config (validation error)\n\nOutput comparison example:\nExpected: Hello, World!\nActual:   Hello, World\nResult:   FAIL - Missing exclamation mark\n\nImplementation example:\nexport class IOTestExecutor implements ITestExecutor {\n  async executeTest(code: string, testCase: TestCase): Promise\u003cTestResult\u003e {\n    const config = testCase.config.data as InputOutputTestConfig;\n    const startTime = Date.now();\n    \n    // Run code with stdin\n    const result = await this.codeExecutor.execute(code, config.input);\n    \n    // Compare output\n    const passed = this.outputMatcher.match(\n      result.stdout,\n      config.expectedOutput,\n      config.matchType,\n      config.ignoreWhitespace\n    );\n    \n    return {\n      testId: testCase.id,\n      passed,\n      output: result.stdout,\n      error: result.error,\n      duration: Date.now() - startTime,\n      timestamp: new Date()\n    };\n  }\n}\n\nEdge cases:\n- Student code has runtime error (include in result)\n- Output has extra whitespace (handle with ignoreWhitespace)\n- Multi-line output comparison\n- Unicode/special characters in output\n- Very large output (truncate for display)\n- Code doesn't produce output (empty vs expected)\n\nDepends on:\n- coding-tool-erm.1 (test types must be defined)\n- coding-tool-cee (stdin support for code execution)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-18T19:33:40.983096411Z","updated_at":"2025-12-18T19:33:40.983096411Z"}
{"id":"coding-tool-erm.3","title":"Implement pytest test executor","description":"Build test executor for pytest unit tests. Executes pytest tests against student code and parses results.\n\nFiles to create:\n- src/server/testing/executors/pytest-executor.ts - PyTest execution\n- src/server/testing/pytest-parser.ts - Parse pytest output\n\nImplementation steps:\n1. Create PyTestExecutor class:\n   - Generate temporary test file with instructor's test code\n   - Write student code to temporary module\n   - Execute pytest via subprocess\n   - Parse pytest output (JSON or verbose format)\n   - Return structured test results\n\n2. Test file generation:\n   - Create temp directory for test execution\n   - Write student code as importable module (student_code.py)\n   - Write test code as test file (test_solution.py)\n   - Include necessary imports and setup\n   - Clean up after execution\n\n3. PyTest execution:\n   - Run pytest with JSON report plugin (--json-report)\n   - Or parse verbose output (-v)\n   - Capture stdout and stderr\n   - Handle pytest exit codes (0=pass, 1=fail, 2=error)\n   - Apply timeout (default 10s)\n\n4. Result parsing:\n   - Extract test pass/fail status\n   - Get assertion messages\n   - Include stack traces for failures\n   - Track individual test functions if multiple\n   - Format for UI display\n\n5. Error handling:\n   - Import errors (student code syntax error)\n   - Missing test function\n   - Pytest not available (install check)\n   - Timeout exceeded\n   - Assertion failures (include details)\n\nTest file structure example:\n# student_code.py\n\u003cstudent's code here\u003e\n\n# test_solution.py\nfrom student_code import *\nimport pytest\n\ndef test_fibonacci():\n    assert fibonacci(0) == 0\n    assert fibonacci(1) == 1\n    assert fibonacci(5) == 5\n\nPytest execution:\npytest test_solution.py --json-report --json-report-file=results.json -v\n\nImplementation example:\nexport class PyTestExecutor implements ITestExecutor {\n  async executeTest(code: string, testCase: TestCase): Promise\u003cTestResult\u003e {\n    const config = testCase.config.data as PyTestConfig;\n    \n    // Create temp files\n    const tempDir = await this.createTempDir();\n    await fs.writeFile(path.join(tempDir, 'student_code.py'), code);\n    await fs.writeFile(path.join(tempDir, 'test_solution.py'), config.testCode);\n    \n    // Run pytest\n    const result = await this.runPytest(tempDir);\n    \n    // Parse results\n    const parsed = this.parseResults(result);\n    \n    // Cleanup\n    await this.cleanup(tempDir);\n    \n    return parsed;\n  }\n}\n\nEdge cases:\n- Student code imports external libraries (may not be available)\n- Test code has syntax errors (instructor mistake)\n- Multiple test functions (aggregate results)\n- Parameterized tests (handle multiple cases)\n- Fixtures and setup/teardown (support pytest features)\n- Very slow tests (timeout)\n\nDepends on: coding-tool-erm.1 (test types defined)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-18T19:33:59.147419486Z","updated_at":"2025-12-18T19:33:59.147419486Z"}
{"id":"coding-tool-erm.4","title":"Implement property-based test executor using hypothesis","description":"Build test executor for property-based tests using the hypothesis library. Generates test cases automatically based on property specifications.\n\nFiles to create:\n- src/server/testing/executors/property-test-executor.ts - Property test execution\n- src/server/testing/hypothesis-wrapper.ts - Hypothesis integration\n\nImplementation steps:\n1. Create PropertyTestExecutor class:\n   - Integrates with hypothesis library\n   - Generates test wrapper code\n   - Executes property tests against student code\n   - Collects and reports counterexamples\n\n2. Property test setup:\n   - Import student code as module\n   - Import hypothesis strategies\n   - Create test function with @given decorator\n   - Run hypothesis test runner\n   - Capture any counterexamples found\n\n3. Test execution:\n   - Write student code to temp file\n   - Generate test file with property check\n   - Execute using hypothesis\n   - Parse results (pass/fail + counterexamples)\n   - Return structured results\n\n4. Result formatting:\n   - Success: No counterexamples found\n   - Failure: Show counterexample inputs\n   - Show property that failed\n   - Include shrunk minimal failing case\n   - Statistics (number of examples tested)\n\n5. Configuration support:\n   - maxExamples: Number of test cases to generate\n   - Custom strategies: Integer ranges, string patterns, etc.\n   - Timeouts per test case\n   - Verbosity settings\n\nProperty test example:\n# Property: reverse(reverse(x)) == x\nfrom hypothesis import given\nfrom hypothesis.strategies import text\nfrom student_code import reverse\n\n@given(text())\ndef test_reverse_property(s):\n    assert reverse(reverse(s)) == s\n\nImplementation example:\nexport class PropertyTestExecutor implements ITestExecutor {\n  async executeTest(code: string, testCase: TestCase): Promise\u003cTestResult\u003e {\n    const config = testCase.config.data as PropertyTestConfig;\n    \n    // Setup temp environment\n    const tempDir = await this.createTempDir();\n    await fs.writeFile(path.join(tempDir, 'student_code.py'), code);\n    \n    // Generate property test\n    const testCode = this.generateTestCode(config);\n    await fs.writeFile(path.join(tempDir, 'test_properties.py'), testCode);\n    \n    // Run hypothesis\n    const result = await this.runHypothesis(tempDir, config.maxExamples);\n    \n    // Parse and format results\n    return this.parseResults(result, testCase.id);\n  }\n}\n\nResult formatting:\nPASS: Property held for 100 examples\nFAIL: Found counterexample after 37 examples\n      Input: s = \"a\\x00b\"\n      Expected: \"a\\x00b\"\n      Actual: \"ab\"\n      Shrunk from: \"abc\\x00def\\x00ghi\"\n\nEdge cases:\n- Hypothesis not installed (dependency check)\n- Property that always fails (show counterexample)\n- Very slow property checks (timeout)\n- Complex custom strategies (validation)\n- Shrinking timeout (limit shrinking time)\n- Non-deterministic code (flaky tests)\n\nDepends on: coding-tool-erm.1 (test types defined)","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-18T19:34:17.353182716Z","updated_at":"2025-12-18T19:34:17.353182716Z"}
{"id":"coding-tool-erm.5","title":"Add instructor UI for creating and managing test cases","description":"Build instructor interface for creating, editing, and managing test cases within problem specifications. Supports all three test types with appropriate input forms.\n\nFiles to create:\n- src/app/instructor/components/TestCaseManager.tsx - Test case management UI\n- src/app/instructor/components/TestCaseForm.tsx - Create/edit test form\n- src/app/instructor/components/IOTestForm.tsx - Input/output test fields\n- src/app/instructor/components/PyTestForm.tsx - PyTest test fields\n- src/app/instructor/components/PropertyTestForm.tsx - Property test fields\n- src/hooks/useTestCases.ts - Test case management hook\n\nImplementation steps:\n1. Update ProblemInput component:\n   - Add test cases section\n   - List existing tests with type badges\n   - Add test button\n   - Edit/delete test actions\n   - Test order controls (drag to reorder)\n\n2. Create TestCaseForm component:\n   - Test type selector (radio buttons)\n   - Name and description fields\n   - Type-specific form (conditional rendering)\n   - Preview/run test button\n   - Save/cancel actions\n\n3. Create IOTestForm:\n   - Input textarea (multi-line)\n   - Expected output textarea\n   - Match type selector (exact, contains, regex)\n   - Ignore whitespace checkbox\n   - Example: Show what student will see\n\n4. Create PyTestForm:\n   - Test code editor (syntax highlighted)\n   - Target function field (optional)\n   - Timeout setting\n   - Hint: Example pytest code snippet\n\n5. Create PropertyTestForm:\n   - Property code editor\n   - Strategy configuration (JSON or builder)\n   - Max examples slider (default 100)\n   - Hint: Example hypothesis test\n\n6. Create useTestCases hook:\n   - fetchTestCases(problemId): Load tests for problem\n   - createTestCase(problemId, testCase): Add new test\n   - updateTestCase(testId, updates): Modify test\n   - deleteTestCase(testId): Remove test\n   - reorderTests(problemId, newOrder): Change order\n   - previewTest(code, testCase): Run test preview\n\n7. Add API routes:\n   - GET /api/problems/:id/tests - Get all tests for problem\n   - POST /api/problems/:id/tests - Create test\n   - PUT /api/tests/:id - Update test\n   - DELETE /api/tests/:id - Delete test\n   - POST /api/tests/:id/preview - Run test preview\n\nUI Layout (Test Case Manager):\n┌─────────────────────────────────────┐\n│ Test Cases           [+ Add Test]   │\n├─────────────────────────────────────┤\n│ 1. Basic Input/Output    [I/O]     │\n│    Input: 5, Output: 120            │\n│    [Edit] [Delete] [Preview]        │\n├─────────────────────────────────────┤\n│ 2. Test Factorial Function [PyTest]│\n│    Tests factorial(0) to factorial(5)│\n│    [Edit] [Delete] [Preview]        │\n├─────────────────────────────────────┤\n│ 3. Reverse Property      [Property] │\n│    Tests reverse(reverse(x)) == x   │\n│    [Edit] [Delete] [Preview]        │\n└─────────────────────────────────────┘\n\nUI Layout (Create Test):\n┌─────────────────────────────────────┐\n│ Add Test Case                       │\n├─────────────────────────────────────┤\n│ Test Type:                          │\n│ ○ Input/Output                      │\n│ ○ PyTest Unit Test                  │\n│ ○ Property-Based Test               │\n├─────────────────────────────────────┤\n│ Name: [Basic factorial test____]   │\n│ Description: [Tests factorial...] │\n├─────────────────────────────────────┤\n│ Input:                              │\n│ ┌─────────────────────────────────┐ │\n│ │ 5                               │ │\n│ └─────────────────────────────────┘ │\n│ Expected Output:                    │\n│ ┌─────────────────────────────────┐ │\n│ │ 120                             │ │\n│ └─────────────────────────────────┘ │\n│ Match Type: [Exact ▼]              │\n│ ☐ Ignore Whitespace                │\n├─────────────────────────────────────┤\n│ [Preview Test] [Save] [Cancel]      │\n└─────────────────────────────────────┘\n\nFeatures:\n- Create all three test types\n- Edit existing tests\n- Preview test execution\n- Reorder tests (drag and drop)\n- Delete tests with confirmation\n- Clear type-specific forms\n- Syntax highlighting for code editors\n\nEdge cases:\n- Invalid test configuration (validation)\n- Test preview fails (show error clearly)\n- No tests yet (show helper/example)\n- Duplicate test names (allow but warn)\n- Very long test code (scrollable editor)\n\nDepends on:\n- coding-tool-erm.2 (I/O executor for preview)\n- coding-tool-erm.3 (PyTest executor for preview)\n- coding-tool-erm.4 (Property executor for preview)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:34:46.70154459Z","updated_at":"2025-12-18T19:34:46.70154459Z"}
{"id":"coding-tool-erm.6","title":"Add student UI for viewing and running test cases","description":"Build student interface for viewing test cases, running individual/all tests, and viewing test results with clear pass/fail indicators.\n\nFiles to create:\n- src/app/student/components/TestPanel.tsx - Main test panel component\n- src/app/student/components/TestCaseList.tsx - List of test cases\n- src/app/student/components/TestResult.tsx - Individual test result display\n- src/app/student/components/TestSummary.tsx - Overall test results summary\n- src/hooks/useTestExecution.ts - Test execution hook\n\nImplementation steps:\n1. Create TestPanel component:\n   - Collapsible sidebar panel (similar to OutputPanel)\n   - Show all test cases for current problem\n   - Run All Tests button\n   - Run Individual Test buttons\n   - Live test execution progress\n   - Clear visual pass/fail indicators\n\n2. Create TestCaseList component:\n   - List all tests with type badges\n   - Name and description\n   - Run button per test\n   - Status indicator (not run, running, passed, failed)\n   - Expand/collapse test details\n   - Show input/expected for I/O tests\n\n3. Create TestResult component:\n   - Test name and type\n   - Status (✓ Passed / ✗ Failed / ⟳ Running)\n   - Execution time\n   - For failed tests:\n     - Expected vs Actual output (side-by-side)\n     - Error message/traceback\n     - First line of difference highlighted\n   - For passed tests:\n     - Brief success message\n   - Link to debugger (if execution trace available)\n\n4. Create TestSummary component:\n   - X/Y tests passed\n   - Progress bar (green for passed, red for failed)\n   - Filter: All / Passed / Failed\n   - Sort: Order / Name / Status\n\n5. Create useTestExecution hook:\n   - runTest(testId, code): Execute single test\n   - runAllTests(code): Execute all tests sequentially\n   - cancelExecution(): Stop running tests\n   - State: testResults, isRunning, currentTest\n   - Track execution time per test\n\n6. Update student page layout:\n   - Add TestPanel alongside code editor\n   - Resizable panels (code | output | tests)\n   - Tab-based or split view option\n   - Auto-run on code save (optional setting)\n\nUI Layout (Test Panel):\n┌─────────────────────────────────────┐\n│ Tests                [Run All Tests]│\n├─────────────────────────────────────┤\n│ ✓ 1. Basic Input (I/O)     [Run]   │\n│   Passed in 45ms                    │\n├─────────────────────────────────────┤\n│ ⟳ 2. Factorial Tests (PyTest) [Run]│\n│   Running...                        │\n├─────────────────────────────────────┤\n│ ✗ 3. Edge Cases (I/O)      [Run]   │\n│   Failed: Expected '0', got '1'     │\n│   [View Details] [Debug]            │\n├─────────────────────────────────────┤\n│ Summary: 1/3 passed (33%)           │\n│ ▓▓░░░░ [Filter: All ▼]             │\n└─────────────────────────────────────┘\n\nUI Layout (Failed Test Detail):\n┌─────────────────────────────────────┐\n│ ✗ Edge Cases (Input/Output)         │\n├─────────────────────────────────────┤\n│ Input:                              │\n│ ┌─────────────────────────────────┐ │\n│ │ 0                               │ │\n│ └─────────────────────────────────┘ │\n│ Expected Output:    Actual Output:  │\n│ ┌──────────────┐   ┌──────────────┐ │\n│ │ 0            │   │ 1            │ │\n│ └──────────────┘   └──────────────┘ │\n│ Execution time: 32ms                │\n│ [Debug This Test]                   │\n└─────────────────────────────────────┘\n\nFeatures:\n- View all test cases for problem\n- Run individual tests on demand\n- Run all tests with progress indicator\n- Clear pass/fail visual feedback (✓ ✗ ⟳)\n- Show test execution time\n- Detailed failure information with diff\n- Filter/sort test results\n- Expandable test details\n- Link to debugger for failed tests\n- Auto-scroll to first failure\n\nUser workflow:\n1. Student views problem and test cases\n2. Student writes code\n3. Student clicks 'Run All Tests'\n4. Tests execute sequentially\n5. Summary shows X/Y passed\n6. Student expands failed test\n7. Student sees expected vs actual\n8. Student clicks 'Debug This Test'\n9. Debugger loads with test input\n\nEdge cases:\n- No tests defined (show placeholder)\n- Test execution timeout (show timeout error)\n- Infinite loop in test (timeout protection)\n- Very long output (truncate with expand button)\n- Test crashes (show traceback)\n- Multiple rapid test runs (cancel previous)\n\nIntegration:\n- Share execution infrastructure with OutputPanel\n- Reuse code-executor.ts for test runs\n- Store test results in session state\n- Link test failures to debugger (coding-tool-5ic)\n- Show test results in revision history (coding-tool-asx)\n\nDepends on:\n- coding-tool-erm.2 (I/O test executor)\n- coding-tool-erm.3 (PyTest executor)\n- coding-tool-erm.4 (Property executor)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:36:25.855368457Z","updated_at":"2025-12-18T19:36:25.855368457Z"}
{"id":"coding-tool-fs9","title":"Notify students when problem changes mid-session","description":"## Summary\nWhen instructor loads or changes a problem mid-session, students get no notification. Their existing code may be affected.\n\n## Current Behavior\n- `src/app/instructor/page.tsx` (lines 287-300): Problem loaded and broadcast via Realtime\n- Student's editor updates but no explicit notification\n- Unclear if student's existing code is preserved or replaced\n\n## Implementation\n\n### 1. Show notification banner\nWhen problem changes:\n- Toast or banner: 'The instructor has updated the problem'\n- Highlight what changed (title, description, starter code)\n\n### 2. Handle existing code gracefully\nOptions:\n- Preserve student's code, show diff with new starter code\n- Or: Ask student 'Reset to new starter code?' with option to keep current\n\n### 3. Visual indicator\n- Brief highlight/flash on problem description when it updates\n- Badge showing 'Updated' that fades after a few seconds\n\n## Files to Modify\n- `src/app/student/page.tsx` - Listen for problem changes, show notification\n- Create `src/components/ProblemUpdateNotification.tsx`\n- May need to track 'previous problem' state for comparison","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-15T03:59:16.682259552Z","created_by":"node","updated_at":"2026-01-15T03:59:16.682259552Z"}
{"id":"coding-tool-g3dz","title":"Remove trivial property/existence tests","description":"Remove tests that verify class properties exist or match constants - functionality TypeScript enforces at compile time.\n\nFiles to modify:\n- src/server/code-execution/__tests__/backends/disabled-backend.test.ts (lines 11-26)\n- src/server/code-execution/__tests__/backends/vercel-sandbox-backend.test.ts (lines 76-91)\n- src/server/persistence/__tests__/storage-factory.test.ts (lines 82-93)\n\nEstimated reduction: ~50 lines\n\nVerification:\n1. npm test -- should pass\n2. npx tsc --noEmit -- should pass","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T17:29:15.812366424Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.641384594Z","closed_at":"2026-01-20T18:00:50.678359675Z","close_reason":"Completed"}
{"id":"coding-tool-g5n","title":"Public view: make header collapsible to give more space to code editor","status":"closed","priority":2,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T19:01:01.408843173Z","created_by":"Joe Delfino","updated_at":"2026-01-29T19:04:04.586193049Z","closed_at":"2026-01-29T19:04:04.586193049Z","close_reason":"Implemented in PR #39"}
{"id":"coding-tool-h0n","title":"Extract shared Student/RealtimeStudent/ExecutionResult types to instructor types file","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T13:47:41.362800918Z","created_by":"Joe Delfino","updated_at":"2026-01-29T13:48:59.080670135Z","closed_at":"2026-01-29T13:48:59.080670135Z","close_reason":"Fixed in 56a6801","labels":["wip"]}
{"id":"coding-tool-hh5","title":"Add markdown rendering support for problem descriptions","description":"Add markdown rendering support for problem descriptions (no image support needed).\n\n**Summary**: Problem descriptions currently display as plain text. Adding markdown support will allow instructors to format problem statements with headers, lists, code blocks, and emphasis for better readability.\n\n**Files to modify**:\n- Problem display components (likely in src/components/ or src/app/)\n- May need markdown parsing library (e.g., react-markdown, marked, or similar)\n\n**Implementation steps**:\n1. Identify where problem descriptions are rendered (search for problem description display)\n2. Install markdown parsing library: `npm install react-markdown` (or similar)\n3. Replace plain text rendering with markdown component\n4. Test with various markdown syntax (headers, lists, code blocks, bold, italic)\n5. Add CSS styling if needed for markdown output\n6. Update tests to verify markdown rendering\n\n**Scope**: Basic markdown only - headers, lists, code blocks, bold, italic, links. No image support needed.\n\n**Example**: \nBefore: \"Write a function that...\\nInput: list of integers\"\nAfter: \"## Problem\\nWrite a function that...\\n\\n**Input**: list of integers\"","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-05T16:23:23.958532543Z","created_by":"node","updated_at":"2026-01-20T17:01:32.440952293Z","closed_at":"2026-01-20T17:01:32.440952293Z","close_reason":"Duplicate of coding-tool-51o"}
{"id":"coding-tool-hvf","title":"Fix arrow button position jumping when scrolling through issue categories","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:04.133245253Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:04.01804597Z","closed_at":"2026-01-30T03:00:04.01804597Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-i2b","title":"Write E2E tests for navigation flows","description":"Write E2E tests for navigation flows and view mode transitions across the application.\n\n**File to create:**\n- e2e/navigation-flows.spec.ts\n\n**Tests to implement (~5 tests):**\n\n1. Complete instructor flow: classes → sections → session\n   - Start at /instructor\n   - Verify classes view displayed\n   - Create class\n   - Click class card\n   - Verify sections view displayed\n   - Verify viewMode changed\n   - Create section\n   - Click \"Create Session\"\n   - Verify session created\n   - Verify navigation to session page\n\n2. Back navigation preserves state\n   - Navigate classes → sections\n   - Create section\n   - Use browser back button\n   - Verify back at classes view\n   - Verify class still displays\n   - Navigate forward\n   - Verify section still displays\n\n3. Deep linking to sections\n   - Create class and section\n   - Navigate to /instructor?classId=X\n   - Verify sections view loads\n   - Verify correct class sections displayed\n\n4. View mode persistence\n   - Navigate to sections view\n   - Refresh page\n   - Verify still in sections view\n   - Verify correct class context maintained\n\n5. Breadcrumb navigation\n   - Navigate to sections view\n   - Click \"All Classes\" breadcrumb\n   - Verify return to classes view\n   - Navigate to session\n   - Click section breadcrumb\n   - Verify return to sections view\n\n**Navigation Checks:**\n- URL updates correctly\n- View mode state changes\n- Component rendering matches view mode\n- Context preserved across navigation\n- No broken links\n\n**Acceptance Criteria:**\n- All 5 tests passing\n- Tests catch view mode bugs\n- Tests verify state persistence\n- Tests validate deep linking\n- Execution time under 30 seconds","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:56:46.339507184Z","updated_at":"2025-12-27T18:57:51.169244973Z"}
{"id":"coding-tool-ia78","title":"Navigation \u0026 Layout Redesign: Replace magic ?view= routing with explicit routes, optimize start-session workflow","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:35:17.735806846Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.576513136Z","closed_at":"2026-01-23T00:25:16.526287293Z","close_reason":"All subtasks completed: navigation redesign with explicit routes, RBAC permissions, InstructorDashboard, StartSessionModal, and dead code cleanup"}
{"id":"coding-tool-idb","title":"Add session_ended broadcast to DELETE /api/sessions/[id]","description":"## Summary\n\nWhen a session ends, students need to be notified so they can show the \"Session Ended\" notification. Currently this relies on postgres_changes detecting the `sessions` table update, but we're migrating to Broadcast.\n\n## Files to Modify\n\n1. `src/app/api/sessions/[id]/route.ts` (lines 47-57)\n   - After `SessionService.endSession()` succeeds, broadcast `session_ended` event\n\n## Implementation\n\nAdd broadcast after line 48, following the same pattern as other routes:\n\n```typescript\n// After: await SessionService.endSession(storage, sessionId);\n\n// Broadcast session ended event\nconst supabase = getSupabaseBrowserClient(); // or use service role client\nconst channel = supabase.channel(`session:${sessionId}`);\nchannel.subscribe(async (status) =\u003e {\n  if (status === 'SUBSCRIBED') {\n    await channel.send({\n      type: 'broadcast',\n      event: 'session_ended',\n      payload: {\n        sessionId,\n        endedAt: new Date().toISOString(),\n      },\n    });\n    supabase.removeChannel(channel);\n  }\n});\n```\n\n## Testing\n\n1. Add test in `src/app/api/sessions/[id]/__tests__/route.test.ts`:\n   - Verify broadcast is sent when session is deleted\n   - Mock Supabase channel and verify `session_ended` event payload\n\n2. Test file reference: `src/app/api/sessions/[id]/feature/route.ts` tests may have broadcast mocking patterns to follow\n\n## Notes\n\n- Look at `src/app/api/sessions/[id]/feature/route.ts` for the broadcast pattern\n- The client subscription will be added in a separate task\n- Consider using service role client since this is a server-side route","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:37.919372796Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.321378Z","closed_at":"2026-01-25T17:31:43.12390184Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-inm","title":"Analysis results show current student code instead of analyzed code snapshot","description":"## Summary\n\nWhen analysis is run, the AI analyzes the code that students had at that moment. But the UI displays the student's **current** code from realtime state, not the code that was actually analyzed. If a student updates their code after analysis runs, the instructor sees mismatched analysis comments and code.\n\n## Root Cause\n\nThe analysis API (`/api/sessions/[id]/analyze`) correctly reads fresh code from the DB and sends it to Gemini. But `WalkthroughEntry` has no code field — it only returns metadata (studentId, category, discussionPoints). The UI component `SessionStudentPane.tsx` then displays code from `realtimeStudents` local state, which may have been updated since the analysis ran.\n\n## Files to modify\n\n1. **`src/server/types/analysis.ts`** — Add `codeSnapshot` field to `WalkthroughEntry` or `WalkthroughScript`\n2. **`src/app/api/sessions/[id]/analyze/route.ts`** — Include student code snapshots in the response (lines 60-84)\n3. **`src/app/(app)/instructor/hooks/useAnalysisGroups.ts`** — Store/expose code snapshots from analysis response\n4. **`src/app/(app)/instructor/components/SessionStudentPane.tsx`** — When analysis is active and a student is selected via analysis, use the snapshot code instead of realtime code\n\n## Implementation\n\n1. Add a `codeSnapshots: Record\u003cstring, string\u003e` field to the analysis API response (mapping studentId -\u003e code at analysis time)\n2. Store these snapshots in the `useAnalysisGroups` hook state\n3. In `SessionStudentPane`, when displaying a student selected via analysis walkthrough, prefer the snapshot code over realtime code\n4. Add tests verifying snapshot code is used during analysis viewing","status":"in_progress","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T15:10:42.611075547Z","created_by":"Joe Delfino","updated_at":"2026-01-29T15:10:55.433721803Z","labels":["wip"]}
{"id":"coding-tool-ivh","title":"Remove postgres_changes code from useRealtimeSession","description":"## Summary\n\nAfter broadcast subscriptions are complete, remove all postgres_changes handling from `useRealtimeSession`. This includes removing the dependency on `useRealtime` hook for event handling.\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts`\n   - Remove `lastMessage` from useRealtime destructuring (line 109)\n   - Remove entire `lastMessage` handler useEffect (lines 302-354)\n   - Keep `useRealtime` ONLY if presence tracking is still needed, otherwise remove entirely\n\n## Code to Remove\n\nLines 302-354 (the entire lastMessage handler):\n```typescript\n/**\n * Handle Realtime messages\n */\nuseEffect(() =\u003e {\n  if (!lastMessage) {\n    return;\n  }\n\n  const { type, table, payload } = lastMessage;\n\n  // Handle session_students updates\n  if (table === 'session_students') {\n    // ... all this is dead code, handled by broadcast\n  }\n\n  // Handle sessions updates (featured student changes, status changes)\n  if (table === 'sessions') {\n    // ... all this is dead code after broadcast subscriptions added\n  }\n\n  // Handle revisions (execution results)\n  if (table === 'revisions') {\n    // ... this was never implemented, just logs\n  }\n}, [lastMessage]);\n```\n\n## Testing\n\nUpdate `src/hooks/__tests__/useRealtimeSession.test.ts`:\n\n1. **Remove tests** that mock `lastMessage` from useRealtime:\n   - Lines 204-343 contain tests for postgres_changes via lastMessage\n   - These test dead code paths and should be deleted\n\n2. **Verify existing broadcast tests still pass** after removing postgres_changes code\n\n3. **Update the useRealtime mock** (lines 16-17) to not include `lastMessage` if it's removed from the hook\n\nTest files to update:\n- `src/hooks/__tests__/useRealtimeSession.test.ts` - remove lastMessage tests\n\n## Dependencies\n\n- Depends on coding-tool-yut.2 (broadcast subscriptions must be added first)\n\n## Notes\n\n- After this change, the `useRealtime` hook may only be needed for presence tracking\n- If presence is moved to the broadcast channel, `useRealtime` can be removed entirely\n- Update the hook's JSDoc comments to remove mentions of postgres_changes","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:16:47.876080176Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.344681833Z","closed_at":"2026-01-25T17:42:39.146668171Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-ja2","title":"Run code from public view shows no output","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-20T03:58:44.326508175Z","created_by":"Joe Delfino","updated_at":"2026-01-20T04:04:44.227472966Z","closed_at":"2026-01-20T04:04:44.227472966Z","close_reason":"Fixed: Added useApiExecution={true} and local code state to enable code execution in public view"}
{"id":"coding-tool-jkz","title":"Student editor page scrolling and layout issues","description":"## Summary\n\nThe student session editor page does not properly fill the viewport. The page scrolls instead of containing the editor within the window, and the headers (\"Live coding session\" / Leave Session button) take up too much vertical space. The experience should feel like an app/codespace, not a webpage with an embedded editor.\n\n## Relevant Files\n\n- `src/app/(fullscreen)/student/page.tsx:276-361` — Main rendering, uses EditorContainer with variant=\"flex\"\n- `src/app/(fullscreen)/student/components/EditorContainer.tsx` — Container layout component\n- `src/app/(fullscreen)/student/components/CodeEditor.tsx:432-1131` — Editor component with layout (see comments at lines 410-430)\n\n## Steps to Fix\n\n1. Ensure the outermost container uses `h-screen` / `overflow-hidden` to prevent page-level scrolling\n2. Reduce header height — make the \"Live coding session\" header and Leave button more compact (smaller text, less padding)\n3. Make the editor fill remaining vertical space using flex layout (`flex-1 min-h-0 overflow-hidden`)\n4. Scrolling should only happen inside the code editor itself, not on the page\n5. Test with long code content to verify the editor scrolls internally while the page does not\n\nGitHub: #26","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:04:42.533430504Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:18:39.487565003Z","closed_at":"2026-01-28T22:18:39.487565003Z","close_reason":"Fixed in 137f763 — overflow-hidden, compact header, app-like layout","labels":["wip"]}
{"id":"coding-tool-kdu","title":"Write E2E tests for instructor section management","description":"Write comprehensive E2E tests for instructor section management: create, edit, delete sections, join code generation.\n\n**File to create:**\n- e2e/instructor-section-management.spec.ts\n\n**Tests to implement (~6 tests):**\n\n1. Create section successfully\n   - Navigate to class → sections view\n   - Click \"New Section\"\n   - Fill form (name, semester)\n   - Submit\n   - Verify section appears with join code\n   - Verify persistence\n\n2. Edit section\n   - Create test section\n   - Click edit\n   - Modify fields\n   - Save\n   - Verify updates\n\n3. Delete section with confirmation\n   - Create test section\n   - Click delete\n   - Confirm deletion\n   - Verify section removed\n   - Verify persistence\n\n4. Join code generation\n   - Create section\n   - Verify join code displayed\n   - Click regenerate join code\n   - Verify new code generated\n   - Verify old code no longer works (if testable)\n\n5. Add co-instructor\n   - Create section\n   - Click \"Add Instructor\"\n   - Enter instructor email\n   - Submit\n   - Verify instructor added\n\n6. Navigation: classes → sections\n   - Create class with sections\n   - Click class card\n   - Verify navigation to sections view\n   - Verify sections list displays\n\n**Acceptance Criteria:**\n- All 6 tests passing\n- Tests catch navigation bugs\n- Tests verify join code functionality\n- Execution time under 35 seconds","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-27T18:56:43.046697796Z","updated_at":"2025-12-27T18:57:50.95065063Z"}
{"id":"coding-tool-kir0","title":"Update signin page with MFA UI","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:35:02.212414417Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:40.344080461Z","closed_at":"2026-01-20T18:42:40.344080461Z","close_reason":"signin page MFA UI added"}
{"id":"coding-tool-kvg","title":"Python Code Debugger with Time-Travel","description":"Build an interactive Python code debugger that allows students to step through program execution forward and backward. Captures complete execution trace with variable states, call stack, and stdout at each step. Provides educational value by helping students understand program flow and debug issues.\n\n**Core Capabilities:**\n- Server-side execution tracing with full program state capture\n- Forward/backward stepping through code execution\n- Variable inspector showing locals and globals at each step\n- Call stack display showing function call hierarchy\n- Line-by-line code highlighting during debugging\n- Integration with code editor for seamless experience\n\n**User Workflows:**\n\nStudent debugging workflow:\n1. Student writes code and clicks \"Debug\" button\n2. Server executes code with full tracing enabled\n3. Debugger UI opens with trace loaded\n4. Student navigates through execution steps (forward/backward)\n5. Student inspects variable values at each step\n6. Student views call stack to understand function calls\n7. Student identifies where code behavior differs from expectation\n8. Student fixes code and re-runs\n\n**Educational Benefits:**\n- Visual understanding of program execution flow\n- See how variables change over time\n- Understand recursion through call stack visualization\n- Identify logic errors by stepping through code\n- Learn debugging skills and mental model building\n\n**Technical Architecture:**\n- Server-side Python tracing (sys.settrace or similar)\n- Step limit (5000 steps) to prevent memory issues\n- Truncation for infinite loops/long runs\n- WebSocket-based trace delivery\n- Client-side trace navigation and display\n- Read-only code editor during debugging\n- Variable inspector with change highlighting\n- Call stack panel with current frame indicator\n\n**Components:**\n1. Server-side tracer (coding-tool-5ic)\n2. Debugger UI with navigation (coding-tool-zv4)\n3. Variable inspector panel (coding-tool-p14)\n4. Call stack display (coding-tool-9cx)\n\n**Success Criteria:**\n- Students can debug Python code with full trace\n- Step forward and backward through execution\n- View all variables at any execution point\n- See complete call stack at each step\n- Handle programs up to 5000 execution steps\n- Clear feedback for truncated traces\n- Performance: trace generation under 10 seconds\n- UI responsive during navigation\n\n**Dependencies:**\n- Execution infrastructure (already exists)\n- WebSocket communication (already exists)\n- Monaco editor integration (already exists)","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-27T18:42:54.841425328Z","updated_at":"2025-12-27T18:43:25.759863741Z"}
{"id":"coding-tool-kwt","title":"Multi-Problem Sessions","description":"Implement support for multiple problems within a single coding session. Instructors can present one problem, let students work on it, then seamlessly transition to a new problem. Students should be able to navigate back to previous problems and their code.\n\n**Use Case:**\nInstructor creates a session and loads Problem 1. Students join and work on it. When ready, instructor loads Problem 2. Students see the new problem and a fresh editor, but can switch back to Problem 1 to view/edit their previous code.\n\n**Core Requirements:**\n- Session contains multiple problems (ordered sequence)\n- Each problem has independent student code revisions (isolated per problem)\n- Each problem has independent execution results\n- Instructor controls active problem (what students see by default)\n- Students can navigate between all problems in the session\n- Code auto-saves per problem (switching doesn't lose work)\n- Clear UI indication of current vs previous problems\n- Seamless transitions (no session restart needed)\n\n**Data Model Changes:**\n\nCurrent: Session has ONE problem specification and ONE set of student code revisions\n\nNeeded:\n- Session has ARRAY of problems with Problem[] type\n- Each problem: { id, order, title, description, starterCode, testCases, loadedAt }\n- Session has activeProblemIndex field\n- Student revisions keyed by (sessionId, studentId, problemId)\n- Each problem tracks student activity independently\n\n**UI Changes - Instructor:**\n- Load New Problem button (adds to session)\n- Problem navigation: tabs or dropdown showing all loaded problems\n- Active problem indicator (green dot, Current badge)\n- Student progress view shows per-problem completion\n- Can switch between problems to view student work\n\n**UI Changes - Student:**\n- Problem navigation UI (tabs/dropdown)\n- Active problem highlighted (auto-focus when instructor changes)\n- Previous problems accessible (grayed out or Previous badge)\n- Code preserved when switching (auto-save)\n- Visual indicator when instructor loads new problem\n- Notification: Instructor loaded Problem 2: Binary Search\n\n**Implementation Steps:**\n1. Update Session type to support problems array\n2. Update session-manager.ts to handle multiple problems\n3. Add WebSocket events: problem-loaded, active-problem-changed\n4. Update code-executor.ts to scope by problemId\n5. Modify instructor UI to add problem navigation\n6. Modify student UI to show problem selector\n7. Update useWebSocket hook for new events\n8. Add auto-save logic when switching problems\n9. Update revision storage to key by problemId\n10. Add UI notifications for problem transitions\n\n**Success Criteria:**\n- Instructor can load multiple problems in one session\n- Students auto-see new problem when loaded\n- Code preserved when switching between problems\n- No data loss during transitions\n- Clear visual feedback for current problem\n- Smooth UX (no confusion about what to work on)\n\n**Integration Points:**\n- Problem Library (coding-tool-xj9): Load problems from library\n- Test System (coding-tool-erm): Tests scoped per problem\n- Persistence (coding-tool-uvn): Store multi-problem sessions\n- Analytics: Track time spent per problem\n\n**Edge Cases:**\n- Student joins session with 3 problems already loaded (show current + history)\n- Instructor deletes a problem (handle student code cleanup)\n- Student working on old problem when new one loads (non-disruptive notification)\n- Network reconnection (restore correct problem view)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-18T19:42:49.75625767Z","updated_at":"2026-01-23T15:15:16.4685193Z","closed_at":"2026-01-23T15:15:16.4685193Z","close_reason":"Obsolete - simpler model: one session per problem"}
{"id":"coding-tool-kwt.1","title":"Update data model for multi-problem sessions","description":"Update TypeScript types and interfaces in src/server/types.ts to support multiple problems within a session. This establishes the foundation for the multi-problem feature.\n\nFiles to modify:\n- src/server/types.ts (lines 1-30)\n\nCurrent structure:\n- Session has: id, joinCode, problem (single ProblemSpec), students, active\n- ProblemSpec: { title, description, starterCode }\n\nRequired changes:\n\n1. Create Problem type with metadata:\n   - id: string (unique problem identifier)\n   - order: number (sequence in session)\n   - title: string\n   - description: string\n   - starterCode: string\n   - testCases?: TestCase[] (future integration)\n   - loadedAt: Date (timestamp when added to session)\n\n2. Update Session type:\n   - Replace problem: ProblemSpec with problems: Problem[]\n   - Add activeProblemIndex: number (which problem is currently active)\n   - Keep backward compatibility initially\n\n3. Update StudentInfo type:\n   - Add currentProblemId?: string (which problem student is viewing)\n\n4. Update CodeRevision type:\n   - Add problemId: string (scope revisions to specific problem)\n   - Revisions key becomes (sessionId, studentId, problemId)\n\n5. Consider ExecutionResult type:\n   - Add problemId: string (scope results to problem)\n\nImplementation notes:\n- activeProblemIndex = 0 means first problem is active\n- problems array maintains order (sorted by order field)\n- Empty problems array = no problem loaded yet\n- Migration: existing sessions with single problem can convert to problems[0]\n\nExample transformation:\nBefore: { id, joinCode, problem: {...}, students: [...], active: true }\nAfter: { id, joinCode, problems: [{id, order: 0, ...problem, loadedAt: now}], activeProblemIndex: 0, students: [...], active: true }","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T19:43:31.929771803Z","updated_at":"2026-01-23T15:14:59.413046959Z","closed_at":"2026-01-23T15:14:59.413046959Z","close_reason":"Obsolete - using one session per problem"}
{"id":"coding-tool-kwt.2","title":"Update session manager for multi-problem support","description":"Update session-manager.ts to handle multiple problems within sessions, including loading new problems, switching active problem, and managing problem-scoped state.\n\nFiles to modify:\n- src/server/session-manager.ts (entire file)\n\nDependencies:\n- Requires coding-tool-kwt.1 (data model changes)\n\nRequired changes:\n\n1. Update createSession():\n   - Initialize with empty problems array\n   - Set activeProblemIndex to -1 (no problem loaded)\n   - OR accept initial problem and set to problems[0]\n\n2. Add loadProblem(sessionId, problem):\n   - Validates session exists\n   - Generates unique problemId\n   - Adds problem to session.problems array\n   - Sets activeProblemIndex to new problem\n   - Returns problemId\n   - Broadcasts 'problem-loaded' event to all connected clients\n\n3. Add setActiveProblem(sessionId, problemIndex):\n   - Validates problemIndex within bounds\n   - Updates session.activeProblemIndex\n   - Broadcasts 'active-problem-changed' event\n   - Used when instructor switches between existing problems\n\n4. Update setProblem() (backward compatibility):\n   - Wrapper that calls loadProblem() for first problem\n   - Maintains existing API during migration\n\n5. Add getProblem(sessionId, problemId?):\n   - If problemId provided, return specific problem\n   - If not provided, return active problem\n   - Returns null if not found\n\n6. Add listProblems(sessionId):\n   - Returns all problems in session (ordered by order field)\n\n7. Update getStudentCode(sessionId, studentId, problemId):\n   - Add problemId parameter\n   - Return code for specific problem\n   - Default to active problem if not specified\n\n8. Update saveStudentCode(sessionId, studentId, code, problemId):\n   - Add problemId parameter\n   - Save code scoped to specific problem\n   - Default to active problem if not specified\n\n9. Consider code revision storage:\n   - Change from Map\u003csessionId-studentId, revisions\u003e\n   - To Map\u003csessionId-studentId-problemId, revisions\u003e\n   - Isolate code history per problem\n\nImplementation notes:\n- Maintain backward compatibility where possible\n- Problem IDs should be unique within session (e.g., prob_1, prob_2)\n- Broadcast events include full problem data for client sync\n- Handle edge case: loading problem when no session exists\n\nExample API usage:\nconst sessionId = createSession(joinCode, initialProblem);\nconst prob2Id = loadProblem(sessionId, problem2); // adds to array, sets active\nsetActiveProblem(sessionId, 0); // switch back to first problem\nconst currentProblem = getProblem(sessionId); // gets active problem","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T19:43:50.237560626Z","updated_at":"2026-01-23T15:15:05.45460167Z","closed_at":"2026-01-23T15:15:05.45460167Z","close_reason":"Obsolete - using one session per problem"}
{"id":"coding-tool-kwt.3","title":"Add WebSocket events for problem management","description":"Extend WebSocket handler to support new events for loading problems, switching active problems, and syncing problem state between instructor and students.\n\nFiles to modify:\n- src/server/websocket-handler.ts (WebSocket event handlers)\n- src/hooks/useWebSocket.ts (client-side hook)\n\nDependencies:\n- Requires coding-tool-kwt.2 (session manager changes)\n\nNew WebSocket Events:\n\nServer → Client:\n1. 'problem-loaded': Sent when instructor loads a new problem\n   - Payload: { sessionId, problem: Problem, problemIndex: number }\n   - Sent to all students in session\n   - Students auto-update UI to show new problem\n\n2. 'active-problem-changed': Sent when instructor switches between problems\n   - Payload: { sessionId, activeProblemIndex: number, problem: Problem }\n   - Students receive notification but don't auto-switch\n   - UI shows indicator that instructor is on different problem\n\n3. 'problem-list-updated': Sent when problem list changes\n   - Payload: { sessionId, problems: Problem[], activeProblemIndex: number }\n   - Complete sync of problem state\n\nClient → Server:\n1. 'load-problem': Instructor loads new problem into session\n   - Payload: { sessionId, problem: Omit\u003cProblem, 'id' | 'order' | 'loadedAt'\u003e }\n   - Server generates id, order, loadedAt\n   - Server broadcasts 'problem-loaded' to all clients\n\n2. 'set-active-problem': Instructor changes which problem is active\n   - Payload: { sessionId, problemIndex: number }\n   - Server broadcasts 'active-problem-changed'\n\n3. 'switch-problem': Student switches their view to different problem\n   - Payload: { sessionId, studentId, problemId: string }\n   - Updates student's currentProblemId in session\n   - Does NOT affect other students\n   - Server sends back code for that problem\n\n4. 'get-problem': Request specific problem data\n   - Payload: { sessionId, problemId: string }\n   - Response: { problem: Problem, code: string }\n\nImplementation in websocket-handler.ts:\n\nsocket.on('load-problem', async (data) =\u003e {\n  const { sessionId, problem } = data;\n  const problemId = await sessionManager.loadProblem(sessionId, problem);\n  // Broadcast to all clients in session\n  io.to(sessionId).emit('problem-loaded', {\n    sessionId,\n    problem: sessionManager.getProblem(sessionId, problemId),\n    problemIndex: session.activeProblemIndex\n  });\n});\n\nsocket.on('set-active-problem', (data) =\u003e {\n  const { sessionId, problemIndex } = data;\n  sessionManager.setActiveProblem(sessionId, problemIndex);\n  const problem = sessionManager.getProblem(sessionId);\n  io.to(sessionId).emit('active-problem-changed', {\n    sessionId,\n    activeProblemIndex: problemIndex,\n    problem\n  });\n});\n\nImplementation in useWebSocket.ts:\n\n- Add event listeners for new events\n- Expose functions: loadProblem(), setActiveProblem(), switchProblem()\n- Update state when receiving problem events\n- Handle notifications for students\n\nSuccess criteria:\n- Instructor can load problem via WebSocket\n- All students receive problem-loaded event\n- Students can switch between problems\n- Code persists when switching\n- Events properly typed in TypeScript","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T19:44:10.522383118Z","updated_at":"2026-01-23T15:15:11.002377089Z","closed_at":"2026-01-23T15:15:11.002377089Z","close_reason":"Obsolete - using one session per problem"}
{"id":"coding-tool-l5o","title":"Public view editor is read-only but should be editable","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-20T03:58:49.806186052Z","created_by":"Joe Delfino","updated_at":"2026-01-20T04:04:51.442073595Z","closed_at":"2026-01-20T04:04:51.442073595Z","close_reason":"Fixed: Removed readOnly prop and added local code state for editing"}
{"id":"coding-tool-lp0","title":"Minimal GDPR compliance - data export and deletion capability","description":"## Summary\nAdd minimal GDPR compliance capability to handle data subject requests manually. Not building self-service features - just ensuring admins can fulfill requests when they come in.\n\n## Scope\n- Manual/admin process, not self-service\n- Low priority - app won't actively market to EU users\n- Needed for baseline legal compliance if EU users do sign up\n\n## Implementation\n\n### 1. Data Export Script\nCreate an admin script to export all data for a user:\n\n```bash\n# Usage: npm run gdpr:export \u003cuser-email\u003e\n```\n\nScript location: `scripts/gdpr-export.ts`\n\nData to export (JSON format):\n- User profile (email, display_name, role, created_at)\n- Session participation history (session IDs, join times)\n- Code submissions (all revisions with timestamps)\n- Any other user-associated data\n\n### 2. Data Deletion Script\nCreate an admin script to delete/anonymize user data:\n\n```bash\n# Usage: npm run gdpr:delete \u003cuser-email\u003e\n```\n\nScript location: `scripts/gdpr-delete.ts`\n\nActions:\n- Delete user from Supabase Auth\n- Remove from all session participant lists\n- Delete or anonymize code submissions (replace with '[deleted]')\n- Remove from section memberships\n- Log deletion for audit purposes\n\n### 3. Privacy Policy Update\nUpdate privacy policy (from coding-tool-pfj) to include:\n- Contact email for data requests\n- Statement that requests will be fulfilled within 30 days\n- Types of data collected and retained\n\n## Notes\n- No UI needed - admin runs scripts directly\n- Consider adding confirmation prompt before deletion\n- Keep audit log of deletions (date, anonymized user ID)\n- GDPR requires response within 30 days (not immediate)","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-15T03:52:46.445527885Z","created_by":"node","updated_at":"2026-01-15T03:52:59.108236335Z"}
{"id":"coding-tool-ltl","title":"Auto-update student pages when instructor starts a session","description":"## Summary\n\nWhen an instructor starts a new session, students who are already logged in and viewing `/sections` do not see the active session promptly. The page eventually updates (after ~1 minute via polling), but it should update faster or in real-time.\n\n## Relevant Files\n\n- `src/app/(app)/sections/page.tsx:10-112` — Sections page\n- `src/app/(app)/sections/components/SectionCard.tsx:30-46` — Active session polling (currently every 30 seconds)\n- `src/hooks/useRealtimeSession.ts` — Realtime subscriptions (used in session view, not on sections page)\n\n## Root Cause\n\nThe sections page uses a 30-second polling interval to check for active sessions (`SectionCard.tsx:30-46`). There is no Supabase Realtime subscription on the sections page for session status changes.\n\n## Steps to Fix\n\nOption A (quick): Reduce polling interval to 5-10 seconds on the sections page.\n\nOption B (better): Add a Supabase Realtime subscription on the sections page that listens for new sessions being created or session status changes, and triggers a refetch immediately.\n\nGitHub: #24","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-28T22:05:04.821137126Z","created_by":"Joe Delfino","updated_at":"2026-01-28T22:14:32.462391833Z","closed_at":"2026-01-28T22:14:32.462391833Z","close_reason":"Fixed in 001099f — polling reduced from 30s to 10s","labels":["wip"]}
{"id":"coding-tool-lza","title":"Close editor sidebar by default when viewing student code","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:04.239944503Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:04.065609387Z","closed_at":"2026-01-30T03:00:04.065609387Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-m81i","title":"Remove documentation-as-tests from proxy.test.ts","description":"Remove tests with expect(true).toBe(true) that only contain comments documenting expected behavior.\n\nFiles to modify:\n- src/server/__tests__/proxy.test.ts (lines 248-278) - Integration Behavior Documentation describe block\n\nMove the documentation content to an ADR or README instead.\n\nEstimated reduction: ~30 lines\n\nVerification:\n1. npm test -- should pass\n2. Documentation preserved elsewhere","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-20T17:29:37.954714378Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.638651844Z","closed_at":"2026-01-20T18:05:31.33247668Z","close_reason":"Completed"}
{"id":"coding-tool-md54","title":"Migrate role checks to permission checks (RBAC)","description":"Update permission checks across components:\n- Replace user.role === 'instructor' with hasPermission(user, 'class.read') or appropriate permission\n- Use getAuthContext() pattern consistently\n\nFiles to check (run grep to find all instances):\n- src/app/(app)/classes/[id]/page.tsx\n- src/app/(app)/instructor/page.tsx  \n- src/app/(app)/instructor/components/*.tsx\n- src/app/api/classes/**/*.ts\n- src/app/api/sections/**/*.ts\n- src/config/navigation.ts (may need to use permissions instead of roles)\n\nFind/replace patterns:\n- user.role === 'instructor' → hasPermission checks\n- allowedRoles.includes(user.role) → permission checks\n\n**Testing:** Ensure existing permission tests pass, add tests for new permission checks","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:39.451905384Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.597373011Z","closed_at":"2026-01-23T00:23:46.284060668Z","close_reason":"Migrated role checks to permission-based checks using hasRolePermission()"}
{"id":"coding-tool-mqc","title":"Layout Components - AppShell, Sidebar, Panels","description":"Create the layout component system.\n\n## Files to Create\n\n### src/components/layout/\n```\n├── AppShell.tsx           # Main wrapper: header + sidebars + content + right panels\n├── GlobalHeader.tsx       # Fixed top bar with logo, session banner, user menu\n├── Sidebar.tsx            # Left sidebar, collapsible, role-filtered nav items\n├── SidebarToggle.tsx      # Collapse/expand button with chevron icon\n├── MobileNav.tsx          # Slide-out drawer for mobile\n├── UserMenu.tsx           # Avatar dropdown: profile, sign out\n├── ActiveSessionBanner.tsx # Green banner linking to active session\n├── PageBreadcrumb.tsx     # Auto-generated breadcrumb\n├── RightPanelContainer.tsx # Container for right-side contextual panels\n├── Panel.tsx              # Generic collapsible panel\n└── PanelToggle.tsx        # Collapse/expand button for panels\n```\n\n### src/hooks/\n- `useBreadcrumbs.ts` - Generate breadcrumb items from current path\n- `useActiveSession.ts` - Wrapper around ActiveSessionContext\n- `useSidebarCollapsed.ts` - Sidebar state with localStorage persistence\n- `usePanelState.ts` - Right panel collapsed/expanded state\n\n## Panel Specifications\n\n### Right Panel Container\n- **Width:** 320px fixed\n- **Position:** Right side of main content area\n- **Behavior:** Panels stack vertically within container\n\n### Individual Panels\n- **Expanded height:** Auto (content-driven), scrollable when overflow\n- **Collapsed height:** 40px (header only with title + expand icon)\n- **Animation:** 200ms ease-in-out transition on collapse/expand\n- **Ordering:** Fixed order (Problem Setup → AI Walkthrough), not user-reorderable\n\n### Sidebar Behavior\n- **Desktop expanded:** w-64 (256px)\n- **Desktop collapsed:** w-16 (64px) icon rail\n- **Toggle:** Button at bottom, state persisted to localStorage\n- **Collapsed tooltips:** Show label on hover\n- **Mobile (\u003c1024px):** Hidden, hamburger opens drawer\n\n### Mobile Panel Behavior\n- **Breakpoint:** \u003c 1024px\n- **Right panels:** Hidden on mobile, accessible via \"Tools\" button that opens bottom sheet\n- **Bottom sheet:** Slides up from bottom, contains same panel content\n\n## Accessibility Requirements\n- Keyboard navigation for sidebar items (arrow keys, Enter)\n- ARIA labels for collapsed icon-only sidebar items\n- Focus management when panels collapse/expand\n- `aria-expanded` attribute on collapsible elements\n\n## Testing\n- Unit tests for hooks (useSidebarCollapsed, usePanelState)\n- Component tests for Panel collapse/expand behavior\n- Responsive tests for mobile breakpoint behavior","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:24:48.875796805Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.35023225Z","closed_at":"2026-01-22T03:19:35.560025551Z","close_reason":"Completed"}
{"id":"coding-tool-mqd","title":"Add markdown support to public view problem display","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T05:34:55.951768426Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.348621292Z","closed_at":"2026-01-23T05:40:06.932884625Z","close_reason":"Already implemented in commit e993792 - public view now uses MarkdownContent component with test coverage"}
{"id":"coding-tool-n6m1","title":"Create complete-mfa API endpoint","description":"Create src/app/api/auth/complete-mfa/route.ts to finalize MFA verification.\n\n**Files to create:**\n- src/app/api/auth/complete-mfa/route.ts\n- src/app/api/auth/complete-mfa/__tests__/route.test.ts\n\n**POST endpoint logic:**\n1. Verify mfa_pending cookie exists and is valid (verifyMfaCookie)\n2. Get current session from request (user authenticated via browser verifyOtp)\n3. Verify session user's email matches cookie's email\n4. Clear mfa_pending cookie\n5. Return { user }\n\n**Error cases:**\n- No/invalid mfa_pending cookie → 403\n- No session → 401\n- Email mismatch → 403","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-20T17:32:56.684110429Z","created_by":"Joe Delfino","updated_at":"2026-01-20T18:42:24.535747385Z","closed_at":"2026-01-20T18:42:24.535747385Z","close_reason":"complete-mfa API endpoint created"}
{"id":"coding-tool-nti","title":"E2E test gap: Critical path should test student code sync and public view","description":"## Problem\n\nThe current E2E tests don't cover the critical path of student code sync:\n1. Student modifies code in their editor\n2. Code is saved/synced to the server\n3. Instructor can view the student's code in real-time\n4. Code can be displayed on the public view\n\n## Test Scenario to Add\n\n1. Student logs in and navigates to their editor\n2. Student modifies code (types in the editor)\n3. Verify code is synced/saved\n4. Instructor views the student's code (should see the changes)\n5. Public view displays the student's code correctly\n\n## Files to Investigate\n\n- e2e/critical-paths.spec.ts - May be the right place to add this\n- e2e/public-view.spec.ts - Public view testing\n- e2e/helpers/ - Test utilities and setup","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:45:52.831880421Z","created_by":"Joe Delfino","updated_at":"2026-01-23T21:59:28.498058841Z","closed_at":"2026-01-23T21:59:28.498058841Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-nu9","title":"Add markdown support to problem display in activity tab","description":"## Problem\n\nThe problem display in the Activity tab of the code editor does not render markdown. Problem descriptions often contain:\n- Code snippets with backticks\n- Bold/italic formatting\n- Lists and bullet points\n- Headers\n\nThese display as raw markdown text instead of being rendered.\n\n## Proposed Solution\n\nAdd markdown rendering to the problem display component in the Activity tab. Use a markdown renderer (likely react-markdown or similar) to properly format problem descriptions.\n\n## Files to Investigate\n\n- src/app/ or src/components/ - Look for Activity tab / problem display component\n- Check what markdown libraries are already in use in the project","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:13:18.711409503Z","created_by":"Joe Delfino","updated_at":"2026-01-23T22:00:56.49731734Z","closed_at":"2026-01-23T22:00:56.49731734Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-o84b","title":"Instructor Session View Refactor","description":"Major refactor of the instructor session view to use panels instead of tabs.\n\n## Problem\n\n**Current state of src/app/instructor/page.tsx:**\n- 780+ lines monolith component\n- 28 useState hooks in one component\n- Session view uses tabs: Problem Setup, Student Code, AI Walkthrough\n- Can only see one thing at a time\n- Too much state in one component\n- No error boundaries - panel crash takes down entire page\n\n## Solution\n\nReplace tabs with collapsible right panels. Student list + code editor always visible.\n\n## New Layout\n\n```\n┌────┬───────────────────────────┬────────────────┐\n│ ≡  │ Students    │ Code Editor │ ▼ Problem      │\n│    │ ─────────── │             │   [title, desc │\n│ 📚 │ Alice    ●  │ def main(): │    starter]    │\n│ 🎯 │ Bob      ●  │   print()   ├────────────────┤\n│ 💡 │ Carol       │             │ ▼ AI Walk      │\n│    │             │             │   [summary]    │\n└────┴─────────────┴─────────────┴────────────────┘\n  ↑        ↑              ↑              ↑\n nav   student list   code editor   right panels\n(auto-   (always        (always      (collapsible)\ncollapsed) visible)      visible)\n```\n\n## Files to Create\n\n### src/app/instructor/components/SessionView.tsx\nMain session layout component. Responsibilities:\n- Render student pane (left) + right panel container\n- Coordinate panel visibility via PanelContext\n- Handle session-level actions (end session, etc.)\n- Wrap panels in error boundaries\n\n### src/app/instructor/components/SessionStudentPane.tsx\nStudent list + code editor combination:\n- Left side: StudentList component (existing)\n- Right side: Read-only CodeEditor showing selected student's code\n- Handles student selection state\n- Shows execution results\n\n### src/app/instructor/components/ProblemSetupPanel.tsx\nWrapper for SessionProblemEditor for right panel:\n- Uses Panel component from layout system\n- Contains SessionProblemEditor (existing)\n- Panel header: \"Problem Setup\"\n- Collapsed state shows problem title only\n\n## Changes to Existing Files\n\n### src/app/instructor/page.tsx\nSimplify dramatically:\n- Keep: View mode routing (classes → sections → sessions → session)\n- Keep: Session creation logic\n- Move: Session view rendering → SessionView.tsx\n- Move: Tab state → removed (panels replace tabs)\n- Target: \u003c 400 lines\n\n### src/app/instructor/components/WalkthroughPanel.tsx\nAdapt for right panel system:\n- Wrap in Panel component\n- Add collapsed state (shows summary only when collapsed)\n- Keep existing AI walkthrough functionality\n\n## Error Boundaries\n\n**Critical:** Each panel must have its own error boundary.\n\n```tsx\n// In SessionView.tsx\n\u003cRightPanelContainer\u003e\n  \u003cErrorBoundary fallback={\u003cPanelError title=\"Problem Setup\" /\u003e}\u003e\n    \u003cProblemSetupPanel /\u003e\n  \u003c/ErrorBoundary\u003e\n  \u003cErrorBoundary fallback={\u003cPanelError title=\"AI Walkthrough\" /\u003e}\u003e\n    \u003cWalkthroughPanel /\u003e\n  \u003c/ErrorBoundary\u003e\n\u003c/RightPanelContainer\u003e\n```\n\nIf ProblemSetupPanel throws, WalkthroughPanel and student pane still work.\n\n## Loading States\n\n### Panel Loading\nShow skeleton while panel data loads:\n```tsx\n\u003cPanel title=\"Problem Setup\" isLoading={!sessionProblem}\u003e\n  {sessionProblem ? \u003cSessionProblemEditor ... /\u003e : \u003cPanelSkeleton /\u003e}\n\u003c/Panel\u003e\n```\n\n### Student List Loading\nShow skeleton rows while students load from realtime subscription.\n\n## State Management\n\n### What stays in page.tsx\n- `viewMode` - which view to show (classes/sections/sessions/session)\n- `classContext`, `sessionContext` - navigation state\n- `sessionId` - current session ID\n- Session creation state (`isCreatingSession`)\n\n### What moves to SessionView.tsx\n- `selectedStudentId` - which student is selected\n- `selectedStudentCode` - code to display\n- `executionResult` - code execution output\n- `sessionProblem` - problem data\n- Modal states (`revisionViewerState`, `showProblemLoader`)\n\n### What's removed (replaced by PanelContext)\n- `sessionTab` - no more tabs, panels are always available\n\n## Realtime Integration\n\n`useRealtimeSession` hook stays at page.tsx level:\n- Manages WebSocket subscription\n- Provides students array, session data\n- Passed to SessionView as props\n\nDo NOT duplicate realtime logic in SessionView.\n\n## Benefits\n\n- See problem setup AND student code simultaneously\n- Collapsible panels save space when not needed\n- Component split reduces complexity (780 → ~400 lines in page.tsx)\n- Error isolation prevents cascade failures\n- Consistent with new panel system from z1ay.2\n\n## Testing\n\n- Unit tests for SessionStudentPane (student selection, code display)\n- Integration test for panel collapse/expand in session view\n- Error boundary tests (verify isolation)\n- E2E test: Start session → view student → collapse panel → expand panel","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:25:39.680760884Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.616098427Z","closed_at":"2026-01-22T03:44:40.000316553Z","close_reason":"Completed"}
{"id":"coding-tool-od9c","title":"Remove username field from codebase","description":"## Summary\nUsername was dropped as a concept but references remain throughout the codebase. Remove all username fields, replacing with email where needed for display/identification.\n\n## Files to modify\n\n### Database\n- `supabase/migrations/00001_initial_schema.sql` - Remove username column and index from user_profiles\n- `supabase/seed.sql` - Remove username from INSERT statements\n\n### Types\n- `src/server/auth/types.ts:101` - Remove `username: string` from User interface\n- `src/server/auth/interfaces.ts:36-64` - Remove username param from signUp, remove getUserByUsername method\n\n### Auth Providers\n- `src/server/auth/supabase-provider.ts` - Remove username from signUp, remove getUserByUsername\n- `src/server/auth/local/user-repository.ts` - Remove usernameIndex and getUserByUsername\n\n### Persistence\n- `src/server/persistence/supabase/user-repository.ts` - Remove username mapping and getUserByUsername\n- `src/server/persistence/supabase/membership-repository.ts` - Remove username from user joins\n\n### API Routes\n- `src/app/api/system/users/route.ts:45,79,91,94,96` - Remove username from response and validation\n- `src/app/api/system/users/[id]/route.ts:19,36,57,99` - Remove username handling\n- `src/app/api/system/namespaces/[id]/users/route.ts:69,86,96,132` - Remove username\n- `src/app/api/admin/instructors/route.ts:23,32-34,51` - Remove username\n- `src/app/api/admin/users/[id]/role/route.ts:83,86` - Remove username from logging\n- `src/app/api/admin/clear-data/route.ts:123` - Remove username from logging\n- `src/app/api/auth/register-student/route.ts:118-143,170-187,204` - Remove username from student registration\n\n### UI Components\n- `src/app/admin/page.tsx:116,120,163,221,437` - Remove username display and handling\n- `src/app/admin/components/UserList.tsx:13,21,26,70,82,119` - Remove username column\n- `src/app/admin/components/AddInstructorForm.tsx` - Entire file being removed (separate issue)\n- `src/app/system/namespaces/[id]/page.tsx:35,77-78,81-85,216-234,282,300-302,352` - Remove username\n\n### Tests\n- Update all test files with mock users to remove username field\n\n## Implementation notes\n- Where username was used for display, use email or displayName instead\n- getUserByUsername can be removed entirely (use getUserByEmail)\n- Database migration should drop the column (will need a new migration file)","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-20T22:15:59.744849843Z","created_by":"Joe Delfino","updated_at":"2026-01-21T00:44:14.945391542Z","closed_at":"2026-01-21T00:44:14.945391542Z","close_reason":"Completed in PR #13 - all CI checks passing"}
{"id":"coding-tool-oe1","title":"Mobile-friendly code editor for students","description":"## Summary\nMonaco Editor needs mobile-specific configuration. Students cannot effectively use the app on phones/tablets with current setup.\n\n## Problems\n- CodeEditor sidebar resizing uses desktop cursor interactions (`src/app/student/components/CodeEditor.tsx` lines 86-94)\n- Resize handles don't work on touch devices\n- Virtual keyboard covers input when editing\n- Layout doesn't adapt to portrait orientation\n\n## Implementation (Keep Monaco, configure for mobile)\n\n### 1. Detect mobile viewport\n```typescript\nconst isMobile = useMediaQuery('(max-width: 768px)');\n```\n\n### 2. Mobile Monaco configuration\n- Disable minimap\n- Increase font size (14px → 16px minimum for touch)\n- Disable line numbers on very small screens\n- Set wordWrap to 'on'\n\n### 3. Mobile layout changes\n- Stack code editor and output panel vertically (no side-by-side)\n- Remove drag-to-resize, use fixed 60/40 split or toggle buttons\n- Add explicit 'Show Output' / 'Show Code' toggle buttons\n- Ensure virtual keyboard doesn't cover active input\n\n### 4. Touch interactions\n- Remove mouse-based resize handles\n- Add swipe gesture or button to toggle between code/output views\n\n## Files to Modify\n- `src/app/student/components/CodeEditor.tsx` - Editor config and layout\n- `src/app/student/page.tsx` - Container layout\n- Consider creating `src/hooks/useMediaQuery.ts` if not exists\n\n## Testing\n- Test on iOS Safari and Android Chrome\n- Test with virtual keyboard open\n- Verify touch scrolling works in editor\n- Test portrait and landscape orientations","status":"open","priority":1,"issue_type":"task","created_at":"2026-01-15T03:57:52.61876618Z","created_by":"node","updated_at":"2026-01-15T03:58:18.274542969Z"}
{"id":"coding-tool-oqe3","title":"Refactor fragile DOM selectors in component tests","description":"Some component tests use fragile patterns that should be improved (lower priority - tests work but are brittle).\n\nFiles to refactor:\n- src/app/student/components/__tests__/CallStackPanel.test.tsx - uses frames[0], frames[2], frames[4] index-based selectors\n- src/app/student/components/__tests__/DebuggerPanel.test.tsx - similar fragile selectors\n- src/app/student/components/__tests__/CodeEditor-sidebar.test.tsx - tests localStorage key names directly\n- src/app/student/components/__tests__/EditorContainer.test.tsx - tests CSS flex properties\n\nRecommended changes:\n1. Add data-testid attributes to components\n2. Replace index-based selectors with data-testid queries\n3. Test behavior rather than implementation details (localStorage, CSS properties)\n\nThis is lower priority (P4) since tests currently work, just fragile.\n\nVerification:\n1. npm test -- should pass\n2. Tests are more maintainable and less likely to break on refactors","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-20T17:30:09.080028546Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.649781136Z"}
{"id":"coding-tool-p14","title":"Add variable inspector panel to debugger","description":"Display local and global variables and their values at each step of program execution. Shows variable changes as the user steps through code.\n\nFiles to modify:\n- src/student/components/VariableInspector.tsx - Variable display component (new file)\n- src/student/components/DebuggerPanel.tsx - Integrate variable inspector\n- src/hooks/useDebugger.ts - Expose current step variables\n\nImplementation steps:\n1. Create src/student/components/VariableInspector.tsx:\n   - Two collapsible sections: Local Variables and Global Variables\n   - Display variable name and value in table format\n   - Format values based on type (string, number, list, dict, etc.)\n   - Highlight variables that changed since previous step\n   - Truncate very long values with expand option\n   - Handle special values (None, True, False, functions, objects)\n   \n2. Integrate in DebuggerPanel.tsx:\n   - Add VariableInspector below navigation controls\n   - Pass current step's locals and globals\n   - Update on step navigation\n   \n3. Update useDebugger.ts:\n   - Expose getCurrentLocals() and getCurrentGlobals()\n   - Track previous step to detect changes\n\nUI Layout:\n┌─────────────────────────────────────┐\n│ Variables                           │\n├─────────────────────────────────────┤\n│ ▼ Local Variables                   │\n│ ┌─────────────────────────────────┐ │\n│ │ n        5                      │ │\n│ │ result   120  ← changed         │ │\n│ └─────────────────────────────────┘ │\n│ ▼ Global Variables                  │\n│ ┌─────────────────────────────────┐ │\n│ │ factorial  \u003cfunction\u003e           │ │\n│ └─────────────────────────────────┘ │\n└─────────────────────────────────────┘\n\nValue formatting examples:\n- Strings: 'hello' (with quotes)\n- Numbers: 42, 3.14\n- Lists: [1, 2, 3] or [1, 2, 3, ...] (truncated)\n- Dicts: {a: 1, b: 2} or {a: 1, ...} (truncated)\n- Functions: \u003cfunction factorial\u003e\n- None: None (italic/gray)\n- Objects: \u003cClassName instance\u003e\n\nVariable change indicators:\n- New variable: Green highlight\n- Changed value: Yellow highlight\n- Removed variable: Red strikethrough (if tracking deletions)\n\nEdge cases:\n- No variables (show empty state message)\n- Very long variable names (truncate with tooltip)\n- Very large values (truncate with expand/collapse)\n- Circular references (detect and show \u003ccircular\u003e)\n- Private/dunder variables (option to hide/show)\n- Many variables (virtualize list or make scrollable)\n- Complex objects (show simplified representation)\n\nDepends on: coding-tool-zv4 (debugger UI must exist first)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:06:12.544930205Z","updated_at":"2025-12-18T19:06:12.544930205Z"}
{"id":"coding-tool-p2q","title":"Sysadmin user management page redesign","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:41:27.499415917Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:42:08.344073013Z","closed_at":"2026-01-30T03:42:08.344073013Z","close_reason":"All subtasks complete, merged in PRs #43, #45, #47"}
{"id":"coding-tool-p2q.1","title":"Fix: user list shows 0 users due to missing namespace query param","description":"## Summary\n\nThe admin page (src/app/(app)/admin/page.tsx) does not pass the selected namespace as a query parameter when fetching users. The API's getNamespaceContext() defaults to 'default' namespace, so when a system-admin has any namespace selected, the user list returns 0 results.\n\n## Root cause\n\nThe loadUsers() function fetches /api/admin/users without appending the namespace query param. The page does not use useNamespaceQueryParam() or useSelectedNamespace() hooks.\n\n## Files to modify\n\n- src/app/(app)/admin/page.tsx (lines ~149-160)\n\n## Implementation steps\n\n1. Import and use useNamespaceQueryParam() from src/hooks/useSelectedNamespace.ts\n2. Append the namespace query param to all /api/admin/users fetch calls (lines ~149, ~159-160)\n3. Also fix the stats fetch (/api/admin/stats) to include the namespace param\n4. Ensure loadUsers and loadStats are re-called when the selected namespace changes\n\n## Expected behavior\n\n- System-admin with default namespace: sees users in default namespace\n- System-admin with another namespace selected: sees users in that namespace\n- Non-admin users: unchanged (namespace comes from user.namespaceId)","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:42:26.238263125Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:47:43.057090841Z","closed_at":"2026-01-29T22:47:43.057090841Z","close_reason":"Implemented in cf77c5e","labels":["wip"]}
{"id":"coding-tool-p2q.2","title":"Add 'All Namespaces' option to namespace dropdown","description":"## Summary\n\nThe namespace dropdown in NamespaceHeader currently only lists individual namespaces. Add an 'All Namespaces' option so system-admins can view aggregate user data across all namespaces.\n\n## Files to modify\n\n- src/components/NamespaceHeader.tsx — add 'All Namespaces' as first option in the dropdown\n- src/hooks/useSelectedNamespace.ts — handle the 'all' sentinel value\n- src/app/api/admin/users/route.ts — when no namespace param (or 'all'), skip namespace filtering for system-admins\n- src/app/api/admin/stats/route.ts — return aggregate stats when 'all' is selected\n- src/server/persistence/supabase/user-repository.ts — listUsers() should allow namespaceId to be undefined to skip that filter\n\n## Implementation steps\n\n1. In NamespaceHeader.tsx, add 'All Namespaces' option at top of dropdown with a sentinel value\n2. Update useSelectedNamespace to return null when 'All Namespaces' is selected\n3. Update useNamespaceQueryParam to return empty string for 'all'\n4. Update API routes to skip namespace filtering for system-admins when no namespace param\n5. Update listUsers() to not filter by namespace when namespaceId is omitted","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:42:31.206053044Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:55:23.093729637Z","closed_at":"2026-01-29T22:55:23.093729637Z","close_reason":"Implemented in 0cb3756","labels":["wip"]}
{"id":"coding-tool-p2q.3","title":"Remove Overview tab, replace with inline overview panel","description":"## Summary\n\nThe current 'Overview' tab sits below the namespace dropdown, creating a confusing layout. Remove the Overview tab entirely and replace it with an always-visible overview stats panel between the namespace dropdown and the user list tabs.\n\n## Files to modify\n\n- src/app/(app)/admin/page.tsx\n\n## Implementation steps\n\n1. Remove the 'Overview' tab from the tab list and its tab panel\n2. Move the overview stats (Total Users, Classes, Sections, Active Sessions cards) out of the tab system\n3. Place the stats cards as an always-visible panel between the namespace dropdown and the user list tabs\n4. The stats should reflect the currently selected namespace scope (single namespace or 'All Namespaces')\n5. Keep remaining tabs: All Users, Instructors, Students\n6. Update default tab for system-admins from 'Overview' (index 0) to 'All Users'\n7. Remove tab index logic that forces non-admins away from the Overview tab","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T22:42:31.259737211Z","created_by":"Joe Delfino","updated_at":"2026-01-29T22:58:26.6865535Z","closed_at":"2026-01-29T22:58:26.6865535Z","close_reason":"Implemented in 8d2793a","labels":["wip"]}
{"id":"coding-tool-p2q.4","title":"Show email column in All Users table on admin page","description":"## Summary\n\nThe 'All Users' tab in admin/page.tsx uses an inline table (lines 341-388) that only shows `displayName || email` in a single column. It should show both display name and email as separate columns, consistent with the UserList component used by the Instructors/Students tabs which already has both columns.\n\n## Files to modify\n\n- src/app/(app)/admin/page.tsx — The inline All Users table (lines 341-388). Either add an Email column to match UserList, or replace the inline table with the UserList component (which already shows email). Using UserList would reduce duplication.\n\n## Implementation steps\n\n1. Replace the inline table in the 'users' tab panel with the UserList component\n2. Add role-change action support to UserList (or keep the role dropdown inline)\n3. Alternatively, just add an Email column to the existing inline table","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:05:03.484236345Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:09:53.188106548Z","closed_at":"2026-01-30T03:09:53.188106548Z","close_reason":"Implemented in 6d8f442","labels":["wip"]}
{"id":"coding-tool-p2q.5","title":"Add Namespace Admins tab to admin page","description":"## Summary\n\nNamespace admins are currently mixed in with all users in the 'All Users' tab. They should have their own dedicated tab so system-admins can easily see and manage namespace admins separately.\n\n## Files to modify\n\n- src/app/(app)/admin/page.tsx\n\n## Implementation steps\n\n1. Add a `namespaceAdmins` state array, filtered from allUsers where role === 'namespace-admin'\n2. Add a 'Namespace Admins' tab between 'All Users' and 'Instructors'\n3. Use UserList component for the tab panel content with showActions=true\n4. Include invitation UI if relevant, or just the user list","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:05:03.538922803Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:09:53.328513507Z","closed_at":"2026-01-30T03:09:53.328513507Z","close_reason":"Implemented in 28372fc","labels":["wip"]}
{"id":"coding-tool-p2q.6","title":"Fix stats cards showing wrong data for selected namespace","description":"## Summary\n\nThe overview stats cards (Classes, Sections, Active Sessions) show global counts even when a specific namespace is selected. Only the Users count is namespace-filtered. The stats API route at src/app/api/admin/stats/route.ts calls `sectionRepo.listSections()` and `storage.sessions.countSessions()` without passing the namespace filter.\n\n## Root cause\n\nIn src/app/api/admin/stats/route.ts:\n- Line 47: `sectionRepo.listSections()` — no namespace filter\n- Line 50: `storage.sessions.countSessions()` — no namespace filter\n- Only user listing (lines 37-39) respects the namespace\n\n## Files to modify\n\n- src/app/api/admin/stats/route.ts — pass namespaceId to section/session queries\n- Possibly src/server/persistence/ repos — check if listSections and countSessions support namespace filtering; add it if not\n\n## Implementation steps\n\n1. Check if `listSections()` accepts a namespace filter; if not, add one or filter results\n2. Check if `countSessions()` accepts a namespace filter; if not, add one or filter results\n3. Pass `namespaceId` to these calls in the stats route\n4. When namespaceId is undefined (all namespaces), keep current unfiltered behavior","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:05:03.58068772Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:09:53.460500507Z","closed_at":"2026-01-30T03:09:53.460500507Z","close_reason":"Implemented in a29e650","labels":["wip"]}
{"id":"coding-tool-p2q.7","title":"Fix: Email not shown in All Users table and possibly missing from API response","description":"## Summary\n\nTwo issues causing emails not to appear:\n\n1. The All Users inline table in src/app/(app)/admin/page.tsx (lines 341-388) has no Email column. It only shows Username (displayName || email), Role, Created, Actions. An Email column needs to be added.\n\n2. The email field may not be populated in the API response. The user_profiles table/view needs to include email from auth.users. Check if `mapRowToUser` in src/server/persistence/supabase/user-repository.ts correctly maps email, and whether the `user_profiles` table/view includes the email column.\n\n## Files to modify\n\n- src/app/(app)/admin/page.tsx — Add Email column to the All Users inline table (between Username and Role columns)\n- src/server/persistence/supabase/user-repository.ts — Verify email is present in query results; if user_profiles doesn't have email, may need to join with auth.users or adjust the view\n\n## Implementation steps\n\n1. Check if user_profiles includes email (check SQL migrations/schema)\n2. If email is missing from user_profiles results, fix the query or view\n3. Add Email column to the All Users inline table in page.tsx\n4. Test that email appears in all three user lists (All Users, Instructors, Students)","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:23:08.719464097Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:30:27.3991463Z","closed_at":"2026-01-30T03:30:27.3991463Z","close_reason":"Implemented in 609fbe2","labels":["wip"]}
{"id":"coding-tool-p2q.8","title":"Fix: Namespace filtering race condition on page load","description":"## Summary\n\nuseSelectedNamespace hook initializes state to null, then reads localStorage in a useEffect (async). The admin page useEffect fires immediately with null selectedNamespace (no namespace param = fetch ALL data), then fires again when localStorage resolves. If the first unfiltered response arrives after the second filtered response, stale all-namespace data overwrites correct namespace-filtered data.\n\n## Root cause\n\nIn src/hooks/useSelectedNamespace.ts:\n- Line 14: `useState\u003cstring | null\u003e(null)` — initial state is null\n- Line 16-33: useEffect reads from localStorage (runs after first render)\n\nIn src/app/(app)/admin/page.tsx:\n- Line 204-208: useEffect depends on `selectedNamespace`, fires with null on first render\n\nThis creates a race: fetch1(no namespace) and fetch2(correct namespace) — whichever returns last wins.\n\n## Fix\n\nInitialize useSelectedNamespace synchronously from localStorage since localStorage.getItem is synchronous. Change from useEffect + useState to a synchronous initialization:\n\n```typescript\nconst getInitialNamespace = (user: User | null): string | null =\u003e {\n  if (\\!user) return null;\n  if (user.role === 'system-admin') {\n    const saved = localStorage.getItem('selectedNamespaceId');\n    if (saved === 'all') return null;\n    return saved || user.namespaceId || 'default';\n  }\n  return user.namespaceId;\n};\n```\n\nOr use a loading/unresolved sentinel so the page doesn't fetch until namespace is known.\n\n## Files to modify\n\n- src/hooks/useSelectedNamespace.ts — Initialize synchronously from localStorage instead of via useEffect","status":"closed","priority":0,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:23:08.771023514Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:30:27.510147842Z","closed_at":"2026-01-30T03:30:27.510147842Z","close_reason":"Implemented in d514e90","labels":["wip"]}
{"id":"coding-tool-p39","title":"Add API contract tests for repository interface methods","description":"Bug: API route called getSectionMemberships() which doesn't exist. Should be getSectionMembers().\n\nTest Gap: No tests verify repository implementations match their interfaces.\n\nRequired Tests:\n1. Contract tests for IMembershipRepository interface\n   - Verify all methods in interface exist in implementation\n   - Verify method signatures match (parameters, return types)\n   - Test getSectionMembers() with role filtering\n   \n2. Contract tests for ISectionRepository interface\n   - Verify instructorIds field exists and is used\n   - Test section authorization patterns\n   \n3. Integration tests for API routes using repositories\n   - Verify correct method names called\n   - Verify return types match expectations\n\nFiles to create/update:\n- src/server/classes/__tests__/repository-contracts.test.ts\n- Update existing route tests to verify method calls\n\nTest Pattern:\n```typescript\ndescribe('MembershipRepository contract', () =\u003e {\n  it('implements all IMembershipRepository methods', () =\u003e {\n    const repo = new MembershipRepository();\n    expect(repo.getSectionMembers).toBeDefined();\n    expect(repo.getSectionMemberships).toBeUndefined(); // Should NOT exist\n  });\n});\n```\n\nAcceptance Criteria:\n- Test fails if method name typos occur\n- Test fails if interface methods missing from implementation\n- Test verifies getSectionMembers signature: (sectionId, role?) =\u003e Promise\u003cUser[]\u003e\n- TypeScript compilation catches interface violations","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-20T00:59:48.518704645Z","updated_at":"2026-01-23T14:57:24.765574971Z","closed_at":"2026-01-23T14:57:24.765574971Z","close_reason":"Obsolete - TypeScript's 'implements' keyword already enforces interface compliance at compile time. The original bug was fixed and all repositories properly implement their interfaces."}
{"id":"coding-tool-p86","title":"Add markdown support to problem display in activity tab","description":"## Problem\n\nThe problem display in the Activity tab of the code editor does not render markdown. Problem descriptions often contain:\n- Code snippets with backticks\n- Bold/italic formatting\n- Lists and bullet points\n- Headers\n\nThese display as raw markdown text instead of being rendered.\n\n## Proposed Solution\n\nAdd markdown rendering to the problem display component in the Activity tab. Use a markdown renderer (likely react-markdown or similar) to properly format problem descriptions.\n\n## Files to Investigate\n\n- src/app/ or src/components/ - Look for Activity tab / problem display component\n- Check what markdown libraries are already in use in the project","status":"closed","priority":1,"issue_type":"feature","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:13:18.711409503Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.333327333Z","closed_at":"2026-01-23T22:00:56.49731734Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-pfj","title":"Add terms of service and privacy policy pages","description":"## Summary\nAdd simple Terms of Service and Privacy Policy pages for public release. These are standard legal requirements for any public-facing web application.\n\n## Files to Create\n- `src/app/terms/page.tsx` - Terms of Service page\n- `src/app/privacy/page.tsx` - Privacy Policy page\n\n## Implementation Steps\n\n1. **Create Terms of Service page** (`src/app/terms/page.tsx`):\n   - Simple static page with basic terms\n   - Include: service description, acceptable use, limitations of liability\n   - Link to privacy policy\n   - Use existing page layout patterns from the codebase\n\n2. **Create Privacy Policy page** (`src/app/privacy/page.tsx`):\n   - Describe data collected: email, code submissions, session participation\n   - Explain data usage: educational purposes, no third-party sharing\n   - Mention cookies (Supabase auth session cookies)\n   - Contact information for data questions\n\n3. **Add footer links**:\n   - Add links to Terms and Privacy in the app footer/layout\n   - Ensure links are visible on public-facing pages (login, register)\n\n4. **Registration page update**:\n   - Add checkbox or text indicating agreement to terms during registration\n   - Example: \"By registering, you agree to our Terms of Service and Privacy Policy\"\n\n## Notes\n- Keep language simple and readable\n- These are placeholder pages - should be reviewed by legal counsel before actual public release\n- Consider adding last-updated date to both pages","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-15T03:48:56.436725417Z","created_by":"node","updated_at":"2026-01-20T17:03:29.480847125Z","closed_at":"2026-01-20T17:03:29.480847125Z","close_reason":"Implemented: Complete ToS (12 sections) and Privacy Policy (11 sections) pages at /terms and /privacy with tests"}
{"id":"coding-tool-qsk","title":"Create InstructorDashboard component","description":"Create src/app/(app)/instructor/components/InstructorDashboard.tsx\n\nThis is the new default view for /instructor - a table of classes/sections with session controls.\n\nFeatures:\n- Fetch classes/sections via useClasses hook\n- Render table: class name, section, semester, student count, status\n- Check for active sessions per section\n- Render 'Start Session' or 'Rejoin Session' button per row\n- 'Create Class' button at top\n- 'Edit' button per row linking to /classes/[id]\n- Highlight rows with active sessions\n- Import and use StartSessionModal from coding-tool-ia78.3\n\nUse hasPermission() with new permissions from coding-tool-ia78.1 to gate buttons.\n\n**Testing:** Add unit tests in src/app/(app)/instructor/components/__tests__/InstructorDashboard.test.tsx","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:35:39.455527176Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.354283208Z","closed_at":"2026-01-23T00:04:28.853598257Z","close_reason":"Added InstructorDashboard component and dashboard API"}
{"id":"coding-tool-rv8","title":"Complete e2e test fixes for responsive layout","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-28T18:48:53.777077415Z","updated_at":"2025-12-28T18:48:53.777077415Z"}
{"id":"coding-tool-rwh","title":"Role-Based Access Control (RBAC) Improvements","description":"Improve role-based access control system to support multi-tenancy, proper permission scoping, and administrative capabilities.\n\n**Current State:**\n- Two roles: instructor and student\n- Instructors can create classes/sections/sessions\n- No system administrator role\n- Permission boundaries not clearly enforced\n- Potential for instructors to access other instructors' data\n\n**Goals:**\n1. Add system administrator role\n2. Enforce strict permission boundaries for instructors\n3. Ensure data isolation between instructors\n4. Admin capabilities for user management\n5. Audit logging for permission changes\n\n**Benefits:**\n- Secure multi-tenant operation\n- Self-service user elevation to instructor\n- Clear permission model\n- Production-ready access control\n- Easier to add future roles (TA, observer, etc.)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-20T03:28:02.544075199Z","updated_at":"2026-01-23T14:54:14.047954091Z","closed_at":"2026-01-23T14:54:14.047954091Z","close_reason":"Completed - RBAC with system-admin, namespace-admin, instructor, student roles implemented in rbac.ts. Admin dashboard with user management at /admin. All subtasks complete."}
{"id":"coding-tool-rwh.2","title":"Scope instructor permissions to their own classes/sections only","description":"Ensure instructors can only view/modify their own classes, sections, and students. Prevent cross-instructor data access.\n\n**Problem:**\nCurrent authorization checks are incomplete. During this session we found:\n- Section API checked instructorIds but not consistently\n- WebSocket handlers missing instructor ownership validation\n- No tests for cross-instructor access attempts\n\n**Security Risk:**\nWithout proper scoping, instructors could potentially:\n- View other instructors' classes/sections\n- Modify sections they don't own\n- Access student data from other sections\n- Join/manage sessions from other instructors\n\n**Solution:**\nAudit all API endpoints and add ownership validation for instructor role.\n\n**Implementation:**\n\n1. Audit API routes (check ownership before returning data):\n   - GET /api/classes - Filter to instructor's classes only\n   - GET /api/classes/[id] - Verify instructor owns class\n   - PUT /api/classes/[id] - Verify instructor owns class\n   - DELETE /api/classes/[id] - Verify instructor owns class\n   - GET /api/classes/[id]/sections - Verify instructor owns class\n   - POST /api/classes/[id]/sections - Verify instructor owns class\n   - GET /api/sections/[id] - Verify instructor in section.instructorIds\n   - PUT /api/sections/[id] - Verify instructor in section.instructorIds\n   - DELETE /api/sections/[id] - Verify instructor in section.instructorIds\n   - GET /api/sections/[id]/sessions - Verify instructor in section.instructorIds\n   - POST /api/sections/[id]/sessions - Verify instructor in section.instructorIds\n\n2. Audit WebSocket handlers (already partially fixed):\n   - handleCreateSession ✅ (checks section.instructorIds)\n   - handleJoinExistingSession ✅ (checks section.instructorIds)\n   - handleLeaveSession - Verify session ownership\n   - handleEndSession - Verify session ownership\n   - handleUpdateCode - Verify session ownership\n   - Any other session operations\n\n3. Create middleware helper src/server/auth/ownership.ts:\n   \n\n4. Add authorization tests:\n   - Instructor A cannot access Instructor B's classes\n   - Instructor A cannot modify Instructor B's sections\n   - Instructor A cannot join Instructor B's sessions\n   - API returns 403 Forbidden (not 404) for unauthorized access\n   - Student cannot access instructor-only routes\n\n**Current Authorization Pattern:**\n\n\n**Files to audit/modify:**\n- src/app/api/classes/route.ts - Filter by ownership\n- src/app/api/classes/[id]/route.ts - Add ownership check\n- src/app/api/classes/[id]/sections/route.ts - Already fixed\n- src/app/api/sections/[id]/route.ts - Add ownership check\n- src/app/api/sections/[id]/sessions/route.ts - Already fixed\n- src/server/websocket-handler.ts - Audit all handlers\n- src/server/auth/ownership.ts - New helper module\n\n**Testing Strategy:**\nCreate test fixtures:\n- Instructor A with Class A, Section A\n- Instructor B with Class B, Section B\n- Student C enrolled in Section A\n\nTest matrix:\n- Instructor A ✅ can access Class A\n- Instructor A ❌ cannot access Class B (403)\n- Instructor B ✅ can access Section B\n- Instructor B ❌ cannot access Section A (403)\n- Student C ✅ can view Section A (read-only)\n- Student C ❌ cannot modify Section A (403)\n\n**Acceptance Criteria:**\n- [ ] All API routes validate ownership for instructor role\n- [ ] All WebSocket handlers validate ownership\n- [ ] Helper functions available for consistent checks\n- [ ] 403 errors returned for unauthorized access\n- [ ] Tests cover cross-instructor access attempts\n- [ ] Documentation of permission model updated\n\n**Reference:**\nThis issue discovered through bugs fixed in this session:\n- commit: 'Fix: Allow instructors to rejoin their own sessions'\n- Pattern established: Check section.instructorIds array for instructors","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-20T03:30:22.595149868Z","updated_at":"2026-01-20T17:01:16.369343133Z","closed_at":"2026-01-20T17:01:16.369343133Z","close_reason":"Implemented: instructorIds checks in section and session API routes"}
{"id":"coding-tool-rwh.3","title":"System administrator dashboard with account and activity overview","description":"Create comprehensive system administrator dashboard that provides visibility into all accounts, classes, sections, and sessions with integrated user management.\n\n**Purpose:**\nGive system administrators a bird's-eye view of the entire platform with the ability to manage users - all in one unified interface.\n\n**Dashboard Layout:**\n\n┌─────────────────────────────────────────────────┐\n│ System Overview                                 │\n├─────────────────────────────────────────────────┤\n│ 👥 Users: 142  (15 instructors, 127 students)  │\n│ 📚 Classes: 23                                  │\n│ 📖 Sections: 67                                 │\n│ 🔴 Active Sessions: 8                           │\n└─────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────┐\n│ User Management                                 │\n│ [Search: _____] [Role: All ▼] [Sort: Email ▼]  │\n├─────────────────────────────────────────────────┤\n│ Email            Role        Created    Actions │\n│ alice@edu        instructor  2024-09-15 [↓ Demote] [Details] │\n│ bob@edu          student     2024-09-20 [↑ Make Instructor] │\n│ admin@edu        admin       2024-08-01 [Details] │\n└─────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────┐\n│ Classes \u0026 Sections                              │\n│ [Search: _____] [Instructor: All ▼]             │\n├─────────────────────────────────────────────────┤\n│ Class                Sections  Students  Active │\n│ CS101 - Intro        3         67       2 live │\n│ CS201 - Data Struct  2         45       0      │\n└─────────────────────────────────────────────────┘\n\n┌─────────────────────────────────────────────────┐\n│ Active Sessions (Right Now)                     │\n├─────────────────────────────────────────────────┤\n│ Section      Instructor    Students  Started   │\n│ CS101-A      alice@edu     12       3m ago     │\n│ CS201-B      bob@edu       8        15m ago    │\n└─────────────────────────────────────────────────┘\n\n**Implementation:**\n\n1. Create src/app/admin/page.tsx (shared with rwh.1):\n   - System overview cards with counts\n   - User management table with role elevation actions (from rwh.1)\n   - Classes/sections summary\n   - Active sessions live view\n   - Auto-refresh every 30s for active sessions\n\n2. Add API routes:\n   - GET /api/admin/stats - System-wide statistics\n   - GET /api/admin/users - All users with filtering/sorting (shared with rwh.1)\n   - GET /api/admin/classes - All classes with section/student counts\n   - GET /api/admin/sessions/active - Currently running sessions\n\n3. Query optimizations:\n   - Use aggregation queries for counts\n   - Don't load full session history (just active)\n   - Paginate accounts table (50 per page)\n   - Cache stats for 1 minute\n\n4. Real-time updates:\n   - WebSocket subscription for active sessions\n   - Show/hide sessions as they start/end\n   - Update participant counts live\n\n**Data Requirements:**\n\nUser table columns:\n- Email, Name, Role, Created Date, Last Login\n- Total sessions attended/hosted\n- Classes enrolled/teaching\n- Actions: Elevate/demote role (from rwh.1), View details\n\nClasses table columns:\n- Class name, Instructor(s), Section count\n- Total enrolled students, Active sessions\n- Created date, Last session\n\nActive sessions:\n- Section name, Class name, Instructor\n- Current participants, Join code\n- Duration (started X ago)\n- Actions: View (join as observer?)\n\n**Security:**\n- All routes require admin role (requireAdmin middleware from rwh.1)\n- User management actions integrated with audit logging\n\n**Files to create:**\n- src/app/admin/page.tsx - Unified dashboard (shared with rwh.1)\n- src/app/api/admin/stats/route.ts - System statistics\n- src/app/api/admin/users/route.ts - User listing with filters (shared with rwh.1)\n- src/app/api/admin/classes/route.ts - Class/section overview\n- src/app/api/admin/sessions/active/route.ts - Live sessions\n\n**Performance Considerations:**\n- Add database indexes on user.role, user.createdAt\n- Use COUNT() queries instead of fetching all records\n- Implement pagination for large datasets\n- Consider Redis cache for stats (1min TTL)\n\n**Future Enhancements:**\n- Export to CSV (accounts, classes, sessions)\n- Usage graphs (sessions over time, peak hours)\n- Audit log viewer (from rwh.1)\n- Student progress analytics\n- System health metrics\n\n**Acceptance Criteria:**\n- [ ] Dashboard shows accurate system-wide counts\n- [ ] User table sortable by email, role, created date\n- [ ] User filterable by role\n- [ ] Role elevation actions work inline (from rwh.1)\n- [ ] Classes list shows section and student counts\n- [ ] Active sessions update in real-time\n- [ ] Dashboard loads in \u003c 2 seconds\n- [ ] Only admin role can access\n- [ ] Mobile-responsive layout\n\n**Dependencies:**\n- Shares implementation with coding-tool-rwh.1 (user management)\n- Requires requireAdmin() middleware from rwh.1\n\n**Testing:**\n- Admin can access dashboard\n- Non-admin gets 403\n- Stats match actual database counts\n- Filters and sorting work correctly\n- Active sessions appear/disappear as they start/end\n- Performance under 1000+ users\n\n**Note:**\nThis ticket shares src/app/admin/page.tsx with rwh.1. The dashboard provides both visibility (this ticket) and user management actions (rwh.1) in a single unified interface.","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-20T03:31:44.033741031Z","updated_at":"2026-01-23T14:54:08.553245297Z","closed_at":"2026-01-23T14:54:08.553245297Z","close_reason":"Completed - admin dashboard exists at src/app/(app)/admin/page.tsx with overview stats, user management, role changes, invitations. Minor nice-to-haves (classes table, live sessions) can be separate tickets if needed."}
{"id":"coding-tool-rws","title":"Improve connection status UX with actionable guidance","description":"## Summary\nUsers see connection states ('connecting', 'disconnected') but don't know what to do about them.\n\n## Current State\n`src/app/student/page.tsx` (lines 296-299) shows 4 states:\n- connected (green dot)\n- connecting (yellow dot)\n- disconnected (red dot)  \n- failed (red dot)\n\nNo guidance on what user should do in each state.\n\n## Implementation\n\n### 1. Add descriptive messages for each state\n```\nconnected: '● Connected' (current - fine)\nconnecting: '○ Connecting...' + 'Please wait, establishing connection'\ndisconnected: '● Disconnected' + 'Attempting to reconnect...' or 'Click to reconnect'\nfailed: '● Connection failed' + 'Check your internet connection. [Retry button]'\n```\n\n### 2. Add automatic reconnection indicator\nWhen reconnecting, show attempt count: 'Reconnecting (attempt 2 of 5)...'\n\n### 3. Add manual reconnect button\nFor 'failed' state, show explicit 'Reconnect' button\n\n### 4. Timeout message\nIf connecting takes \u003e 10 seconds: 'Taking longer than expected. Check your connection.'\n\n## Files to Modify\n- `src/app/student/page.tsx` - Connection status display\n- Consider extracting to `src/components/ConnectionStatus.tsx` for reuse","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-15T03:58:28.545091085Z","created_by":"node","updated_at":"2026-01-15T03:58:28.545091085Z"}
{"id":"coding-tool-s35","title":"Unify connection state - use isBroadcastConnected everywhere","description":"## Summary\n\nCurrently there are two connection states causing confusion:\n- `isConnected` - from useRealtime (postgres_changes channel)\n- `isBroadcastConnected` - from broadcast channel subscription\n\nThe student page shows `isConnected` in the UI but uses `isBroadcastConnected` to control polling. This causes the bug where UI shows \"connected\" but the page is polling.\n\nAfter migration, there should be ONE connection state based on the broadcast channel.\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts`\n   - Remove `isConnected` from useRealtime destructuring (if useRealtime is kept)\n   - Rename `isBroadcastConnected` to `isConnected` (or keep both but derive from same source)\n   - Update return value to only expose one connection state\n\n2. `src/app/(fullscreen)/student/page.tsx`\n   - Verify it uses the correct (broadcast-based) connection state\n   - Lines 49, 203, 244 reference `isConnected`\n\n3. `src/app/(app)/instructor/session/[id]/page.tsx`\n   - Update any connection state references\n\n## Current Problem (student/page.tsx)\n\n```typescript\n// Line 49 - destructures isConnected (from postgres_changes)\nconst { isConnected, ... } = useRealtimeSession({...});\n\n// Line 203 - UI shows postgres_changes state\nif (!isConnected) { /* show disconnected */ }\n\n// But useRealtimeSession.ts line 290 uses isBroadcastConnected for polling:\nif (!sessionId || isBroadcastConnected || loading) return;\n// ^ polling only stops when BROADCAST is connected\n```\n\n## Expected After Fix\n\n- Single `isConnected` state derived from broadcast channel\n- UI accurately reflects whether realtime updates are working\n- No polling when broadcast is connected\n- Polling fallback when broadcast disconnects\n\n## Testing\n\n1. Update `src/hooks/__tests__/useRealtimeSession.test.ts`:\n   - Test that `isConnected` reflects broadcast channel state\n   - Test that polling activates when `isConnected` is false\n   - Test that polling stops when `isConnected` is true\n\n2. Update `src/app/(fullscreen)/student/__tests__/page-session-ended.test.tsx`:\n   - Update mock to use unified connection state\n   - Line 72 currently mocks `isConnected: true`\n\n3. Update `src/app/(app)/instructor/session/[id]/__tests__/page.test.tsx`:\n   - Update useRealtimeSession mock to reflect new return values\n\n## Dependencies\n\n- Depends on coding-tool-yut.3 (postgres_changes removal must happen first so there's only one channel to track)\n\n## Notes\n\n- This task may be partially or fully addressed during task 3 or 4\n- The key is ensuring the UI connection indicator matches the actual realtime mechanism","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:17:40.653443214Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.335948875Z","closed_at":"2026-01-25T17:53:52.051325802Z","close_reason":"Already completed in task 4 (commit 3428caa)","labels":["approved"]}
{"id":"coding-tool-s3jz","title":"Navigation \u0026 Layout Overhaul","description":"Comprehensive navigation and layout overhaul for the app.\n\n## Problems\n\n### Navigation Issues\n- **No global navigation:** Each page implements its own header/sign-out (duplicated 4+ times)\n- **Disconnected pages:** Student session has no back nav to sections; admin areas not linked from main nav\n- **Inconsistent patterns:** Mix of URL params (`?view=`), state tabs, `router.push`, `\u003cLink\u003e` components\n- **No role-aware menu:** Users can't discover available areas based on their role\n\n### Instructor Session View Issues\n- **780-line monolith:** `src/app/instructor/page.tsx` has 28 useState hooks\n- **Tab-based UI:** 3 tabs (Problem Setup, Student Code, AI Walkthrough) - can only see one at a time\n- **No error isolation:** If one panel throws, entire page crashes\n- **State management sprawl:** All session state crammed into one component\n\n## Solution\n\n### Unified Panel-Based Layout System\n\n```\n┌─────────────────────────────────────────────────────────┐\n│  Global Header (logo, session banner, user menu)        │\n├────┬────────────────────────────────┬───────────────────┤\n│    │                                │ [Right Panels]    │\n│ S  │   Main Content Area            │ Contextual tools  │\n│ I  │                                │ (collapsible)     │\n│ D  │                                │                   │\n│ E  │                                │                   │\n│ B  │                                │                   │\n│ A  │                                │                   │\n│ R  │                                │                   │\n└────┴────────────────────────────────┴───────────────────┘\n```\n\n- **Left sidebar:** Global navigation, collapsible to icon rail, role-filtered items\n- **Main content:** Page content\n- **Right panels:** Contextual tools (session view only), collapsible, persist state\n\n### Key Design Decisions\n\n1. **Panels replace tabs:** Instructor can see problem setup AND student code simultaneously\n2. **Route groups:** `(public)`, `(app)`, `(fullscreen)` for layout inheritance\n3. **Context placement:** ActiveSessionProvider and PanelProvider in `(app)/layout.tsx`, NOT root\n4. **State separation:** ActiveSessionContext (lightweight banner data) vs useRealtimeSession (full session data)\n\n## Architecture\n\n### Component Hierarchy\n```\nsrc/app/layout.tsx                    # AuthProvider only\n├── (public)/layout.tsx               # Minimal wrapper\n├── (app)/layout.tsx                  # AppShell + providers\n│   └── AppShell\n│       ├── GlobalHeader\n│       │   ├── ActiveSessionBanner\n│       │   └── UserMenu\n│       ├── Sidebar (collapsible)\n│       ├── Main Content (slot)\n│       └── RightPanelContainer\n│           └── Panel (generic, collapsible)\n└── (fullscreen)/layout.tsx           # AppShell with sidebar collapsed\n```\n\n### Key Files\n- `src/config/navigation.ts` - NavItem definitions, role filtering\n- `src/config/panels.ts` - PanelConfig definitions\n- `src/contexts/ActiveSessionContext.tsx` - Lightweight session indicator\n- `src/contexts/PanelContext.tsx` - Panel visibility state\n- `src/components/layout/` - All layout components\n\n## Subtask Dependency Chain\n\n```\nz1ay.1 (Config)\n    ↓\nz1ay.2 (Components) ← Uses types from z1ay.1\n    ↓\nz1ay.3 (Route Groups) ← Uses AppShell from z1ay.2\n    ↓\nz1ay.4 (Page Cleanup) ← Needs layouts from z1ay.3\n    ↓\nz1ay.5 (Session Refactor) ← Needs Panel from z1ay.2 + cleaned pages from z1ay.4\n```\n\n## Specifications\n\n### Panel Dimensions\n- Right panel container: 320px wide (fixed)\n- Collapsed panel: 40px tall (header only)\n- Animation: 200ms ease-in-out\n- Mobile (\u003c1024px): Panels in bottom sheet\n\n### Sidebar Dimensions\n- Expanded: w-64 (256px)\n- Collapsed: w-16 (64px) icon rail\n- Mobile: Hidden, hamburger opens drawer\n\n### localStorage Keys\n- `coding-tool:active-session` - Session indicator state\n- `coding-tool:panel-state:{pageId}` - Panel visibility per page\n- `coding-tool:sidebar-collapsed` - Sidebar collapse state\n\n## Verification\n\n### Navigation Tests\n1. Sign in as student → see only \"My Sections\" in sidebar\n2. Sign in as instructor → see Dashboard, Classes, Sessions, Problems\n3. Sign in as namespace-admin → see instructor items + User Management\n4. Sign in as system-admin → see Namespaces\n\n### Session Flow Tests\n1. Start session → green \"Active Session\" banner appears\n2. Navigate away → banner persists\n3. Click banner → return to session\n4. End session → banner disappears\n\n### Panel Tests\n1. Enter session view → Problem Setup and AI Walkthrough panels visible\n2. Click panel header → panel collapses to header only\n3. Click again → panel expands\n4. Refresh → panel state persists\n5. Panel error → other panels still work (error boundary)\n\n### Mobile Tests\n1. Resize \u003c 1024px → sidebar becomes hamburger menu\n2. Tap hamburger → drawer slides in\n3. Right panels → accessible via \"Tools\" bottom sheet\n\n## Plan Files\n- Original plan: /home/node/.claude/plans/buzzing-chasing-brooks.md\n- Audit/critique: /home/node/.claude/plans/drifting-hugging-leaf.md","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:23:57.670867378Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:48:17.459842505Z","closed_at":"2026-01-23T05:48:17.459842505Z","close_reason":"Completed in commit dfb35a4 (feat: Navigation \u0026 Layout Overhaul #16)"}
{"id":"coding-tool-s9a","title":"Add broadcast subscriptions to useRealtimeSession for missing events","description":"## Summary\n\n`useRealtimeSession` currently only subscribes to `student_joined` and `student_code_updated` broadcasts. It needs to also subscribe to:\n- `session_ended` - to detect when instructor ends the session\n- `featured_student_changed` - to update featured student state\n- `problem_updated` - to update problem state when instructor changes it\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts` (lines 230-282)\n   - Add `.on('broadcast', { event: 'session_ended' }, ...)` handler\n   - Add `.on('broadcast', { event: 'featured_student_changed' }, ...)` handler\n   - Add `.on('broadcast', { event: 'problem_updated' }, ...)` handler (if needed for instructor/student views)\n\n## Implementation\n\nAdd to the broadcast channel subscription (around line 270):\n\n```typescript\n.on('broadcast', { event: 'session_ended' }, (payload) =\u003e {\n  if (payload.payload) {\n    const { endedAt } = payload.payload;\n    setSession(prev =\u003e prev ? {\n      ...prev,\n      status: 'completed',\n      endedAt: endedAt ? new Date(endedAt) : new Date(),\n    } : prev);\n  }\n})\n.on('broadcast', { event: 'featured_student_changed' }, (payload) =\u003e {\n  if (payload.payload) {\n    const { featuredStudentId, featuredCode } = payload.payload;\n    setSession(prev =\u003e prev ? {\n      ...prev,\n      featuredStudentId,\n      featuredCode,\n    } : prev);\n    setFeaturedStudent({\n      studentId: featuredStudentId,\n      code: featuredCode,\n    });\n  }\n})\n```\n\n## Testing\n\nUpdate `src/hooks/__tests__/useRealtimeSession.test.ts`:\n\n1. Add test for `session_ended` broadcast:\n   - Simulate broadcast event, verify session state updates to `status: 'completed'`\n   - Reference existing `student_joined` broadcast tests for pattern\n\n2. Add test for `featured_student_changed` broadcast:\n   - Simulate broadcast event, verify `featuredStudent` state updates\n   - Verify `session.featuredStudentId` updates\n\n3. Add test for `problem_updated` broadcast (if implemented):\n   - Simulate broadcast event, verify problem state updates\n\nReference: `src/app/(app)/instructor/public/page.tsx` lines 66-85 for broadcast handler patterns\n\n## Dependencies\n\n- Depends on coding-tool-yut.1 (session_ended broadcast must exist first)\n\n## Notes\n\n- This makes the postgres_changes handlers for these events redundant\n- The public view page already subscribes to `featured_student_changed` and `problem_updated` - use that as reference\n- After this task, the lastMessage handlers for `sessions` table in lines 332-346 become dead code","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:54.716461512Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.317089875Z","closed_at":"2026-01-25T17:37:35.51774317Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-saj","title":"Complete postgres_changes to Broadcast migration","description":"## Goal\n\n**Fully migrate from Supabase postgres_changes to Broadcast for all realtime updates.** After this epic is complete:\n- NO postgres_changes subscriptions should remain in client code\n- ALL realtime updates flow through Broadcast events\n- The `useRealtime` hook should be removed or repurposed for presence-only\n- No polling should occur when broadcast is connected\n\n## Background\n\nThe codebase partially migrated from Supabase postgres_changes to Broadcast for realtime updates. Broadcast is more reliable (recommended by Supabase) and the API routes now send broadcasts, but:\n\n1. Some broadcasts are sent but not subscribed to\n2. Some events don't have broadcasts yet (rely on postgres_changes)\n3. Dead postgres_changes code remains in the codebase, causing confusion\n\n## Current Architecture\n\n**Hooks:**\n- `src/hooks/useRealtime.ts` - Low-level hook that subscribes to postgres_changes for `session_students`, `sessions`, `revisions` tables. **TO BE REMOVED/REPURPOSED.**\n- `src/hooks/useRealtimeSession.ts` - High-level hook that:\n  - Uses `useRealtime` for postgres_changes (partially dead)\n  - Has separate broadcast channel subscription for `student_joined`, `student_code_updated`\n  - Tracks `isBroadcastConnected` for polling fallback\n  - Returns `isConnected` from useRealtime (postgres_changes) - UI shows this but polling uses broadcast state\n\n**API Routes that broadcast:**\n- `/api/sessions/[id]/join` → `student_joined`\n- `/api/sessions/[id]/code` → `student_code_updated`\n- `/api/sessions/[id]/feature` → `featured_student_changed`\n- `/api/sessions/[id]/update-problem` → `problem_updated`\n\n**API Routes that DON'T broadcast (need to be fixed):**\n- `DELETE /api/sessions/[id]` - ends session, no broadcast\n\n## Migration Status Table\n\n| Event | Broadcast Sent | useRealtimeSession Broadcast | useRealtimeSession postgres_changes | Status |\n|-------|---------------|------------------------------|-------------------------------------|--------|\n| student_joined | ✅ | ✅ | ✅ | Redundant - remove postgres_changes |\n| student_code_updated | ✅ | ✅ | ✅ | Redundant - remove postgres_changes |\n| featured_student_changed | ✅ | ❌ | ✅ | Incomplete - add broadcast subscription, remove postgres_changes |\n| problem_updated | ✅ | ❌ | ❌ | Gap - add broadcast subscription |\n| session_ended | ❌ | ❌ | ✅ | Not migrated - add broadcast + subscription |\n| revisions | ❌ | ❌ | ✅ (logs only) | Dead code - remove entirely |\n\n## Bug Symptoms\n\n- Student page UI shows \"connected\" (from postgres_changes) but polls every 2s (because broadcast channel state differs from postgres_changes state)\n- Two different `isConnected` states cause confusion (`isConnected` vs `isBroadcastConnected`)\n\n## Success Criteria\n\n1. All events use Broadcast (no postgres_changes subscriptions remain)\n2. Single source of truth for connection status (`isBroadcastConnected`)\n3. `useRealtime.ts` removed or simplified to presence-only\n4. No polling when broadcast is connected\n5. All unit tests updated to reflect new architecture\n6. **E2E tests must pass** - run `npm run test:e2e` locally before completing each task","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:03.325369627Z","created_by":"Joe Delfino","updated_at":"2026-01-25T18:09:27.695408263Z","closed_at":"2026-01-25T18:09:27.695408263Z","close_reason":"Merged in PR #20"}
{"id":"coding-tool-saj.1","title":"Add session_ended broadcast to DELETE /api/sessions/[id]","description":"## Summary\n\nWhen a session ends, students need to be notified so they can show the \"Session Ended\" notification. Currently this relies on postgres_changes detecting the `sessions` table update, but we're migrating to Broadcast.\n\n## Files to Modify\n\n1. `src/app/api/sessions/[id]/route.ts` (lines 47-57)\n   - After `SessionService.endSession()` succeeds, broadcast `session_ended` event\n\n## Implementation\n\nAdd broadcast after line 48, following the same pattern as other routes:\n\n```typescript\n// After: await SessionService.endSession(storage, sessionId);\n\n// Broadcast session ended event\nconst supabase = getSupabaseBrowserClient(); // or use service role client\nconst channel = supabase.channel(`session:${sessionId}`);\nchannel.subscribe(async (status) =\u003e {\n  if (status === 'SUBSCRIBED') {\n    await channel.send({\n      type: 'broadcast',\n      event: 'session_ended',\n      payload: {\n        sessionId,\n        endedAt: new Date().toISOString(),\n      },\n    });\n    supabase.removeChannel(channel);\n  }\n});\n```\n\n## Testing\n\n1. Add test in `src/app/api/sessions/[id]/__tests__/route.test.ts`:\n   - Verify broadcast is sent when session is deleted\n   - Mock Supabase channel and verify `session_ended` event payload\n\n2. Test file reference: `src/app/api/sessions/[id]/feature/route.ts` tests may have broadcast mocking patterns to follow\n\n## Notes\n\n- Look at `src/app/api/sessions/[id]/feature/route.ts` for the broadcast pattern\n- The client subscription will be added in a separate task\n- Consider using service role client since this is a server-side route","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:37.919372796Z","created_by":"Joe Delfino","updated_at":"2026-01-25T17:31:43.12390184Z","closed_at":"2026-01-25T17:31:43.12390184Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-saj.2","title":"Add broadcast subscriptions to useRealtimeSession for missing events","description":"## Summary\n\n`useRealtimeSession` currently only subscribes to `student_joined` and `student_code_updated` broadcasts. It needs to also subscribe to:\n- `session_ended` - to detect when instructor ends the session\n- `featured_student_changed` - to update featured student state\n- `problem_updated` - to update problem state when instructor changes it\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts` (lines 230-282)\n   - Add `.on('broadcast', { event: 'session_ended' }, ...)` handler\n   - Add `.on('broadcast', { event: 'featured_student_changed' }, ...)` handler\n   - Add `.on('broadcast', { event: 'problem_updated' }, ...)` handler (if needed for instructor/student views)\n\n## Implementation\n\nAdd to the broadcast channel subscription (around line 270):\n\n```typescript\n.on('broadcast', { event: 'session_ended' }, (payload) =\u003e {\n  if (payload.payload) {\n    const { endedAt } = payload.payload;\n    setSession(prev =\u003e prev ? {\n      ...prev,\n      status: 'completed',\n      endedAt: endedAt ? new Date(endedAt) : new Date(),\n    } : prev);\n  }\n})\n.on('broadcast', { event: 'featured_student_changed' }, (payload) =\u003e {\n  if (payload.payload) {\n    const { featuredStudentId, featuredCode } = payload.payload;\n    setSession(prev =\u003e prev ? {\n      ...prev,\n      featuredStudentId,\n      featuredCode,\n    } : prev);\n    setFeaturedStudent({\n      studentId: featuredStudentId,\n      code: featuredCode,\n    });\n  }\n})\n```\n\n## Testing\n\nUpdate `src/hooks/__tests__/useRealtimeSession.test.ts`:\n\n1. Add test for `session_ended` broadcast:\n   - Simulate broadcast event, verify session state updates to `status: 'completed'`\n   - Reference existing `student_joined` broadcast tests for pattern\n\n2. Add test for `featured_student_changed` broadcast:\n   - Simulate broadcast event, verify `featuredStudent` state updates\n   - Verify `session.featuredStudentId` updates\n\n3. Add test for `problem_updated` broadcast (if implemented):\n   - Simulate broadcast event, verify problem state updates\n\nReference: `src/app/(app)/instructor/public/page.tsx` lines 66-85 for broadcast handler patterns\n\n## Dependencies\n\n- Depends on coding-saj.1 (session_ended broadcast must exist first)\n\n## Notes\n\n- This makes the postgres_changes handlers for these events redundant\n- The public view page already subscribes to `featured_student_changed` and `problem_updated` - use that as reference\n- After this task, the lastMessage handlers for `sessions` table in lines 332-346 become dead code","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:54.716461512Z","created_by":"Joe Delfino","updated_at":"2026-01-25T17:37:35.51774317Z","closed_at":"2026-01-25T17:37:35.51774317Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-saj.3","title":"Remove postgres_changes code from useRealtimeSession","description":"## Summary\n\nAfter broadcast subscriptions are complete, remove all postgres_changes handling from `useRealtimeSession`. This includes removing the dependency on `useRealtime` hook for event handling.\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts`\n   - Remove `lastMessage` from useRealtime destructuring (line 109)\n   - Remove entire `lastMessage` handler useEffect (lines 302-354)\n   - Keep `useRealtime` ONLY if presence tracking is still needed, otherwise remove entirely\n\n## Code to Remove\n\nLines 302-354 (the entire lastMessage handler):\n```typescript\n/**\n * Handle Realtime messages\n */\nuseEffect(() =\u003e {\n  if (!lastMessage) {\n    return;\n  }\n\n  const { type, table, payload } = lastMessage;\n\n  // Handle session_students updates\n  if (table === 'session_students') {\n    // ... all this is dead code, handled by broadcast\n  }\n\n  // Handle sessions updates (featured student changes, status changes)\n  if (table === 'sessions') {\n    // ... all this is dead code after broadcast subscriptions added\n  }\n\n  // Handle revisions (execution results)\n  if (table === 'revisions') {\n    // ... this was never implemented, just logs\n  }\n}, [lastMessage]);\n```\n\n## Testing\n\nUpdate `src/hooks/__tests__/useRealtimeSession.test.ts`:\n\n1. **Remove tests** that mock `lastMessage` from useRealtime:\n   - Lines 204-343 contain tests for postgres_changes via lastMessage\n   - These test dead code paths and should be deleted\n\n2. **Verify existing broadcast tests still pass** after removing postgres_changes code\n\n3. **Update the useRealtime mock** (lines 16-17) to not include `lastMessage` if it's removed from the hook\n\nTest files to update:\n- `src/hooks/__tests__/useRealtimeSession.test.ts` - remove lastMessage tests\n\n## Dependencies\n\n- Depends on coding-saj.2 (broadcast subscriptions must be added first)\n\n## Notes\n\n- After this change, the `useRealtime` hook may only be needed for presence tracking\n- If presence is moved to the broadcast channel, `useRealtime` can be removed entirely\n- Update the hook's JSDoc comments to remove mentions of postgres_changes","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:16:47.876080176Z","created_by":"Joe Delfino","updated_at":"2026-01-25T17:42:39.146668171Z","closed_at":"2026-01-25T17:42:39.146668171Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-saj.4","title":"Remove or repurpose useRealtime hook for presence-only","description":"## Summary\n\nAfter postgres_changes code is removed from `useRealtimeSession`, evaluate whether `useRealtime` hook is still needed. It may be:\n1. **Removed entirely** if presence can be handled in the broadcast channel\n2. **Repurposed** to only handle presence tracking (remove all postgres_changes code)\n\n## Files to Modify\n\n1. `src/hooks/useRealtime.ts` - Either delete or simplify to presence-only\n2. `src/hooks/__tests__/useRealtime.test.ts` - Delete or update tests\n3. `src/hooks/useRealtimeSession.ts` - Update to either not use useRealtime, or use simplified version\n\n## Current useRealtime Functionality\n\nThe hook currently does:\n1. **postgres_changes subscriptions** (lines 126-141) - TO BE REMOVED\n2. **Presence tracking** (lines 143-149, 162-173) - KEEP if needed\n3. **Connection state management** - May need to merge with broadcast connection state\n4. **Reconnection logic** (lines 218-246) - May still be useful\n\n## Decision Points\n\n1. Can presence be handled on the same broadcast channel? If yes, remove useRealtime entirely.\n2. If presence needs a separate channel, keep useRealtime but remove postgres_changes code.\n\n## If Removing Entirely\n\n- Delete `src/hooks/useRealtime.ts`\n- Delete `src/hooks/__tests__/useRealtime.test.ts`\n- Move presence tracking into `useRealtimeSession` broadcast channel\n- Update CLAUDE.md to remove reference to useRealtime.ts\n\n## If Repurposing for Presence-Only\n\n- Remove lines 85-94 (handleDatabaseChange callback)\n- Remove lines 126-141 (postgres_changes subscriptions)\n- Remove `lastMessage` state and return value\n- Update tests to only test presence functionality\n- Rename to `usePresence` for clarity?\n\n## Testing\n\n**If removing useRealtime entirely:**\n- Delete `src/hooks/__tests__/useRealtime.test.ts`\n- Add presence tests to `src/hooks/__tests__/useRealtimeSession.test.ts`\n- Verify `onlineUsers` functionality still works\n\n**If keeping for presence-only:**\n- Update `src/hooks/__tests__/useRealtime.test.ts`:\n  - Remove all postgres_changes tests (lines 119-330)\n  - Keep presence tests (if any exist)\n  - Add new presence-only tests if needed\n\n## Dependencies\n\n- Depends on coding-saj.3 (postgres_changes must be removed from useRealtimeSession first)\n\n## Notes\n\n- The `onlineUsers` state is currently exposed by useRealtimeSession - ensure this still works after changes\n- Presence uses the Supabase presence API which works alongside broadcast on the same channel","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:17:15.59957755Z","created_by":"Joe Delfino","updated_at":"2026-01-25T17:51:21.718544136Z","closed_at":"2026-01-25T17:51:21.718544136Z","close_reason":"Implemented and reviewed","labels":["approved"]}
{"id":"coding-tool-saj.5","title":"Unify connection state - use isBroadcastConnected everywhere","description":"## Summary\n\nCurrently there are two connection states causing confusion:\n- `isConnected` - from useRealtime (postgres_changes channel)\n- `isBroadcastConnected` - from broadcast channel subscription\n\nThe student page shows `isConnected` in the UI but uses `isBroadcastConnected` to control polling. This causes the bug where UI shows \"connected\" but the page is polling.\n\nAfter migration, there should be ONE connection state based on the broadcast channel.\n\n## Files to Modify\n\n1. `src/hooks/useRealtimeSession.ts`\n   - Remove `isConnected` from useRealtime destructuring (if useRealtime is kept)\n   - Rename `isBroadcastConnected` to `isConnected` (or keep both but derive from same source)\n   - Update return value to only expose one connection state\n\n2. `src/app/(fullscreen)/student/page.tsx`\n   - Verify it uses the correct (broadcast-based) connection state\n   - Lines 49, 203, 244 reference `isConnected`\n\n3. `src/app/(app)/instructor/session/[id]/page.tsx`\n   - Update any connection state references\n\n## Current Problem (student/page.tsx)\n\n```typescript\n// Line 49 - destructures isConnected (from postgres_changes)\nconst { isConnected, ... } = useRealtimeSession({...});\n\n// Line 203 - UI shows postgres_changes state\nif (!isConnected) { /* show disconnected */ }\n\n// But useRealtimeSession.ts line 290 uses isBroadcastConnected for polling:\nif (!sessionId || isBroadcastConnected || loading) return;\n// ^ polling only stops when BROADCAST is connected\n```\n\n## Expected After Fix\n\n- Single `isConnected` state derived from broadcast channel\n- UI accurately reflects whether realtime updates are working\n- No polling when broadcast is connected\n- Polling fallback when broadcast disconnects\n\n## Testing\n\n1. Update `src/hooks/__tests__/useRealtimeSession.test.ts`:\n   - Test that `isConnected` reflects broadcast channel state\n   - Test that polling activates when `isConnected` is false\n   - Test that polling stops when `isConnected` is true\n\n2. Update `src/app/(fullscreen)/student/__tests__/page-session-ended.test.tsx`:\n   - Update mock to use unified connection state\n   - Line 72 currently mocks `isConnected: true`\n\n3. Update `src/app/(app)/instructor/session/[id]/__tests__/page.test.tsx`:\n   - Update useRealtimeSession mock to reflect new return values\n\n## Dependencies\n\n- Depends on coding-saj.3 (postgres_changes removal must happen first so there's only one channel to track)\n\n## Notes\n\n- This task may be partially or fully addressed during task 3 or 4\n- The key is ensuring the UI connection indicator matches the actual realtime mechanism","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:17:40.653443214Z","created_by":"Joe Delfino","updated_at":"2026-01-25T17:53:52.051325802Z","closed_at":"2026-01-25T17:53:52.051325802Z","close_reason":"Already completed in task 4 (commit 3428caa)","labels":["approved"]}
{"id":"coding-tool-t6v","title":"Update navigation tabs for instructor role","description":"Update src/config/navigation.ts to use proper routes instead of ?view= params.\n\nCurrent nav items use ?view= URLs:\n- Sessions: /instructor?view=sessions\n- Problems: /instructor?view=problems\n\nChange to:\n- Sessions: /instructor/sessions (new route needed, or keep as modal from dashboard?)\n- Problems: /instructor/problems (already exists at this route)\n\nAlso consider if InstructorNav.tsx (src/app/(app)/instructor/components/InstructorNav.tsx) is still needed, since Sidebar now handles global navigation. If still used within instructor pages, update its links to match.\n\n**Testing:** Update tests in src/config/__tests__/navigation.test.ts","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:33.738012715Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.340896625Z","closed_at":"2026-01-23T00:14:31.981528717Z","close_reason":"Completed"}
{"id":"coding-tool-tmc","title":"Migrate RevisionViewer to use CodeEditor with line highlighting","description":"RevisionViewer currently uses plain \u003cpre\u003e tags for code display with custom line highlighting to show diffs between revisions. It should be migrated to use the unified CodeEditor component.\n\n**Current implementation:**\n- File: src/app/instructor/components/RevisionViewer.tsx (437 lines)\n- Uses plain \u003cpre\u003e tags with custom styling\n- Has custom line highlighting logic for showing changed lines between revisions\n- Calculates which lines changed compared to previous revision\n\n**Why this is separate/lower priority:**\n- Requires new CodeEditor feature: line highlighting/decorations API\n- More complex than other consolidations due to diff highlighting\n- RevisionViewer is working well with current implementation\n- Monaco editor decorations API needs to be properly integrated\n\n**Implementation approach:**\n\n1. **Enhance CodeEditor component:**\n   - Add support for line decorations/highlights\n   - Add prop: highlightedLines?: { lineNumber: number; className: string }[]\n   - Use Monaco's decorations API to highlight specific lines\n   - Support custom background colors for highlighted lines\n\n2. **Update RevisionViewer:**\n   - Replace \u003cpre\u003e with CodeEditor component\n   - Pass readOnly=true\n   - Calculate highlighted lines as before\n   - Pass highlighted lines to CodeEditor via new prop\n\n3. **Benefits:**\n   - Consistent Monaco editor experience\n   - Better syntax highlighting than plain \u003cpre\u003e\n   - Reuse unified execution results display (if needed)\n   - Single code display component across entire app\n\n**Files to modify:**\n- src/app/student/components/CodeEditor.tsx (add line highlighting)\n- src/app/instructor/components/RevisionViewer.tsx (migrate to CodeEditor)\n- Add tests for line highlighting feature\n\n**Blocked by:**\nNothing - can be implemented independently\n\n**References:**\n- Monaco editor decorations: https://microsoft.github.io/monaco-editor/api/interfaces/monaco.editor.IStandaloneCodeEditor.html#deltaDecorations\n- Related ticket: ct-30z (CodeViewer consolidation)","status":"open","priority":4,"issue_type":"task","created_at":"2026-01-05T16:23:29.03752217Z","created_by":"node","updated_at":"2026-01-05T16:23:29.03752217Z"}
{"id":"coding-tool-tpy1","title":"Remove direct password-setting user creation flows","description":"## Summary\nSecurity issue: Several admin pages allow creating users by directly setting their passwords. This is a security anti-pattern - users should receive invitation links and set their own passwords.\n\nThe invitation system already exists and works correctly. These are legacy/broken forms that bypass it.\n\n## Files to DELETE entirely\n- `src/app/admin/components/AddInstructorForm.tsx` - Broken form (only sends username, API expects 3 fields)\n- `src/app/api/admin/instructors/route.ts` - Direct password creation endpoint\n- `src/app/api/admin/instructors/__tests__/route.test.ts` - Tests for deleted endpoint\n\n## Files to modify (remove create forms, keep view/manage)\n\n### `src/app/system/namespaces/[id]/page.tsx`\nRemove the \"Create New User\" form (lines 183-319):\n- Delete state: `newEmail`, `newUsername`, `newPassword`, `newUserRole`, `showCreateForm`\n- Delete `handleCreateUser` function\n- Delete the form JSX\n- Keep: user listing, role changing, delete functionality\n\n### API routes - Remove POST, keep GET\n- `src/app/api/system/users/route.ts` - Delete POST handler (lines 71-131), keep GET\n- `src/app/api/system/namespaces/[id]/users/route.ts` - Delete POST handler (lines 62-152), keep GET\n\n### Update tests\n- `src/app/api/system/users/__tests__/route.test.ts` - Remove POST tests\n- `src/app/api/system/namespaces/[id]/users/__tests__/route.test.ts` - Remove POST tests (if exists)\n\n## Correct flow after cleanup\n- System admins: Use `/system` Invitations tab to invite namespace-admins and instructors\n- Namespace admins: Use new invitation UI (separate issue) to invite instructors\n- Students: Self-register via section join codes (unchanged)\n\n## Test plan\n1. Verify system admin can still view users at `/system/namespaces/[id]`\n2. Verify system admin can change roles and delete users\n3. Verify direct user creation endpoints return 404/405\n4. Verify invitation flow still works on `/system` page","status":"closed","priority":0,"issue_type":"task","created_at":"2026-01-20T22:16:43.23056946Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.566680052Z","closed_at":"2026-01-20T22:45:31.14893101Z","close_reason":"Completed - removed all direct password-setting user creation flows"}
{"id":"coding-tool-tyj","title":"Clarify session end behavior for students","description":"## Summary\nWhen a session ends, it's unclear what happens to student code. Can they still view it? Copy it? Is it saved?\n\n## Current Behavior\n- `src/app/student/components/SessionEndedNotification.tsx` shows yellow warning with 'Go to Dashboard' button\n- Student code editing may or may not still work\n- No indication if code was saved or can be retrieved\n\n## Implementation\n\n### 1. Clear messaging on session end\nUpdate SessionEndedNotification to explain:\n- 'This session has ended'\n- 'Your code has been saved' (if true)\n- 'You can no longer run code, but you can copy your work below'\n\n### 2. Preserve code visibility\nAfter session ends:\n- Keep code editor visible (read-only)\n- Add 'Copy Code' button\n- Show last execution result\n\n### 3. Historical access\n- Students should be able to view their code from past sessions\n- Link to session history from the notification\n\n## Files to Modify\n- `src/app/student/components/SessionEndedNotification.tsx`\n- `src/app/student/page.tsx` - Handle post-session state\n- May need API endpoint to retrieve historical submissions","status":"open","priority":2,"issue_type":"task","created_at":"2026-01-15T03:58:37.443518048Z","created_by":"node","updated_at":"2026-01-15T03:58:37.443518048Z"}
{"id":"coding-tool-tyz","title":"Student sign-out does not redirect to login page","description":"## Problem\n\nTwo related issues with sign-out behavior for students:\n\n### Issue 1: Sign-out doesn't redirect\nWhen a student signs out, they are not immediately redirected to the login page. The expected behavior is that after clicking sign out, the user should be redirected to the login/home page right away.\n\n### Issue 2: Refreshing while signed out shows infinite loading\nRefreshing a protected page while signed out (e.g. `/student?sessionId=xxx`) shows a page stuck in a loading state instead of redirecting to the login page.\n\n**Example URL:** `https://code.delquillan.com/student?sessionId=ced31f3d-68a2-474d-adc8-564180921a41`\n\n## Expected Behavior\n\n1. After sign-out: User is immediately redirected to login page\n2. Accessing protected routes while signed out: User is redirected to login page\n\n## Actual Behavior\n\n1. After sign-out: User remains on current page\n2. Accessing protected routes while signed out: Page shows infinite loading spinner\n\n## Files to Investigate\n\n- Sign out button/action handler\n- Auth state management\n- Route protection/middleware\n- Loading state handling for unauthenticated users","status":"closed","priority":1,"issue_type":"bug","owner":"jdelfino@gmail.com","created_at":"2026-01-23T21:20:27.436269132Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.331843292Z","closed_at":"2026-01-23T21:45:29.632479925Z","close_reason":"Fixed: Added redirect after sign-out and auth protection to fullscreen layout."}
{"id":"coding-tool-u7dl","title":"Test suite cleanup - remove redundant and low-value tests","status":"closed","priority":3,"issue_type":"epic","created_at":"2026-01-20T17:18:19.354222634Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.643538052Z","closed_at":"2026-01-20T18:26:20.566916466Z","close_reason":"Merged in PR #11"}
{"id":"coding-tool-u8ys","title":"Remove deprecated username field references from codebase","description":"## Summary\n\nMigration 00004 removed the `username` column from `user_profiles` table, but there are still references to username throughout the codebase.\n\n## Files with username references\n\n- `src/hooks/useNamespaces.ts` - createUser takes username param\n- `src/app/(public)/auth/bootstrap/page.tsx` - derives username from email\n- `src/app/(app)/admin/components/UserList.tsx` - onDelete uses username\n- `src/app/(app)/admin/page.tsx` - handleDeleteUser uses username\n- `src/server/supabase/database.types.ts` - type definitions include username\n- `src/server/supabase/types.ts` - type definitions include username\n\n## Action Required\n\n1. Update API endpoints to not require username\n2. Update hooks and components to remove username parameters\n3. Regenerate database types to match current schema\n4. Update any remaining references","status":"open","priority":3,"issue_type":"chore","owner":"jdelfino@gmail.com","created_at":"2026-01-23T04:27:25.708779802Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.631035969Z"}
{"id":"coding-tool-uvn","title":"Data Persistence Layer","description":"Implement a complete data persistence layer with strict isolation to enable easy migration from local storage to remote backend in the future. All data storage and retrieval must go through well-defined interfaces in dedicated modules.\n\n**Architecture Goals:**\n- Single source of truth for all persistence operations\n- Abstract storage interface that hides implementation details\n- Easy to swap from local (file/memory) to remote (database/API)\n- Type-safe data contracts\n- Clear separation of concerns\n\n**Data to persist:**\n- Sessions (active and historical)\n- Problems and their specifications\n- Student code revisions\n- User preferences and settings\n- Execution results (optional)\n\n**Design Principles:**\n1. Repository pattern: All data access through repository interfaces\n2. No direct file system or database calls outside persistence modules\n3. Async interfaces (even if local storage is synchronous)\n4. Error handling and validation at persistence boundary\n5. Migration path documented for future remote backend\n\n**Initial Implementation:**\n- Local file-based storage (JSON files)\n- In-memory caching for active sessions\n- Simple file structure in data/ directory\n\n**Future Migration Path:**\n- Replace file storage with REST API calls\n- No changes to calling code (interface remains same)\n- Configuration-based storage selection\n\n**Modules to create:**\n- src/server/persistence/ (new directory)\n  - interfaces.ts - Storage interface definitions\n  - local-storage.ts - File-based implementation\n  - session-repository.ts - Session data operations\n  - problem-repository.ts - Problem data operations\n  - revision-repository.ts - Code revision operations\n\n**Success Criteria:**\n- All data operations isolated in persistence layer\n- No file I/O or storage logic outside persistence modules\n- Well-documented interfaces\n- Easy to add new storage backend by implementing interface","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-18T19:12:22.460790784Z","updated_at":"2026-01-23T05:48:22.943121924Z","closed_at":"2026-01-23T05:48:22.943121924Z","close_reason":"Completed - full repository pattern implemented in src/server/persistence/ with Supabase backends"}
{"id":"coding-tool-v2n","title":"Fix text wrapping in issue summary cards on instructor session view","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T00:10:03.383781002Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:00:03.70770197Z","closed_at":"2026-01-30T03:00:03.70770197Z","close_reason":"Merged in PR #44","labels":["wip"]}
{"id":"coding-tool-v525","title":"Update tests for new navigation structure","description":"Test updates required:\n- Unit tests for InstructorDashboard component\n- Unit tests for StartSessionModal component\n- Integration tests for session creation flow\n- Update existing tests that rely on old ?view= routing\n- Remove/update tests that check breadcrumb href with ?view=\n\nRun verification:\nnpm test\nnpm run lint\nnpx tsc --noEmit\nnpm run test:e2e  # Verify E2E tests pass with new routing","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-22T19:36:51.961958209Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.592477386Z","closed_at":"2026-01-23T00:24:08.17368822Z","close_reason":"Updated tests to use new navigation URLs without ?view= params"}
{"id":"coding-tool-vaa","title":"Double breadcrumb in instructor view after choosing class","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-20T03:58:55.287380513Z","created_by":"Joe Delfino","updated_at":"2026-01-20T04:04:57.238944708Z","closed_at":"2026-01-20T04:04:57.238944708Z","close_reason":"Fixed: Removed redundant BackButton from section list view since breadcrumb handles navigation"}
{"id":"coding-tool-vqo","title":"Public problem page + solutions","description":"Allow instructors to define solutions for problems, and provide a public (no-auth) read-only page at /problems/{id} showing title, description, and click-to-reveal solution. Enables linking from Google Slides with content visible inline and in PDF exports. Also adds a 'Show Solution' toggle on the instructor projector view during live sessions.","status":"closed","priority":2,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:24:05.742706835Z","created_by":"Joe Delfino","updated_at":"2026-01-30T17:13:12.139941546Z","closed_at":"2026-01-30T17:13:12.139941546Z","close_reason":"Merged in PR #51"}
{"id":"coding-tool-vqo.1","title":"Add solution field to Problem model","description":"Add a `solution` text column to the database and thread it through types, schema, repository, and API layers.\n\n**Files to modify:**\n- `supabase/migrations/` — new `00010_add_solution_to_problems.sql` (00009 already exists)\n- `src/server/types/problem.ts` — add `solution?: string` to `Problem`, `ProblemInput`; do NOT add to `StudentProblem`\n- `src/server/persistence/problem-schema.ts` — add to `ProblemSchema`, validation rules, serialize/deserialize\n- `src/server/persistence/supabase/problem-repository.ts` — add `solution` to column mappings in create/update/read\n\n**Steps:**\n1. Create migration: `ALTER TABLE problems ADD COLUMN solution TEXT;`\n2. Add `solution?: string` to `Problem` and `ProblemInput` interfaces (not `StudentProblem`)\n3. Add validation rule: max 50000 chars, optional (same as description)\n4. Update serialize/deserialize to include `solution`\n5. Update repository column mappings for create, update, and read\n6. Verify API routes accept `solution` in create/update payloads (they use spread from ProblemInput, should work)\n\n**Tests:** Unit tests for serialization with solution, validation accepts/rejects solution length.","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:24:15.734047757Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:46:08.465149462Z","closed_at":"2026-01-30T16:46:08.465149462Z","close_reason":"Completed","labels":["in-pr"]}
{"id":"coding-tool-vqo.2","title":"Add solution tab to ProblemCreator UI","description":"Add a tab bar above the code editor in ProblemCreator to switch between 'Starter Code' and 'Solution' editing. Same CodeEditor component, different code buffer.\n\n**Files to modify:**\n- `src/app/(app)/instructor/components/ProblemCreator.tsx`\n\n**Steps:**\n1. Add `solution` state field (string, loaded from problem in edit mode)\n2. Add `activeTab` state: `'starter' | 'solution'`\n3. Render a tab bar between the header and the EditorContainer with two tabs\n4. When tab is 'starter': pass `starterCode`/`setStarterCode` to CodeEditor (current behavior)\n5. When tab is 'solution': pass `solution`/`setSolution` to CodeEditor, with title 'Solution Code'\n6. Include `solution` in the submit payload\n7. Load `solution` from API response in edit mode\n\n**Tests:** Component tests for tab switching, submitting with solution.","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:24:20.843123343Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:56:38.753923545Z","closed_at":"2026-01-30T16:56:38.753923545Z","close_reason":"Completed","labels":["in-pr"]}
{"id":"coding-tool-vqo.3","title":"Public problem page + API endpoint","description":"Create an unauthenticated read-only page at /problems/{id} showing title, description, and a click-to-reveal solution code block. Add OG meta tags for link previews.\n\n**Files to create:**\n- `src/app/api/problems/[id]/public/route.ts` — unauthenticated GET endpoint\n- `src/app/(public)/problems/[id]/page.tsx` — public page component\n\n**Steps:**\n1. **API endpoint:** Fetch problem by ID from repository (no auth). Return only `id`, `title`, `description`, `solution`. Return 404 for missing problems.\n2. **Page:** Server-rendered Next.js page with:\n   - Problem title as `\u003ch1\u003e`\n   - Description rendered via `MarkdownContent`\n   - Solution in a collapsible/spoiler `\u003cdetails\u003e` element, rendered as a syntax-highlighted code block, collapsed by default\n   - 'Open in Classroom' link to the app\n3. **Metadata:** Set `\u003ctitle\u003e` and OG tags (`og:title`, `og:description`) via Next.js `generateMetadata`\n\n**Tests:** API route tests (returns correct fields, 404 for missing). Component render tests.","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:24:26.620456012Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:56:38.915700503Z","closed_at":"2026-01-30T16:56:38.915700503Z","close_reason":"Completed","labels":["in-pr"]}
{"id":"coding-tool-vqo.4","title":"Show solution on projector from instructor session controls","description":"Add a 'Show Solution' toggle in the instructor's session controls that broadcasts the solution to the public/projector view, displaying it instead of the featured student's code.\n\n**Files to modify:**\n- `src/app/(app)/instructor/components/SessionControls.tsx` — add 'Show Solution' toggle button, broadcast on projector channel\n- `src/app/(projector)/public-view/page.tsx` — subscribe to new `session:${sessionId}:projector` channel for `solution_displayed` event, render solution code\n\n**Steps:**\n1. Add 'Show Solution' button to SessionControls (only visible when session has a problem with a solution)\n2. On click, broadcast a `solution_displayed` event on a new `session:${sessionId}:projector` channel with `{ show: true/false, solution: string }`. This is a separate channel from the shared student channel to avoid leaking projector-only events to students.\n3. In public-view page, add a second channel subscription to `session:${sessionId}:projector` (keep existing shared channel subscription for `featured_student_changed` and `problem_updated`)\n4. When received with `show: true`, display the solution code in the main area (replaces featured student code)\n5. When `show: false`, return to normal featured-student view\n6. Style the button to indicate current state (e.g., highlighted when solution is showing)\n\n**Note:** Existing shared channel (`session:${sessionId}`) is left as-is. The projector channel is additive — a clean pattern for future projector-only events.\n\n**Tests:** Component tests for button visibility/toggle behavior. Integration tests for broadcast handling.","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T16:24:34.148884251Z","created_by":"Joe Delfino","updated_at":"2026-01-30T16:56:38.973342628Z","closed_at":"2026-01-30T16:56:38.973342628Z","close_reason":"Completed","labels":["in-pr"]}
{"id":"coding-tool-wqs5","title":"Test level 2 subtask","status":"closed","priority":4,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T03:55:45.908859173Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.645481511Z","closed_at":"2026-01-23T03:55:56.712835428Z","close_reason":"Test"}
{"id":"coding-tool-wvl","title":"Epic: Rethink admin page layout and information architecture","description":"## Summary\n\nThe admin page layout needs a rethink. Key issues:\n- Instructor invitations are too hidden (have to navigate to user management, then click Instructors tab)\n- Information architecture is inconsistent between system-admin and namespace-admin views\n- The two admin pages (admin panel and system page) have overlapping concerns\n\nThis epic should explore and redesign the admin experience holistically. Separate from the current bug fix work in coding-tool-p2q.","status":"open","priority":2,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T03:23:08.822121Z","created_by":"Joe Delfino","updated_at":"2026-01-30T03:23:08.822121Z"}
{"id":"coding-tool-x5j","title":"Remove test count display and fix invalid date in problem library","status":"closed","priority":2,"issue_type":"bug","owner":"jdelfino@brandeis.edu","created_at":"2026-01-30T14:34:24.688141012Z","created_by":"Joe Delfino","updated_at":"2026-01-30T14:34:28.28529893Z","closed_at":"2026-01-30T14:34:28.28529893Z","close_reason":"Fixed: removed test count display and updatedAt references from ProblemCard. Added regression tests."}
{"id":"coding-tool-x76","title":"Replace browser confirm() dialogs with styled modals","description":"## Summary\nSession end and other destructive actions use native browser `confirm()` dialogs instead of styled modals.\n\n## Current State\n- `src/app/instructor/page.tsx` (line 258): `confirm('Are you sure you want to end this session?')`\n- Native browser dialogs look unprofessional and can't be styled\n\n## Implementation\n\n### 1. Create ConfirmDialog component\n```typescript\n// src/components/ui/ConfirmDialog.tsx\ninterface ConfirmDialogProps {\n  isOpen: boolean;\n  title: string;\n  message: string;\n  confirmLabel?: string; // default 'Confirm'\n  cancelLabel?: string;  // default 'Cancel'\n  variant?: 'danger' | 'warning' | 'default';\n  onConfirm: () =\u003e void;\n  onCancel: () =\u003e void;\n}\n```\n\n### 2. Replace confirm() calls\nAudit codebase for `confirm(` and replace with ConfirmDialog:\n- End session confirmation\n- Delete class/section confirmation\n- Any other destructive actions\n\n### 3. Consistent styling\n- Match app's design system\n- Red 'End Session' button for destructive actions\n- Proper focus management and ESC to close\n\n## Files to Modify\n- Create `src/components/ui/ConfirmDialog.tsx`\n- `src/app/instructor/page.tsx` - Replace confirm() for end session\n- Search for other confirm() usages","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-15T03:59:25.809636709Z","created_by":"node","updated_at":"2026-01-21T01:25:40.714156262Z","closed_at":"2026-01-21T01:25:40.714156262Z","close_reason":"Completed as part of PR #14 - Design System Consolidation"}
{"id":"coding-tool-x8y","title":"Replace username with email as primary identifier, add optional display_name","description":"## Summary\nRemove required `username` field and use email as the primary user identifier. Add optional `display_name` for personalization.\n\n## Rationale\n- Username adds registration friction (\"username already taken\")\n- Invitation system (a0k) uses email, not username\n- Email is already unique in Supabase auth\n- Users rarely remember their username vs email\n\n## Database Changes\n\n### Migration\n```sql\n-- Make username nullable (keep for backwards compat during transition)\nALTER TABLE user_profiles ALTER COLUMN username DROP NOT NULL;\n\n-- Add display_name column\nALTER TABLE user_profiles ADD COLUMN display_name TEXT;\n\n-- Backfill: set display_name to username for existing users\nUPDATE user_profiles SET display_name = username WHERE username IS NOT NULL;\n```\n\n### Future cleanup (separate migration after transition)\n```sql\n-- Drop username column entirely\nALTER TABLE user_profiles DROP COLUMN username;\n\n-- Or keep as nullable for backwards compat\n```\n\n## Code Changes\n\n### 1. Update User type\n```typescript\n// src/server/auth/types.ts\ninterface User {\n  id: string;\n  email: string;\n  displayName?: string;  // Optional\n  // username removed or made optional\n  role: UserRole;\n  namespaceId: string | null;\n}\n```\n\n### 2. Display logic helper\n```typescript\n// src/lib/user-display.ts\nexport function getDisplayName(user: { email: string; displayName?: string }): string {\n  if (user.displayName) return user.displayName;\n  // Extract username part of email: \"jsmith@university.edu\" → \"jsmith\"\n  return user.email.split('@')[0];\n}\n```\n\n### 3. Update registration\n- Remove username field from form\n- Remove username from API payload\n- Set display_name = null (user can set later if desired)\n\n### 4. Update user repository\n- `getUserByUsername()` → `getUserByEmail()` (or deprecate)\n- Remove username from create/update methods\n\n### 5. Update UI components\n- Replace `user.username` with `getDisplayName(user)`\n- UserList, headers, student lists, etc.\n\n### 6. Remove AddInstructorForm\n- Being replaced by invitation system (a0k)\n- Or update to use email instead of username\n\n## Files to modify\n- `supabase/migrations/XXXXXX_drop_username.sql` (new)\n- `src/server/auth/types.ts`\n- `src/server/auth/interfaces.ts`\n- `src/server/auth/supabase-provider.ts`\n- `src/server/persistence/supabase/user-repository.ts`\n- `src/app/auth/register/page.tsx`\n- `src/app/api/auth/register/route.ts`\n- `src/app/admin/components/AddInstructorForm.tsx` (remove or update)\n- `src/app/admin/components/UserList.tsx`\n- `src/lib/user-display.ts` (new)\n- Various UI components showing usernames\n\n## Privacy consideration\n- Instructors see student lists - showing full email may be too much\n- `getDisplayName()` helper shows just the local part by default\n- Could add option for students to set custom display_name\n\n## Verification\n1. New registration works without username field\n2. Existing users still work (display_name backfilled from username)\n3. User lists show sensible names (not full emails)\n4. Login still works with email\n5. All tests updated and passing","status":"open","priority":2,"issue_type":"feature","created_at":"2026-01-15T03:44:54.463452333Z","created_by":"node","updated_at":"2026-01-15T03:44:54.463452333Z"}
{"id":"coding-tool-xg1d","title":"Core Infrastructure - Navigation \u0026 Panel Config","description":"Create foundational configuration and context files.\n\n## Files to Create\n\n### 1. src/config/navigation.ts\n- `NavItem` type: id, label, href, icon, roles, group\n- `NavGroup` for sidebar sections: Main, Teaching, Admin, System\n- `BREADCRUMB_HIERARCHY` mapping for parent-child relationships\n- Helper functions: `getNavItemsForRole()`, `getNavGroupsForRole()`\n\n### 2. src/config/panels.ts\n- `PanelConfig` type: id, label, icon, defaultState (expanded/collapsed/hidden)\n- Session panels: Problem Setup, AI Walkthrough\n- Helper: `getPanelsForPage()`\n\n### 3. src/contexts/ActiveSessionContext.tsx\n- Track active instructor session globally\n- Persist to localStorage\n- Used by header banner and sidebar indicator\n\n### 4. src/contexts/PanelContext.tsx\n- Track right panel visibility/collapsed state\n- Persist state per-page to localStorage\n- Provide toggle functions\n\n## ActiveSessionContext Clarification\n\n**Important:** ActiveSessionContext holds ONLY lightweight indicator data:\n```typescript\ninterface ActiveSessionState {\n  sessionId: string | null;\n  joinCode: string | null;\n}\n```\n\nThis is SEPARATE from `useRealtimeSession` which manages full session data (students, code, WebSocket subscriptions). ActiveSessionContext enables the \"Return to Session\" banner in the header - it doesn't replace or duplicate the realtime hook.\n\n## localStorage Keys\nUse namespaced keys to avoid collisions:\n- `coding-tool:active-session` - ActiveSessionContext state\n- `coding-tool:panel-state:{pageId}` - PanelContext state per page\n- `coding-tool:sidebar-collapsed` - Sidebar collapse state\n\n## Testing\n- Unit tests for helper functions (getNavItemsForRole, getPanelsForPage)\n- Context provider tests for state persistence","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-21T23:24:30.532203505Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.626971302Z","closed_at":"2026-01-22T03:08:07.482596011Z","close_reason":"Completed"}
{"id":"coding-tool-xis","title":"Add timeout detection for hanging code execution","description":"Implement timeout detection and graceful handling for code that hangs waiting for input.\n\n**Problem:**\nWhen code expects stdin input but none (or insufficient input) is provided, the execution hangs indefinitely. This is a common failure case for students testing code with input() calls.\n\n**Current Behavior:**\n- Code executor has a timeout (default 10s), but hanging code waiting for input will sit until timeout\n- No feedback to user that program is waiting for input\n- Timeout error is generic, doesn't indicate the likely cause\n\n**Desired Behavior:**\n1. Detect when program is blocked on stdin read\n2. Provide clear error message: \"Program appears to be waiting for input, but no more input was provided\"\n3. Terminate execution gracefully with informative feedback\n4. Consider shorter timeout for stdin-blocked processes (e.g., 3-5s instead of 10s)\n\n**Files to Modify:**\n- src/server/code-executor.ts - Add stdin detection and timeout handling\n- src/server/__tests__/code-executor.test.ts - Add tests for hanging input scenarios\n\n**Implementation Approach:**\n\n1. **Basic timeout improvement:**\n   - Add specific timeout for stdin operations (shorter than general execution timeout)\n   - Detect timeout scenario and provide better error message\n   - Check if stdin was provided but insufficient (common case: single input() with empty stdin)\n\n2. **Bonus: Stdin waiting detection (advanced):**\n   - Monitor Python process state to detect if blocked on read()\n   - Use techniques like:\n     - Check process status (/proc/[pid]/status on Linux, look for \"sleeping\" state)\n     - Monitor file descriptor activity\n     - Use strace/ptrace to detect blocked syscalls (read from stdin)\n   - If detected as blocked on stdin + no more stdin available → immediate informative error\n\n3. **Error message improvements:**\n   - \"Program is waiting for input, but none was provided. Did you forget to add input?\"\n   - \"Program read X lines but tried to read more. Provided input may be incomplete.\"\n   - Include line of code that's likely blocking (if parseable from traceback)\n\n**Example Test Cases:**\n```python\n# Case 1: No stdin provided, single input expected\ncode = 'name = input(\"Name: \")'\nstdin = None\n# Should timeout quickly with helpful message\n\n# Case 2: Insufficient stdin (expects 2 inputs, gets 1)\ncode = 'name = input()\\nage = input()'\nstdin = 'Alice\\n'\n# Should detect second input() is blocking\n\n# Case 3: Valid case - enough input provided\ncode = 'name = input()\\nprint(name)'\nstdin = 'Alice\\n'\n# Should execute normally\n```\n\n**Priority Notes:**\n- High priority because this affects user experience significantly\n- Common student error pattern\n- Better error messages improve learning experience","status":"open","priority":1,"issue_type":"feature","created_at":"2026-01-05T16:22:58.463934337Z","created_by":"node","updated_at":"2026-01-05T16:22:58.463934337Z"}
{"id":"coding-tool-xk2","title":"Merge AI Walkthrough into Students tab","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:35:44.57798718Z","created_by":"Joe Delfino","updated_at":"2026-01-29T14:05:44.239288802Z","closed_at":"2026-01-29T14:05:44.239288802Z","close_reason":"Merged in PR #31"}
{"id":"coding-tool-xk2.1","title":"Extract categoryStyles to shared constant in analysis.ts","description":"## Summary\nMove the `categoryStyles` map from `WalkthroughEntry.tsx` to a shared UI-layer constant file so it can be shared by new components.\n\n## Files to modify\n- `src/app/(app)/instructor/constants/analysis.ts` — create file with exported `categoryStyles` constant\n- `src/app/(app)/instructor/components/WalkthroughEntry.tsx` — import from `../constants/analysis` instead of defining locally\n\n## Why not server/types/analysis.ts?\n`categoryStyles` contains CSS/presentation values (hex colors, Tailwind classes). It belongs in the UI layer, not alongside server type definitions.\n\n## Implementation\n1. Create `src/app/(app)/instructor/constants/analysis.ts`\n2. Copy the `categoryStyles` record from `WalkthroughEntry.tsx` (line 13-18) into it\n3. Export it: `export const categoryStyles: Record\u003cWalkthroughCategory, { bg: string; text: string; label: string }\u003e`\n4. Update `WalkthroughEntry.tsx` to import `categoryStyles` from `../constants/analysis`\n5. Remove the local definition from `WalkthroughEntry.tsx`\n\n## Test\n- `npx tsc --noEmit` passes\n- Existing `WalkthroughEntry.test.tsx` still passes","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:35:53.434905086Z","created_by":"Joe Delfino","updated_at":"2026-01-29T04:48:58.009338588Z","closed_at":"2026-01-29T04:48:58.009338588Z","close_reason":"Implemented in 9209ade","labels":["wip"]}
{"id":"coding-tool-xk2.2","title":"Create useAnalysisGroups hook","description":"## Summary\nCreate a custom hook that manages analysis state and group-based navigation. This extracts and extends the fetch/state logic currently in `WalkthroughPanel.tsx`.\n\n## Files to create\n- `src/app/(app)/instructor/hooks/useAnalysisGroups.ts`\n- `src/app/(app)/instructor/hooks/__tests__/useAnalysisGroups.test.ts`\n\n## Types (define in hook file)\n```ts\ninterface AnalysisGroup {\n  id: string;                        // 'all' | WalkthroughCategory value\n  label: string;                     // \"All Submissions\" | \"Common Errors\" | etc.\n  entries: WalkthroughEntry[];       // entries in this category\n  studentIds: string[];              // for filtering student list (not Set — simpler for React state and serialization)\n  recommendedStudentId: string | null; // first entry's studentId\n}\n```\n\n## Hook API\n```ts\nfunction useAnalysisGroups(): {\n  // State\n  analysisState: 'idle' | 'loading' | 'ready' | 'error';\n  error: string | null;\n  script: WalkthroughScript | null;\n\n  // Groups\n  groups: AnalysisGroup[];           // non-dismissed groups, \"All Submissions\" always first\n  activeGroup: AnalysisGroup | null;\n  activeGroupIndex: number;\n\n  // Actions\n  analyze: (sessionId: string) =\u003e Promise\u003cvoid\u003e;\n  navigateGroup: (direction: 'prev' | 'next') =\u003e void;\n  setActiveGroupIndex: (index: number) =\u003e void;\n  dismissGroup: (groupId: string) =\u003e void;\n}\n```\n\n## Implementation\n1. Port the fetch logic from `WalkthroughPanel.tsx` `handleAnalyze` (POST to `/api/sessions/${sessionId}/analyze`)\n2. On successful analysis, derive groups by grouping `script.entries` by `category` field\n3. Use `categoryStyles` from `../constants/analysis` (from prerequisite task) for group labels\n4. Prepend an \"All Submissions\" pseudo-group with `id: 'all'`, empty entries, empty studentIds\n5. Track `dismissedCategories: Set\u003cstring\u003e` in state — filter these out of `groups`\n6. Track `activeGroupIndex` — clamp on dismiss, reset to 0 on new analysis\n7. \"All Submissions\" group cannot be dismissed\n8. Re-analyze replaces all state (clears dismissals, resets index)\n\n## Tests\nTest with `renderHook` from `@testing-library/react`:\n- Starts in idle state with empty groups\n- `analyze()` transitions idle→loading→ready, populates groups\n- Groups are ordered: \"All Submissions\" first, then by category order (common-error, edge-case, interesting-approach, exemplary)\n- `navigateGroup('next')` / `navigateGroup('prev')` updates activeGroupIndex with bounds clamping\n- `dismissGroup(id)` removes group, clamps activeGroupIndex, cannot dismiss 'all'\n- Re-analyze resets dismissals and index\n- `recommendedStudentId` is first entry's studentId per group\n- Error state on fetch failure","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:36:17.895013959Z","created_by":"Joe Delfino","updated_at":"2026-01-29T04:51:33.651563216Z","closed_at":"2026-01-29T04:51:33.651563216Z","close_reason":"Implemented in 0f6cd14","labels":["wip"]}
{"id":"coding-tool-xk2.3","title":"Create GroupNavigationHeader component","description":"## Summary\nCreate a compact navigation header for cycling through analysis groups with prev/next arrows, dismiss button, and position indicator.\n\n## Files to create\n- `src/app/(app)/instructor/components/GroupNavigationHeader.tsx`\n- `src/app/(app)/instructor/components/__tests__/GroupNavigationHeader.test.tsx`\n\n## Props\n```ts\ninterface GroupNavigationHeaderProps {\n  groups: AnalysisGroup[];\n  activeGroupIndex: number;\n  onNavigate: (direction: 'prev' | 'next') =\u003e void;\n  onDismiss: (groupId: string) =\u003e void;\n  commonPatterns?: string[];  // from WalkthroughSummary, shown on \"All Submissions\" view\n}\n```\n\n## Rendering\n- Layout: single row, horizontally centered content\n- Left arrow button (disabled when index === 0)\n- Center: group label + \"(N students)\" count showing number of unique students in the group + \"· X of Y\" position text\n- Dismiss X button (hidden when active group id is 'all')\n- Right arrow button (disabled when index === groups.length - 1)\n- Below the nav row: if active group is 'all' and commonPatterns provided, show them as a small bulleted list with muted text\n- Use Tailwind classes consistent with existing codebase style\n\n## Tests\n- Renders group label and position indicator\n- Renders student count for active group\n- Prev button disabled on first group, next disabled on last\n- Clicking prev/next calls onNavigate with correct direction\n- Dismiss button hidden for \"All Submissions\" group\n- Clicking dismiss calls onDismiss with group id\n- Common patterns shown only for \"all\" group","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:36:28.166384714Z","created_by":"Joe Delfino","updated_at":"2026-01-29T04:53:40.537685844Z","closed_at":"2026-01-29T04:53:40.537685844Z","close_reason":"Implemented in e8f15c4","labels":["wip"]}
{"id":"coding-tool-xk2.4","title":"Create StudentAnalysisDetails component","description":"## Summary\nCreate a component that displays AI analysis details for a selected student, rendered below the code editor in the right panel.\n\n## Files to create\n- `src/app/(app)/instructor/components/StudentAnalysisDetails.tsx`\n- `src/app/(app)/instructor/components/__tests__/StudentAnalysisDetails.test.tsx`\n\n## Props\n```ts\ninterface StudentAnalysisDetailsProps {\n  entries: WalkthroughEntry[];  // all analysis entries for this student (may span multiple categories)\n}\n```\n\n## Rendering\n- Card with light gray background and border, matching the code editor card style\n- For each entry:\n  - Category badge pill (using `categoryStyles` from `analysis.ts`)\n  - Discussion points as `\u003cul\u003e` bullet list\n  - Pedagogical note in italic muted text\n- If multiple entries, separate with a subtle divider\n- Compact styling — this sits below a 500px code editor so shouldn't be too tall\n\n## Tests\n- Renders discussion points and pedagogical note\n- Renders correct category badge for each entry\n- Handles single entry and multiple entries\n- Renders nothing / empty when entries array is empty","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:36:37.250564343Z","created_by":"Joe Delfino","updated_at":"2026-01-29T04:51:33.832252299Z","closed_at":"2026-01-29T04:51:33.832252299Z","close_reason":"Implemented in 6eac566","labels":["wip"]}
{"id":"coding-tool-xk2.5","title":"Integrate analysis into SessionStudentPane","description":"## Summary\nWire up the useAnalysisGroups hook, GroupNavigationHeader, and StudentAnalysisDetails into SessionStudentPane to create the merged experience.\n\n## Files to modify\n- `src/app/(app)/instructor/components/SessionStudentPane.tsx`\n- `src/app/(app)/instructor/components/__tests__/SessionStudentPane.test.tsx`\n\n## Props changes\nAdd `sessionId: string` prop to `SessionStudentPaneProps`.\n\n## Implementation\n\n### Left panel changes (above StudentList)\n1. Add \"Analyze N Submissions\" button at top of left panel div (above StudentList)\n   - Shows student count in label, disabled when 0 students\n   - When analysis is loading, show spinner + \"Analyzing...\"\n   - When analysis is ready, label changes to \"Re-analyze\"\n   - On error, show error text with \"Try Again\" button\n2. When analysis is ready, render `GroupNavigationHeader` between button and StudentList\n   - Pass `groups`, `activeGroupIndex`, `navigateGroup`, `dismissGroup` from hook\n   - Pass `script.summary.commonPatterns` for the common patterns display\n\n### Student list filtering\n- When active group is 'all' or no analysis: pass all `students` to StudentList\n- When active group is a category: filter `students` to only those whose id is in `activeGroup.studentIds`\n\n### Auto-select on group change\n- Add `useEffect` watching `activeGroupIndex` and `groups` (not the derived `activeGroup` object, to avoid stale closure issues): when active group changes, if `groups[activeGroupIndex]?.recommendedStudentId` exists, call `setSelectedStudentId(recommendedStudentId)` — do NOT call `onShowOnPublicView`\n\n### Auto-feature on analyze (preserving existing behavior)\n- When analysis first completes (transition from 'loading' to 'ready'), auto-call `onShowOnPublicView` with the first entry's studentId, matching the existing WalkthroughPanel behavior. This ensures the public view updates when the instructor triggers analysis.\n\n### Right panel changes\n- When a student is selected AND analysis is ready, find all `WalkthroughEntry` items across all groups where `entry.studentId === selectedStudentId`\n- If entries found, render `StudentAnalysisDetails` below the `EditorContainer`\n- The \"Feature\" button in StudentList still calls `onShowOnPublicView` separately (selection ≠ featuring)\n\n## Tests to update\n- Verify \"Analyze\" button renders with student count\n- Verify clicking analyze triggers API call (mock fetch)\n- Verify auto-feature of first student on analysis completion\n- Verify group navigation header appears after analysis\n- Verify student list filtering when group is active\n- Verify auto-selection of recommended student on group change\n- Verify analysis details appear in right panel for analyzed students\n- Verify \"Feature\" button still works independently of analysis selection","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:36:55.663766421Z","created_by":"Joe Delfino","updated_at":"2026-01-29T07:00:14.277972258Z","closed_at":"2026-01-29T07:00:14.277972258Z","close_reason":"Implemented in 5b6bfe9","labels":["wip"]}
{"id":"coding-tool-xk2.6","title":"Remove walkthrough tab from SessionView","description":"## Summary\nRemove the \"AI Walkthrough\" tab from SessionView now that analysis is integrated into the Students tab. Pass sessionId to SessionStudentPane.\n\n## Files to modify\n- `src/app/(app)/instructor/components/SessionView.tsx`\n- `src/app/(app)/instructor/components/__tests__/SessionView.test.tsx`\n\n## Implementation\n1. Change `type SessionTab = 'students' | 'problem'` (remove 'walkthrough')\n2. Remove `WalkthroughPanelWrapper` import\n3. Remove the `\u003cTabs.Tab tabId=\"walkthrough\"\u003e` element\n4. Remove the `\u003cTabs.Panel tabId=\"walkthrough\"\u003e` element (and its keepMounted prop)\n5. Pass `sessionId={sessionId}` to `\u003cSessionStudentPane\u003e`\n6. Update JSDoc comment to reflect 2 tabs instead of 3\n\n## Tests to update\n- Remove any test expectations for walkthrough tab\n- Verify only 2 tabs render (Students, Problem Setup)\n- Verify sessionId is passed to SessionStudentPane","status":"closed","priority":1,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:37:03.67844505Z","created_by":"Joe Delfino","updated_at":"2026-01-29T13:43:35.119477846Z","closed_at":"2026-01-29T13:43:35.119477846Z","close_reason":"Implemented in 2189218","labels":["wip"]}
{"id":"coding-tool-xk2.7","title":"Delete old walkthrough components and tests","description":"## Summary\nRemove the old walkthrough components that are no longer used after the merge.\n\n## Files to delete\n- `src/app/(app)/instructor/components/WalkthroughPanel.tsx`\n- `src/app/(app)/instructor/components/WalkthroughEntry.tsx`\n- `src/app/(app)/instructor/components/WalkthroughPanelWrapper.tsx`\n- `src/app/(app)/instructor/components/__tests__/WalkthroughPanel.test.tsx`\n- `src/app/(app)/instructor/components/__tests__/WalkthroughEntry.test.tsx`\n\n## Verification\n1. `npx tsc --noEmit` — no type errors (no remaining imports of deleted files)\n2. `npm test` — all tests pass\n3. Search codebase for any remaining imports of deleted files and remove them","status":"closed","priority":2,"issue_type":"task","owner":"jdelfino@brandeis.edu","created_at":"2026-01-29T04:37:10.934086886Z","created_by":"Joe Delfino","updated_at":"2026-01-29T13:45:40.121304793Z","closed_at":"2026-01-29T13:45:40.121304793Z","close_reason":"Implemented in b0cd779","labels":["wip"]}
{"id":"coding-tool-xmm9","title":"Test level 1 subtask","status":"closed","priority":4,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T03:55:36.802511377Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.647017969Z","closed_at":"2026-01-23T03:56:48.130230216Z","close_reason":"cleanup"}
{"id":"coding-tool-yum","title":"Show descriptive password validation errors on registration","description":"## Problem\nWhen Supabase rejects a password (too short, too weak), the user sees generic \"Registration failed\" instead of the actual error message.\n\n## Current behavior\n```typescript\n// src/app/api/auth/register/route.ts lines 61-75\n} catch (error: any) {\n  if (error.message?.includes('already exists') || error.message?.includes('duplicate')) {\n    return NextResponse.json({ error: 'User with this email already exists' }, { status: 409 });\n  }\n  // Password errors fall through to generic message ❌\n  return NextResponse.json({ error: 'Registration failed' }, { status: 500 });\n}\n```\n\n## Fix\nPass through password-related error messages from Supabase:\n\n```typescript\n} catch (error: any) {\n  if (error.message?.includes('already exists') || error.message?.includes('duplicate')) {\n    return NextResponse.json({ error: 'User with this email already exists' }, { status: 409 });\n  }\n  \n  // Pass through auth validation errors (password too weak/short, etc.)\n  if (error.message?.toLowerCase().includes('password')) {\n    return NextResponse.json({ error: error.message }, { status: 400 });\n  }\n\n  return NextResponse.json({ error: 'Registration failed' }, { status: 500 });\n}\n```\n\n## File to modify\nsrc/app/api/auth/register/route.ts\n\n## Supabase Configuration (Manual Step)\nBefore testing, configure password requirements in Supabase Dashboard:\n\n1. Go to: Auth → Providers → Email\n2. Set minimum password length: **8 characters**\n3. Character requirements: **None** (not sensitive data)\n4. Leaked password check: Leave default (off unless Pro plan)\n\n## Verification\n1. Configure Supabase as above\n2. Try registering with 5-character password\n3. Should see descriptive error like \"Password should be at least 8 characters\"\n4. Try registering with valid 8+ character password\n5. Should succeed","status":"open","priority":2,"issue_type":"bug","created_at":"2026-01-15T03:34:31.475552086Z","created_by":"node","updated_at":"2026-01-15T03:34:31.475552086Z"}
{"id":"coding-tool-yut","title":"Complete postgres_changes to Broadcast migration","description":"## Goal\n\n**Fully migrate from Supabase postgres_changes to Broadcast for all realtime updates.** After this epic is complete:\n- NO postgres_changes subscriptions should remain in client code\n- ALL realtime updates flow through Broadcast events\n- The `useRealtime` hook should be removed or repurposed for presence-only\n- No polling should occur when broadcast is connected\n\n## Background\n\nThe codebase partially migrated from Supabase postgres_changes to Broadcast for realtime updates. Broadcast is more reliable (recommended by Supabase) and the API routes now send broadcasts, but:\n\n1. Some broadcasts are sent but not subscribed to\n2. Some events don't have broadcasts yet (rely on postgres_changes)\n3. Dead postgres_changes code remains in the codebase, causing confusion\n\n## Current Architecture\n\n**Hooks:**\n- `src/hooks/useRealtime.ts` - Low-level hook that subscribes to postgres_changes for `session_students`, `sessions`, `revisions` tables. **TO BE REMOVED/REPURPOSED.**\n- `src/hooks/useRealtimeSession.ts` - High-level hook that:\n  - Uses `useRealtime` for postgres_changes (partially dead)\n  - Has separate broadcast channel subscription for `student_joined`, `student_code_updated`\n  - Tracks `isBroadcastConnected` for polling fallback\n  - Returns `isConnected` from useRealtime (postgres_changes) - UI shows this but polling uses broadcast state\n\n**API Routes that broadcast:**\n- `/api/sessions/[id]/join` → `student_joined`\n- `/api/sessions/[id]/code` → `student_code_updated`\n- `/api/sessions/[id]/feature` → `featured_student_changed`\n- `/api/sessions/[id]/update-problem` → `problem_updated`\n\n**API Routes that DON'T broadcast (need to be fixed):**\n- `DELETE /api/sessions/[id]` - ends session, no broadcast\n\n## Migration Status Table\n\n| Event | Broadcast Sent | useRealtimeSession Broadcast | useRealtimeSession postgres_changes | Status |\n|-------|---------------|------------------------------|-------------------------------------|--------|\n| student_joined | ✅ | ✅ | ✅ | Redundant - remove postgres_changes |\n| student_code_updated | ✅ | ✅ | ✅ | Redundant - remove postgres_changes |\n| featured_student_changed | ✅ | ❌ | ✅ | Incomplete - add broadcast subscription, remove postgres_changes |\n| problem_updated | ✅ | ❌ | ❌ | Gap - add broadcast subscription |\n| session_ended | ❌ | ❌ | ✅ | Not migrated - add broadcast + subscription |\n| revisions | ❌ | ❌ | ✅ (logs only) | Dead code - remove entirely |\n\n## Bug Symptoms\n\n- Student page UI shows \"connected\" (from postgres_changes) but polls every 2s (because broadcast channel state differs from postgres_changes state)\n- Two different `isConnected` states cause confusion (`isConnected` vs `isBroadcastConnected`)\n\n## Success Criteria\n\n1. All events use Broadcast (no postgres_changes subscriptions remain)\n2. Single source of truth for connection status (`isBroadcastConnected`)\n3. `useRealtime.ts` removed or simplified to presence-only\n4. No polling when broadcast is connected\n5. All unit tests updated to reflect new architecture\n6. **E2E tests must pass** - run `npm run test:e2e` locally before completing each task","status":"closed","priority":1,"issue_type":"epic","owner":"jdelfino@gmail.com","created_at":"2026-01-25T17:15:03.325369627Z","created_by":"Joe Delfino","updated_at":"2026-01-30T22:38:40.324730875Z","closed_at":"2026-01-25T18:09:27.695408263Z","close_reason":"Merged in PR #20"}
{"id":"coding-tool-z506","title":"Test nested parent","status":"closed","priority":4,"issue_type":"task","owner":"jdelfino@gmail.com","created_at":"2026-01-23T03:55:27.616336845Z","created_by":"Joe Delfino","updated_at":"2026-01-23T05:02:58.648479011Z","closed_at":"2026-01-23T03:56:53.935449927Z","close_reason":"cleanup"}
{"id":"coding-tool-zu0","title":"Standardize loading states with consistent UI","description":"## Summary\nLoading indicators are inconsistent across the app - different spinner styles, no skeletons, no timeout messages.\n\n## Current Issues\n- Different spinner styles (spinning borders, various animations)\n- No loading skeletons for content\n- Long operations show no progress\n- No timeout messages for slow operations\n\n## Implementation\n\n### 1. Create consistent loading components\n```\nsrc/components/ui/Spinner.tsx - Consistent spinner\nsrc/components/ui/Skeleton.tsx - Content placeholder\nsrc/components/ui/LoadingOverlay.tsx - Full-screen loading\n```\n\n### 2. Add timeout messaging\nFor operations \u003e 5 seconds:\n'This is taking longer than expected...'\n\nFor operations \u003e 15 seconds:\n'Still working... Check your connection if this continues.'\n\n### 3. Replace inconsistent spinners\nAudit and replace all spinning/loading indicators with standard components.\n\n## Files to Modify\n- Create `src/components/ui/Spinner.tsx`\n- Create `src/components/ui/Skeleton.tsx`\n- `src/app/instructor/components/ClassList.tsx` (line 72-77)\n- `src/app/instructor/page.tsx` (lines 466-481)\n- `src/app/student/page.tsx` (line 251-263)\n- Other components with loading states","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-15T03:58:57.071659543Z","created_by":"node","updated_at":"2026-01-15T03:58:57.071659543Z"}
{"id":"coding-tool-zv4","title":"Build debugger UI with forward/backward navigation controls","description":"Create client-side debugger interface that displays execution trace and allows students to step forward and backward through program execution. Shows current line highlight and provides navigation controls.\n\nFiles to modify:\n- src/student/components/DebuggerPanel.tsx - Main debugger UI component (new file)\n- src/student/components/CodeEditor.tsx - Add debugger mode with line highlighting\n- src/hooks/useDebugger.ts - Hook to manage trace state and navigation (new file)\n- src/student/page.tsx - Integrate debugger panel\n\nImplementation steps:\n1. Create src/hooks/useDebugger.ts:\n   - State: currentStep, totalSteps, trace\n   - Methods: stepForward(), stepBackward(), jumpToStep(index), reset()\n   - Send trace-request via WebSocket\n   - Handle trace-response and store trace data\n   \n2. Create src/student/components/DebuggerPanel.tsx:\n   - Debug button to trigger trace generation\n   - Navigation controls: First, Previous, Next, Last step\n   - Step counter display (Step X of Y)\n   - Keyboard shortcuts (arrow keys for navigation)\n   - Loading state while trace is being generated\n   - Error display if trace fails\n   \n3. Update CodeEditor.tsx for debugger mode:\n   - Add debugMode prop\n   - Highlight current line being executed (different color than normal cursor)\n   - Make read-only during debugging\n   - Show execution arrow/indicator in gutter\n   \n4. Integrate in student/page.tsx:\n   - Add Debug button near Run Code button\n   - Show DebuggerPanel when in debug mode\n   - Hide normal output panel during debugging\n\nUI Layout:\n┌─────────────────────────────────────┐\n│ [▶ Run Code] [🐛 Debug]             │\n├─────────────────────────────────────┤\n│ [Code Editor - Line 3 highlighted]  │\n│ 1  def factorial(n):                │\n│ 2      if n \u003c= 1:                   │\n│ 3 →        return 1                 │ ← Current step\n│ 4      return n * factorial(n-1)    │\n└─────────────────────────────────────┘\n┌─────────────────────────────────────┐\n│ Step 5 of 23                        │\n│ [⏮ First] [◀ Prev] [Next ▶] [Last ⏭]│\n└─────────────────────────────────────┘\n\nKeyboard shortcuts:\n- Right arrow / N: Next step\n- Left arrow / P: Previous step  \n- Home: Jump to first step\n- End: Jump to last step\n- Esc: Exit debugger\n\nEdge cases:\n- No trace available (disable navigation)\n- Trace generation in progress (show spinner)\n- Trace generation failed (show error message)\n- Very long traces (virtualize step list if needed)\n- Rapid navigation (debounce to prevent lag)\n\nDepends on: coding-tool-5ic (execution tracing must be implemented first)","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-18T19:05:54.543992814Z","updated_at":"2025-12-18T19:05:54.543992814Z"}
