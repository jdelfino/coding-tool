{
  "name": "coding-tool",
  "image": "mcr.microsoft.com/devcontainers/base:trixie",

  "workspaceMount": "source=${localWorkspaceFolder},target=/workspaces/coding-tool,type=bind,consistency=cached",
  "workspaceFolder": "/workspaces/coding-tool",

  "mounts": [
    "source=coding-tool-node-modules,target=/workspaces/coding-tool/node_modules,type=volume",
    "source=${localEnv:HOME}/.claude,target=/home/vscode/.claude,type=bind,consistency=cached"
  ],

  "features": {
    "ghcr.io/devcontainers/features/python:1": { "version": "3.12" },
    "ghcr.io/devcontainers/features/node:1": { "version": "22", "installYarnUsingApt": false },
    "ghcr.io/devcontainers/features/docker-in-docker:2": { "moby": false },
    "ghcr.io/devcontainers/features/github-cli:1": {},
    "ghcr.io/devcontainers-extra/features/supabase-cli:1": {}
  },

  "initializeCommand": "./.devcontainer/init-1password.sh",
  "postCreateCommand": "./.devcontainer/post-create.sh",
  "postStartCommand": "./.devcontainer/setup-secrets.sh",

  "forwardPorts": [3000, 3001, 54321, 54322, 54323],
  "portsAttributes": {
    "3000": { "label": "Next.js Dev Server" },
    "3001": { "label": "Express Backend" },
    "54321": { "label": "Supabase API" },
    "54322": { "label": "Supabase Database" },
    "54323": { "label": "Supabase Studio" }
  },

  "remoteEnv": {
    "BD_SOCKET": "/tmp/beads.sock"
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "planet57.vscode-beads",
        "ms-playwright.playwright"
      ]
    }
  }
}
